{"version":3,"sources":["../../../../src/streaming/TextTracks.js"],"names":[],"mappings":"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","file":"TextTracks.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport EventBus from '../core/EventBus';\nimport Events from '../core/events/Events';\nimport FactoryMaker from '../core/FactoryMaker';\nimport Debug from '../core/Debug';\n\nfunction TextTracks() {\n\n    let context = this.context;\n    let eventBus = EventBus(context).getInstance();\n    let log = Debug(context).getInstance().log;\n\n    let instance,\n        Cue,\n        videoModel,\n        video,\n        textTrackQueue,\n        trackElementArr,\n        currentTrackIdx,\n        actualVideoLeft,\n        actualVideoTop,\n        actualVideoWidth,\n        actualVideoHeight,\n        captionContainer,\n        videoSizeCheckInterval,\n        isChrome,\n        fullscreenAttribute,\n        displayCCOnTop,\n        topZIndex;\n\n    function initialize () {\n        Cue = window.VTTCue || window.TextTrackCue;\n        textTrackQueue = [];\n        trackElementArr = [];\n        currentTrackIdx = -1;\n        actualVideoLeft = 0;\n        actualVideoTop = 0;\n        actualVideoWidth = 0;\n        actualVideoHeight = 0;\n        captionContainer = null;\n        videoSizeCheckInterval = null;\n        displayCCOnTop = false;\n        topZIndex = 2147483647;\n\n        //TODO Check if IE has resolved issues: Then revert to not using the addTextTrack API for all browsers.\n        // https://connect.microsoft.com/IE/feedbackdetail/view/1660701/text-tracks-do-not-fire-change-addtrack-or-removetrack-events\n        // https://connect.microsoft.com/IE/feedback/details/1573380/htmltrackelement-track-addcue-throws-invalidstateerror-when-adding-new-cue\n        // Same issue with Firefox.\n        //isIE11orEdge = !!navigator.userAgent.match(/Trident.*rv[ :]*11\\./) || navigator.userAgent.match(/Edge/);\n        //isFirefox = !!navigator.userAgent.match(/Firefox/);\n        isChrome = !!navigator.userAgent.match(/Chrome/) && !navigator.userAgent.match(/Edge/);\n        if (document.fullscreenElement !== undefined) {\n            fullscreenAttribute = 'fullscreenElement'; // Standard and Edge\n        } else if (document.webkitIsFullScreen !== undefined) {\n            fullscreenAttribute = 'webkitIsFullScreen'; // Chrome and Safari (and Edge)\n        } else if (document.msFullscreenElement) { // IE11\n            fullscreenAttribute = 'msFullscreenElement';\n        } else if (document.mozFullScreen) { // Firefox\n            fullscreenAttribute = 'mozFullScreen';\n        }\n\n    }\n\n    function createTrackForUserAgent (i) {\n        var kind = textTrackQueue[i].kind;\n        var label = textTrackQueue[i].label !== undefined ? textTrackQueue[i].label : textTrackQueue[i].lang;\n        var lang = textTrackQueue[i].lang;\n        var track = isChrome ? document.createElement('track') : video.addTextTrack(kind, label, lang);\n\n        if (isChrome) {\n            track.kind = kind;\n            track.label = label;\n            track.srclang = lang;\n        }\n\n        return track;\n    }\n\n    function displayCConTop (value) {\n        displayCCOnTop = value;\n        if (!captionContainer || document[fullscreenAttribute]) return;\n        captionContainer.style.zIndex = value ? topZIndex : null;\n    }\n\n    function addTextTrack(textTrackInfoVO, totalTextTracks) {\n\n        if (textTrackQueue.length === totalTextTracks) {\n            log('Trying to add too many tracks.');\n            return;\n        }\n\n        textTrackQueue.push(textTrackInfoVO);\n        if (video === undefined) {\n            video = textTrackInfoVO.video;\n        }\n\n        if (textTrackQueue.length === totalTextTracks) {\n            textTrackQueue.sort(function (a, b) { //Sort in same order as in manifest\n                return a.index - b.index;\n            });\n            captionContainer = videoModel.getTTMLRenderingDiv();\n            var defaultIndex = -1;\n            for (var i = 0 ; i < textTrackQueue.length; i++) {\n                var track = createTrackForUserAgent.call(this, i);\n                trackElementArr.push(track); //used to remove tracks from video element when added manually\n\n                if (textTrackQueue[i].defaultTrack) {\n                    // track.default is an object property identifier that is a reserved word\n                    // The following jshint directive is used to suppressed the warning \"Expected an identifier and instead saw 'default' (a reserved word)\"\n                    /*jshint -W024 */\n                    track.default = true;\n                    defaultIndex = i;\n                }\n                if (isChrome) {\n                    video.appendChild(track);\n                }\n                var textTrack = video.textTracks[i];\n                textTrack.nonAddedCues = [];\n                if (captionContainer && (textTrackQueue[i].isTTML || textTrackQueue[i].isEmbedded)) {\n                    textTrack.renderingType = 'html';\n                } else {\n                    textTrack.renderingType = 'default';\n                }\n                this.addCaptions(i, 0, textTrackQueue[i].captionData);\n                eventBus.trigger(Events.TEXT_TRACK_ADDED);\n            }\n            setCurrentTrackIdx.call(this, defaultIndex);\n            if (defaultIndex >= 0) {\n                for (let idx = 0; idx < video.textTracks.length; idx++) {\n                    video.textTracks[idx].mode = (idx === defaultIndex) ? 'showing' : 'hidden';\n                }\n                this.addCaptions(defaultIndex, 0, null);\n            }\n            eventBus.trigger(Events.TEXT_TRACKS_ADDED, {index: currentTrackIdx, tracks: textTrackQueue});//send default idx.\n        }\n    }\n\n    function getVideoVisibleVideoSize(viewWidth, viewHeight, videoWidth, videoHeight, aspectRatio, use80Percent) {\n        var viewAspectRatio = viewWidth / viewHeight;\n        var videoAspectRatio = videoWidth / videoHeight;\n\n        var videoPictureWidth = 0;\n        var videoPictureHeight = 0;\n\n        if (viewAspectRatio > videoAspectRatio) {\n            videoPictureHeight = viewHeight;\n            videoPictureWidth = (videoPictureHeight / videoHeight) * videoWidth;\n        } else {\n            videoPictureWidth = viewWidth;\n            videoPictureHeight = (videoPictureWidth / videoWidth) * videoHeight;\n        }\n\n        var videoPictureXAspect = 0;\n        var videoPictureYAspect = 0;\n        var videoPictureWidthAspect = 0;\n        var videoPictureHeightAspect = 0;\n        var videoPictureAspect = videoPictureWidth / videoPictureHeight;\n\n        if (videoPictureAspect > aspectRatio) {\n            videoPictureHeightAspect = videoPictureHeight;\n            videoPictureWidthAspect = videoPictureHeight / (1 / aspectRatio);\n            videoPictureXAspect = (viewWidth - videoPictureWidthAspect) / 2;\n            videoPictureYAspect = 0;\n        } else {\n            videoPictureWidthAspect = videoPictureWidth;\n            videoPictureHeightAspect = videoPictureWidth / aspectRatio;\n            videoPictureXAspect = 0;\n            videoPictureYAspect = (viewHeight - videoPictureHeightAspect) / 2;\n        }\n\n        if (use80Percent) {\n            return { x: videoPictureXAspect + (videoPictureWidthAspect * 0.1),\n                     y: videoPictureYAspect + (videoPictureHeightAspect * 0.1),\n                     w: videoPictureWidthAspect * 0.8,\n                     h: videoPictureHeightAspect * 0.8 }; /* Maximal picture size in videos aspect ratio */\n        } else {\n            return { x: videoPictureXAspect,\n                     y: videoPictureYAspect,\n                     w: videoPictureWidthAspect,\n                     h: videoPictureHeightAspect }; /* Maximal picture size in videos aspect ratio */\n        }\n    }\n\n\n    function checkVideoSize() {\n        var track = this.getCurrentTextTrack();\n        if (track && track.renderingType === 'html') {\n            let aspectRatio = video.clientWidth / video.clientHeight;\n            let use80Percent = false;\n            if (track.isFromCEA608) {\n                // If this is CEA608 then use predefined aspect ratio\n                aspectRatio = 3.5 / 3.0;\n                use80Percent = true;\n            }\n\n            const realVideoSize = getVideoVisibleVideoSize.call(this, video.clientWidth, video.clientHeight, video.videoWidth, video.videoHeight, aspectRatio, use80Percent);\n\n            const newVideoWidth = realVideoSize.w;\n            const newVideoHeight = realVideoSize.h;\n\n            if (newVideoWidth != actualVideoWidth || newVideoHeight != actualVideoHeight) {\n                actualVideoLeft = realVideoSize.x;\n                actualVideoTop = realVideoSize.y;\n                actualVideoWidth = newVideoWidth;\n                actualVideoHeight = newVideoHeight;\n                captionContainer.style.left = actualVideoLeft + 'px';\n                captionContainer.style.top = actualVideoTop + 'px';\n                captionContainer.style.width = actualVideoWidth + 'px';\n                captionContainer.style.height = actualVideoHeight + 'px';\n\n                // Video view has changed size, so resize any active cues\n                for (let i = 0; track.activeCues && i < track.activeCues.length; ++i) {\n                    let cue = track.activeCues[i];\n                    cue.scaleCue(cue);\n                }\n\n                if ((fullscreenAttribute && document[fullscreenAttribute]) || displayCCOnTop) {\n                    captionContainer.style.zIndex = topZIndex;\n                } else {\n                    captionContainer.style.zIndex = null;\n                }\n            }\n        }\n    }\n\n    function convertToPixels(percentage, pixelMeasure) {\n        let percentString = Math.round(0.01 * percentage * pixelMeasure).toString() + 'px';\n        return percentString;\n    }\n\n    function scaleImageCue(activeCue) {\n        var videoWidth = actualVideoWidth;\n        var videoHeight = actualVideoHeight;\n\n        if (videoWidth * videoHeight === 0) {\n            return; //At least one of the measures is still zero\n        }\n\n        if (activeCue.layout) {\n            let layout = activeCue.layout;\n            let left = convertToPixels(layout.left, videoWidth);\n            let top = convertToPixels(layout.top, videoHeight);\n            let width = convertToPixels(layout.width, videoWidth);\n            let height = convertToPixels(layout.height, videoHeight);\n            captionContainer.style.left = left;\n            captionContainer.style.top = top;\n            captionContainer.style.width = width;\n            captionContainer.style.height = height;\n            let image = captionContainer.firstChild;\n            if (image && image.style) {\n                image.style.left = '0px';\n                image.style.top = '0px';\n                image.style.width = width;\n                image.style.height = height;\n            }\n        }\n    }\n\n    function scaleCue(activeCue) {\n        var videoWidth = actualVideoWidth;\n        var videoHeight = actualVideoHeight;\n        var key,\n            replaceValue,\n            valueFontSize,\n            valueLineHeight,\n            elements;\n\n        var cellUnit = [videoWidth / activeCue.cellResolution[0], videoHeight / activeCue.cellResolution[1]];\n        if (activeCue.linePadding) {\n            for (key in activeCue.linePadding) {\n                if (activeCue.linePadding.hasOwnProperty(key)) {\n                    var valueLinePadding = activeCue.linePadding[key];\n                    replaceValue = (valueLinePadding * cellUnit[0]).toString();\n                    // Compute the CellResolution unit in order to process properties using sizing (fontSize, linePadding, etc).\n                    var elementsSpan = document.getElementsByClassName('spanPadding');\n                    for (var i = 0; i < elementsSpan.length; i++) {\n                        elementsSpan[i].style.cssText = elementsSpan[i].style.cssText.replace(/(padding-left\\s*:\\s*)[\\d.,]+(?=\\s*px)/gi, '$1' + replaceValue);\n                        elementsSpan[i].style.cssText = elementsSpan[i].style.cssText.replace(/(padding-right\\s*:\\s*)[\\d.,]+(?=\\s*px)/gi, '$1' + replaceValue);\n                    }\n                }\n            }\n        }\n\n        if (activeCue.fontSize) {\n            for (key in activeCue.fontSize) {\n                if (activeCue.fontSize.hasOwnProperty(key)) {\n                    if (activeCue.fontSize[key][0] === '%') {\n                        valueFontSize = activeCue.fontSize[key][1] / 100;\n                    }else if (activeCue.fontSize[key][0] === 'c') {\n                        valueFontSize = activeCue.fontSize[key][1];\n                    }\n\n                    replaceValue  = (valueFontSize * cellUnit[1]).toString();\n\n                    if (key !== 'defaultFontSize') {\n                        elements = document.getElementsByClassName(key);\n                    } else {\n                        elements = document.getElementsByClassName('paragraph');\n                    }\n\n                    for (var j = 0; j < elements.length; j++) {\n                        elements[j].style.cssText = elements[j].style.cssText.replace(/(font-size\\s*:\\s*)[\\d.,]+(?=\\s*px)/gi, '$1' + replaceValue);\n                    }\n                }\n            }\n        }\n\n        if (activeCue.lineHeight) {\n            for (key in activeCue.lineHeight) {\n                if (activeCue.lineHeight.hasOwnProperty(key)) {\n                    if (activeCue.lineHeight[key][0] === '%') {\n                        valueLineHeight = activeCue.lineHeight[key][1] / 100;\n                    }else if (activeCue.fontSize[key][0] === 'c') {\n                        valueLineHeight = activeCue.lineHeight[key][1];\n                    }\n\n                    replaceValue = (valueLineHeight * cellUnit[1]).toString();\n                    elements = document.getElementsByClassName(key);\n                    for (var k = 0; k < elements.length; k++) {\n                        elements[k].style.cssText = elements[k].style.cssText.replace(/(line-height\\s*:\\s*)[\\d.,]+(?=\\s*px)/gi, '$1' + replaceValue);\n                    }\n                }\n            }\n        }\n    }\n\n    /*\n    * Add captions to track, store for later adding, or add captions added before\n    */\n    function addCaptions(trackIdx, timeOffset, captionData) {\n        var track = trackIdx >= 0 ?  video.textTracks[trackIdx] : null;\n        var self = this;\n\n        if (!track) return;\n        if (track.mode !== 'showing') {\n            if (captionData && captionData.length > 0) {\n                track.nonAddedCues = track.nonAddedCues.concat(captionData);\n            }\n            return;\n        }\n\n        if (!captionData) {\n            captionData = track.nonAddedCues;\n            track.nonAddedCues = [];\n        }\n\n        if (!captionData || captionData.length === 0) {\n            return;\n        }\n\n        for (var item in captionData) {\n            var cue;\n            var currentItem = captionData[item];\n\n            track.cellResolution = currentItem.cellResolution;\n            track.isFromCEA608 = currentItem.isFromCEA608;\n\n            if (!videoSizeCheckInterval && (currentItem.type === 'html' || currentItem.type === 'image') ) {\n                videoSizeCheckInterval = setInterval(checkVideoSize.bind(this), 500);\n            }\n\n            //image subtitle extracted from TTML\n            if (currentItem.type === 'image') {\n                cue = new Cue(currentItem.start - timeOffset, currentItem.end - timeOffset, '');\n                cue.image = currentItem.data;\n                cue.id = currentItem.id;\n                cue.size = 0; //discard the native display for this subtitles\n                cue.type = 'image'; // active image overlay\n                cue.layout = currentItem.layout;\n                cue.scaleCue = scaleImageCue.bind(self);\n                cue.onenter = function () {\n                    if (!captionContainer) { // Does not support image captions without a container\n                        return;\n                    }\n                    if (track.mode === 'showing') {\n                        var img = new Image();\n                        img.id = 'ttmlImage_' + this.id;\n                        img.src = this.image;\n                        //img.className = 'cue-image';\n                        img.style.cssText = 'z-index: 2147483648; pointer-events: none; display: block; visibility: visible !important; position: relative !important;';\n                        captionContainer.appendChild(img);\n                        scaleImageCue.call(self, this);\n                    }\n                };\n\n                cue.onexit =  function () {\n                    if (!captionContainer) {\n                        return;\n                    }\n                    let imgs = captionContainer.childNodes;\n                    for (let i = 0; i < imgs.length; i++) {\n                        if (imgs[i].id === 'ttmlImage_' + this.id) {\n                            captionContainer.removeChild(imgs[i]);\n                        }\n                    }\n                };\n            }\n            else if (currentItem.type === 'html') {\n                cue = new Cue(currentItem.start - timeOffset, currentItem.end - timeOffset, '');\n                cue.cueHTMLElement = currentItem.cueHTMLElement;\n                cue.regions = currentItem.regions;\n                cue.regionID = currentItem.regionID;\n                cue.cueID = currentItem.cueID;\n                cue.videoWidth = currentItem.videoWidth;\n                cue.videoHeight = currentItem.videoHeight;\n                cue.cellResolution = currentItem.cellResolution;\n                cue.fontSize = currentItem.fontSize;\n                cue.lineHeight = currentItem.lineHeight;\n                cue.linePadding = currentItem.linePadding;\n                cue.scaleCue = scaleCue.bind(self);\n                captionContainer.style.left = actualVideoLeft + 'px';\n                captionContainer.style.top = actualVideoTop + 'px';\n                captionContainer.style.width = actualVideoWidth + 'px';\n                captionContainer.style.height = actualVideoHeight + 'px';\n\n                cue.onenter =  function () {\n                    if (track.mode === 'showing') {\n                        log('Cue ' + this.startTime + '-' + this.endTime + ' : ' + this.cueHTMLElement.id + ' : ' + this.cueHTMLElement.innerText);\n                        captionContainer.appendChild(this.cueHTMLElement);\n                        scaleCue.call(self, this);\n                    }\n                };\n\n                cue.onexit =  function () {\n                    var divs = captionContainer.childNodes;\n                    for (var i = 0; i < divs.length; ++i) {\n                        if (divs[i].id === this.cueID) {\n                            captionContainer.removeChild(divs[i]);\n                        }\n                    }\n                };\n            }\n            else {\n                cue = new Cue(currentItem.start - timeOffset, currentItem.end - timeOffset, currentItem.data);\n                if (currentItem.styles) {\n                    if (currentItem.styles.align !== undefined && cue.hasOwnProperty('align')) {\n                        cue.align = currentItem.styles.align;\n                    }\n                    if (currentItem.styles.line !== undefined && cue.hasOwnProperty('line')) {\n                        cue.line = currentItem.styles.line;\n                    }\n                    if (currentItem.styles.position !== undefined && cue.hasOwnProperty('position')) {\n                        cue.position = currentItem.styles.position ;\n                    }\n                    if (currentItem.styles.size !== undefined && cue.hasOwnProperty('size')) {\n                        cue.size = currentItem.styles.size;\n                    }\n                }\n            }\n\n            track.addCue(cue);\n        }\n    }\n\n    function getCurrentTextTrack() {\n        return currentTrackIdx >= 0 ? video.textTracks[currentTrackIdx] : null;\n    }\n\n    function getCurrentTrackIdx() {\n        return currentTrackIdx;\n    }\n\n    function getTrackIdxForId(trackId) {\n        var idx = -1;\n        for (var i = 0; i < video.textTracks.length; i++) {\n            if (video.textTracks[i].label === trackId) {\n                idx = i;\n                break;\n            }\n        }\n        return idx;\n    }\n\n    function setCurrentTrackIdx(idx) {\n        currentTrackIdx = idx;\n        clearCaptionContainer.call(this);\n        if (idx >= 0) {\n            var track = video.textTracks[idx];\n            if (track.renderingType === 'html') {\n                setNativeCueStyle.call(this);\n            } else {\n                removeNativeCueStyle.call(this);\n            }\n        } else {\n            removeNativeCueStyle.call(this);\n        }\n    }\n\n    function getTextTrack(idx) {\n        return video.textTracks[idx];\n    }\n\n    function deleteTrackCues(track) {\n        if (track.cues) {\n            var cues = track.cues;\n            var lastIdx = cues.length - 1;\n\n            for (var r = lastIdx; r >= 0 ; r--) {\n                track.removeCue(cues[r]);\n            }\n\n            track.mode = 'disabled';\n        }\n    }\n\n    function deleteAllTextTracks() {\n        var ln = trackElementArr.length;\n        for (var i = 0; i < ln; i++) {\n            if (isChrome) {\n                video.removeChild(trackElementArr[i]);\n            }else {\n                var track = getTextTrack.call(this, i);\n                track.nonAddedCues = [];\n                deleteTrackCues.call(this, track);\n            }\n\n        }\n        trackElementArr = [];\n        textTrackQueue = [];\n        if (videoSizeCheckInterval) {\n            clearInterval(videoSizeCheckInterval);\n            videoSizeCheckInterval = null;\n        }\n        clearCaptionContainer.call(this);\n    }\n\n    function deleteTextTrack(idx) {\n        video.removeChild(trackElementArr[idx]);\n        trackElementArr.splice(idx, 1);\n    }\n\n    /* Set native cue style to transparent background to avoid it being displayed. */\n    function setNativeCueStyle() {\n        if (!isChrome) return;\n        var styleElement = document.getElementById('native-cue-style');\n        if (styleElement) return; //Already set\n\n        styleElement = document.createElement('style');\n        styleElement.id  = 'native-cue-style';\n        document.head.appendChild(styleElement);\n        var stylesheet = styleElement.sheet;\n        if (video.id) {\n            stylesheet.insertRule('#' + video.id + '::cue {background: transparent}', 0);\n        } else if (video.classList.length !== 0) {\n            stylesheet.insertRule('.' + video.className + '::cue {background: transparent}', 0);\n        } else {\n            stylesheet.insertRule('video::cue {background: transparent}', 0);\n        }\n    }\n\n    /* Remove the extra cue style with transparent background for native cues. */\n    function removeNativeCueStyle() {\n        if (!isChrome) return;\n        var styleElement = document.getElementById('native-cue-style');\n        if (styleElement) {\n            document.head.removeChild(styleElement);\n        }\n    }\n\n    function clearCaptionContainer() {\n        if (captionContainer) {\n            while (captionContainer.firstChild) {\n                captionContainer.removeChild(captionContainer.firstChild);\n            }\n        }\n    }\n\n    function setConfig(config) {\n        if (!config) return;\n\n        if (config.videoModel) {\n            videoModel = config.videoModel;\n        }\n    }\n\n    instance = {\n        initialize: initialize,\n        displayCConTop: displayCConTop,\n        addTextTrack: addTextTrack,\n        addCaptions: addCaptions,\n        getTextTrack: getTextTrack,\n        getCurrentTextTrack: getCurrentTextTrack,\n        getCurrentTrackIdx: getCurrentTrackIdx,\n        setCurrentTrackIdx: setCurrentTrackIdx,\n        getTrackIdxForId: getTrackIdxForId,\n        deleteTrackCues: deleteTrackCues,\n        deleteAllTextTracks: deleteAllTextTracks,\n        deleteTextTrack: deleteTextTrack,\n        setConfig: setConfig\n    };\n\n    return instance;\n}\n\nTextTracks.__dashjs_factory_name = 'TextTracks';\nexport default FactoryMaker.getSingletonFactory(TextTracks);\n"]}