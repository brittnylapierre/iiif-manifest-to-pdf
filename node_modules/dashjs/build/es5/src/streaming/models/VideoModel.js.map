{"version":3,"sources":["../../../../../src/streaming/models/VideoModel.js"],"names":[],"mappings":"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","file":"VideoModel.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\n\nimport FactoryMaker from '../../core/FactoryMaker';\nimport EventBus from '../../core/EventBus';\nimport Events from '../../core/events/Events';\nimport Debug from '../../core/Debug';\n\nfunction VideoModel() {\n\n    let instance,\n        element,\n        TTMLRenderingDiv,\n        videoContainer,\n        previousPlaybackRate;\n\n    let context = this.context;\n    let log = Debug(context).getInstance().log;\n    let eventBus = EventBus(context).getInstance();\n    const stalledStreams = [];\n\n    function initialize() {\n        eventBus.on(Events.PLAYBACK_PLAYING, onPlaying, this);\n    }\n\n    function reset() {\n        eventBus.off(Events.PLAYBACK_PLAYING, onPlaying, this);\n    }\n\n    function onPlaybackCanPlay() {\n        if (element) {\n            element.playbackRate = previousPlaybackRate || 1;\n            element.removeEventListener('canplay', onPlaybackCanPlay);\n        }\n    }\n\n    function setPlaybackRate(value) {\n        if (!element) return;\n        if (element.readyState <= 2 && value > 0) {\n            // If media element hasn't loaded enough data to play yet, wait until it has\n            element.addEventListener('canplay', onPlaybackCanPlay);\n        } else {\n            element.playbackRate = value;\n        }\n    }\n\n    //TODO Move the DVR window calculations from MediaPlayer to Here.\n    function setCurrentTime(currentTime) {\n        if (element) {\n            //_currentTime = currentTime;\n\n            // We don't set the same currentTime because it can cause firing unexpected Pause event in IE11\n            // providing playbackRate property equals to zero.\n            if (element.currentTime == currentTime) return;\n\n            // TODO Despite the fact that MediaSource 'open' event has been fired IE11 cannot set videoElement.currentTime\n            // immediately (it throws InvalidStateError). It seems that this is related to videoElement.readyState property\n            // Initially it is 0, but soon after 'open' event it goes to 1 and setting currentTime is allowed. Chrome allows to\n            // set currentTime even if readyState = 0.\n            // setTimeout is used to workaround InvalidStateError in IE11\n            try {\n                element.currentTime = currentTime;\n            } catch (e) {\n                if (element.readyState === 0 && e.code === e.INVALID_STATE_ERR) {\n                    setTimeout(function () {\n                        element.currentTime = currentTime;\n                    }, 400);\n                }\n            }\n        }\n    }\n\n    function getElement() {\n        return element;\n    }\n\n    function setElement(value) {\n        element = value;\n        // Workaround to force Firefox to fire the canplay event.\n        element.preload = 'auto';\n    }\n\n    function setSource(source) {\n        if (element) {\n            if (source) {\n                element.src = source;\n            } else {\n                element.removeAttribute('src');\n                element.load();\n            }\n        }\n    }\n\n    function getSource() {\n        return element ? element.src : null;\n    }\n\n    function getVideoContainer() {\n        return videoContainer;\n    }\n\n    function setVideoContainer(value) {\n        videoContainer = value;\n    }\n\n    function getTTMLRenderingDiv() {\n        return TTMLRenderingDiv;\n    }\n\n    function setTTMLRenderingDiv(div) {\n        TTMLRenderingDiv = div;\n        // The styling will allow the captions to match the video window size and position.\n        TTMLRenderingDiv.style.position = 'absolute';\n        TTMLRenderingDiv.style.display = 'flex';\n        TTMLRenderingDiv.style.overflow = 'hidden';\n        TTMLRenderingDiv.style.pointerEvents = 'none';\n        TTMLRenderingDiv.style.top = 0;\n        TTMLRenderingDiv.style.left = 0;\n    }\n\n    function setStallState(type, state) {\n        stallStream(type, state);\n    }\n\n    function isStalled() {\n        return (stalledStreams.length > 0);\n    }\n\n    function addStalledStream(type) {\n\n        let event;\n\n        if (type === null || element.seeking || stalledStreams.indexOf(type) !== -1) {\n            return;\n        }\n\n        stalledStreams.push(type);\n        if (element && stalledStreams.length === 1) {\n            // Halt playback until nothing is stalled.\n            event = document.createEvent('Event');\n            event.initEvent('waiting', true, false);\n            previousPlaybackRate = element.playbackRate;\n            setPlaybackRate(0);\n            element.dispatchEvent(event);\n        }\n    }\n\n    function removeStalledStream(type) {\n        let index = stalledStreams.indexOf(type);\n        let event;\n\n        if (type === null) {\n            return;\n        }\n        if (index !== -1) {\n            stalledStreams.splice(index, 1);\n        }\n        // If nothing is stalled resume playback.\n        if (element && isStalled() === false && element.playbackRate === 0) {\n            setPlaybackRate(previousPlaybackRate || 1);\n            if (!element.paused) {\n                event = document.createEvent('Event');\n                event.initEvent('playing', true, false);\n                element.dispatchEvent(event);\n            }\n        }\n    }\n\n    function stallStream(type, isStalled) {\n        if (isStalled) {\n            addStalledStream(type);\n        } else {\n            removeStalledStream(type);\n        }\n    }\n\n    //Calling play on the element will emit playing - even if the stream is stalled. If the stream is stalled, emit a waiting event.\n    function onPlaying() {\n        if (element && isStalled() && element.playbackRate === 0) {\n            const event = document.createEvent('Event');\n            event.initEvent('waiting', true, false);\n            element.dispatchEvent(event);\n        }\n    }\n\n    function getPlaybackQuality() {\n        if (!element) { return null; }\n        let hasWebKit = ('webkitDroppedFrameCount' in element) && ('webkitDecodedFrameCount' in element);\n        let hasQuality = ('getVideoPlaybackQuality' in element);\n        let result = null;\n\n        if (hasQuality) {\n            result = element.getVideoPlaybackQuality();\n        }\n        else if (hasWebKit) {\n            result = {\n                droppedVideoFrames: element.webkitDroppedFrameCount,\n                totalVideoFrames: element.webkitDroppedFrameCount + element.webkitDecodedFrameCount,\n                creationTime: new Date()\n            };\n        }\n\n        return result;\n    }\n\n    function play() {\n        if (element) {\n            element.autoplay = true;\n            const p = element.play();\n            if (p && (typeof Promise !== 'undefined') && (p instanceof Promise)) {\n                p.catch((e) => {\n                    if (e.name === 'NotAllowedError') {\n                        eventBus.trigger(Events.PLAYBACK_NOT_ALLOWED);\n                    }\n                    log(`Caught pending play exception - continuing (${e})`);\n                });\n            }\n        }\n    }\n\n    function isPaused() {\n        return element ? element.paused : null;\n    }\n\n    function pause() {\n        if (element) {\n            element.pause();\n            element.autoplay = false;\n        }\n    }\n\n    function isSeeking() {\n        return element ? element.seeking : null;\n    }\n\n    function getTime() {\n        return element ? element.currentTime : null;\n    }\n\n    function getPlaybackRate() {\n        return element ? element.playbackRate : null;\n    }\n\n    function getPlayedRanges() {\n        return element ? element.played : null;\n    }\n\n    function getEnded() {\n        return element ? element.ended : null;\n    }\n\n    function addEventListener(eventName, eventCallBack) {\n        if (element) {\n            element.addEventListener(eventName, eventCallBack);\n        }\n    }\n\n    function removeEventListener(eventName, eventCallBack) {\n        if (element) {\n            element.removeEventListener(eventName, eventCallBack);\n        }\n    }\n\n    function getReadyState() {\n        return element ? element.readyState : NaN;\n    }\n\n    function getBufferRange() {\n        return element ? element.buffered : null;\n    }\n\n    function getClientWidth() {\n        return element ? element.clientWidth : NaN;\n    }\n\n    function getClientHeight() {\n        return element ? element.clientHeight : NaN;\n    }\n\n    function getVideoWidth() {\n        return element ? element.videoWidth : NaN;\n    }\n\n    function getVideoHeight() {\n        return element ? element.videoHeight : NaN;\n    }\n\n    function getVideoRelativeOffsetTop() {\n        return element && element.parentNode ? element.getBoundingClientRect().top - element.parentNode.getBoundingClientRect().top : NaN;\n    }\n\n    function getVideoRelativeOffsetLeft() {\n        return element && element.parentNode ? element.getBoundingClientRect().left - element.parentNode.getBoundingClientRect().left : NaN;\n    }\n\n    function getTextTracks() {\n        return element ? element.textTracks : [];\n    }\n\n    function getTextTrack(kind, label, lang, isTTML, isEmbedded) {\n        if (element) {\n            for (var i = 0; i < element.textTracks.length; i++) {\n                //label parameter could be a number (due to adaptationSet), but label, the attribute of textTrack, is a string => to modify...\n                //label could also be undefined (due to adaptationSet)\n                if (element.textTracks[i].kind === kind && (label ? element.textTracks[i].label == label : true) &&\n                   element.textTracks[i].language === lang && element.textTracks[i].isTTML === isTTML && element.textTracks[i].isEmbedded === isEmbedded) {\n                    return element.textTracks[i];\n                }\n            }\n        }\n\n        return null;\n    }\n\n    function addTextTrack(kind, label, lang) {\n        if (element) {\n            return element.addTextTrack(kind, label, lang);\n        }\n        return null;\n    }\n\n    function appendChild(childElement) {\n        if (element) {\n            element.appendChild(childElement);\n            //in Chrome, we need to differenciate textTrack with same lang, kind and label but different format (vtt, ttml, etc...)\n            if (childElement.isTTML !== undefined) {\n                element.textTracks[element.textTracks.length - 1].isTTML = childElement.isTTML;\n                element.textTracks[element.textTracks.length - 1].isEmbedded = childElement.isEmbedded;\n            }\n        }\n    }\n\n    function removeChild(childElement) {\n        if (element) {\n            element.removeChild(childElement);\n        }\n    }\n\n    instance = {\n        initialize: initialize,\n        setCurrentTime: setCurrentTime,\n        play: play,\n        isPaused: isPaused,\n        pause: pause,\n        isSeeking: isSeeking,\n        getTime: getTime,\n        getPlaybackRate: getPlaybackRate,\n        getPlayedRanges: getPlayedRanges,\n        getEnded: getEnded,\n        setStallState: setStallState,\n        getElement: getElement,\n        setElement: setElement,\n        setSource: setSource,\n        getSource: getSource,\n        getVideoContainer: getVideoContainer,\n        setVideoContainer: setVideoContainer,\n        getTTMLRenderingDiv: getTTMLRenderingDiv,\n        setTTMLRenderingDiv: setTTMLRenderingDiv,\n        getPlaybackQuality: getPlaybackQuality,\n        addEventListener: addEventListener,\n        removeEventListener: removeEventListener,\n        getReadyState: getReadyState,\n        getBufferRange: getBufferRange,\n        getClientWidth: getClientWidth,\n        getClientHeight: getClientHeight,\n        getTextTracks: getTextTracks,\n        getTextTrack: getTextTrack,\n        addTextTrack: addTextTrack,\n        appendChild: appendChild,\n        removeChild: removeChild,\n        getVideoWidth: getVideoWidth,\n        getVideoHeight: getVideoHeight,\n        getVideoRelativeOffsetTop: getVideoRelativeOffsetTop,\n        getVideoRelativeOffsetLeft: getVideoRelativeOffsetLeft,\n        reset: reset\n    };\n\n    return instance;\n}\n\nVideoModel.__dashjs_factory_name = 'VideoModel';\nexport default FactoryMaker.getSingletonFactory(VideoModel);\n"]}