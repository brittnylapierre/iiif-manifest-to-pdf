{"version":3,"sources":["../../../../../src/streaming/text/EmbeddedTextHtmlRender.js"],"names":[],"mappings":"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","file":"EmbeddedTextHtmlRender.js","sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport FactoryMaker from '../../core/FactoryMaker';\n\nfunction EmbeddedTextHtmlRender() {\n\n    let captionId = 0;\n    let instance;\n\n    /* HTML Rendering functions */\n    function checkIndent(chars) {\n        let line = '';\n\n        for (let c = 0; c < chars.length; ++c) {\n            let uc = chars[c];\n            line += uc.uchar;\n        }\n\n        let l = line.length;\n        let ll = line.replace(/^\\s+/,'').length;\n        return l - ll;\n    }\n\n    function getRegionProperties(region) {\n        return 'left: ' + (region.x * 3.125) + '%; top: ' + (region.y1 * 6.66) + '%; width: ' + (100 - (region.x * 3.125)) + '%; height: ' + (Math.max((region.y2 - 1) - region.y1, 1) * 6.66) + '%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;';\n    }\n\n    function createRGB(color) {\n        if (color === 'red') {\n            return 'rgb(255, 0, 0)';\n        } else if (color === 'green') {\n            return 'rgb(0, 255, 0)';\n        } else if (color === 'blue') {\n            return 'rgb(0, 0, 255)';\n        } else if (color === 'cyan') {\n            return 'rgb(0, 255, 255)';\n        } else if (color === 'magenta') {\n            return 'rgb(255, 0, 255)';\n        } else if (color === 'yellow') {\n            return 'rgb(255, 255, 0)';\n        } else if (color === 'white') {\n            return 'rgb(255, 255, 255)';\n        } else if (color === 'black') {\n            return 'rgb(0, 0, 0)';\n        }\n        return color;\n    }\n\n    function getStyle(videoElement, style) {\n        const fontSize = videoElement.videoHeight / 15.0;\n        if (style) {\n            return 'font-size: ' + fontSize + 'px; font-family: Menlo, Consolas, \\'Cutive Mono\\', monospace; color: ' + ((style.foreground) ? createRGB(style.foreground) : 'rgb(255, 255, 255)') + '; font-style: ' + (style.italics ? 'italic' : 'normal') + '; text-decoration: ' + (style.underline ? 'underline' : 'none') + '; white-space: pre; background-color: ' + ((style.background) ? createRGB(style.background) : 'transparent') + ';';\n        } else {\n            return 'font-size: ' + fontSize + 'px; font-family: Menlo, Consolas, \\'Cutive Mono\\', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;';\n        }\n    }\n\n    function ltrim(s) {\n        let trimmed = s.replace(/^\\s+/g, '');\n        return trimmed;\n    }\n    function rtrim(s) {\n        let trimmed = s.replace(/\\s+$/g, '');\n        return trimmed;\n    }\n\n\n    function createHTMLCaptionsFromScreen(videoElement, startTime, endTime, captionScreen) {\n\n        let currRegion = null;\n        let existingRegion = null;\n        let lastRowHasText = false;\n        let lastRowIndentL = -1;\n        let currP = { start: startTime, end: endTime, spans: [] };\n        let currentStyle = 'style_cea608_white_black';\n        let seenRegions = { };\n        let styleStates = { };\n        let regions = [];\n        let r, s;\n\n        for (r = 0; r < 15; ++r) {\n            let row = captionScreen.rows[r];\n            let line = '';\n            let prevPenState = null;\n\n            if (false === row.isEmpty()) {\n                /* Row is not empty */\n\n                /* Get indentation of this row */\n                let rowIndent = checkIndent(row.chars);\n\n                /* Create a new region is there is none */\n                if (currRegion === null) {\n                    currRegion = { x: rowIndent, y1: r, y2: (r + 1), p: [] };\n                }\n\n                /* Check if indentation has changed and we had text of last row */\n                if ((rowIndent !== lastRowIndentL) && lastRowHasText) {\n                    currRegion.p.push(currP);\n                    currP = { start: startTime, end: endTime, spans: [] };\n                    currRegion.y2 = r;\n                    currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n                    if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                        regions.push(currRegion);\n                        seenRegions[currRegion.name] = currRegion;\n                    } else {\n                        existingRegion = seenRegions[currRegion.name];\n                        existingRegion.p.contat(currRegion.p);\n                    }\n\n                    currRegion = { x: rowIndent, y1: r, y2: (r + 1), p: [] };\n                }\n\n                for (let c = 0; c < row.chars.length; ++c) {\n                    let uc = row.chars[c];\n                    let currPenState = uc.penState;\n                    if ((prevPenState === null) || (!currPenState.equals(prevPenState))) {\n                        if (line.trim().length > 0) {\n                            currP.spans.push({ name: currentStyle, line: line, row: r });\n                            line = '';\n                        }\n\n                        let currPenStateString = 'style_cea608_' + currPenState.foreground + '_' + currPenState.background;\n                        if (currPenState.underline) {\n                            currPenStateString += '_underline';\n                        }\n                        if (currPenState.italics) {\n                            currPenStateString += '_italics';\n                        }\n\n                        if (!styleStates.hasOwnProperty(currPenStateString)) {\n                            styleStates[currPenStateString] = JSON.parse(JSON.stringify(currPenState));\n                        }\n\n                        prevPenState = currPenState;\n\n                        currentStyle = currPenStateString;\n                    }\n\n                    line += uc.uchar;\n                }\n\n                if (line.trim().length > 0) {\n                    currP.spans.push({ name: currentStyle, line: line, row: r });\n                }\n\n                lastRowHasText = true;\n                lastRowIndentL = rowIndent;\n            } else {\n                /* Row is empty */\n                lastRowHasText = false;\n                lastRowIndentL = -1;\n\n                if (currRegion) {\n                    currRegion.p.push(currP);\n                    currP = { start: startTime, end: endTime, spans: [] };\n                    currRegion.y2 = r;\n                    currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n                    if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                        regions.push(currRegion);\n                        seenRegions[currRegion.name] = currRegion;\n                    } else {\n                        existingRegion = seenRegions[currRegion.name];\n                        existingRegion.p.contat(currRegion.p);\n                    }\n\n                    currRegion = null;\n                }\n\n            }\n        }\n\n        if (currRegion) {\n            currRegion.p.push(currP);\n            currRegion.y2 = r + 1;\n            currRegion.name = 'region_' + currRegion.x + '_' + currRegion.y1 + '_' + currRegion.y2;\n            if (false === seenRegions.hasOwnProperty(currRegion.name)) {\n                regions.push(currRegion);\n                seenRegions[currRegion.name] = currRegion;\n            } else {\n                existingRegion = seenRegions[currRegion.name];\n                existingRegion.p.contat(currRegion.p);\n            }\n\n            currRegion = null;\n        }\n\n        //log(styleStates);\n        //log(regions);\n\n        let captionsArray = [];\n\n        /* Loop thru regions */\n        for (r = 0; r < regions.length; ++r) {\n            let region = regions[r];\n\n            let cueID = 'sub_cea608_' + (captionId++);\n            let finalDiv = document.createElement('div');\n            finalDiv.id = cueID;\n            let cueRegionProperties = getRegionProperties(region);\n            finalDiv.style.cssText = 'position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;' + cueRegionProperties;\n\n            let bodyDiv = document.createElement('div');\n            bodyDiv.className = 'paragraph bodyStyle';\n            bodyDiv.style.cssText = getStyle(videoElement);\n\n            let cueUniWrapper = document.createElement('div');\n            cueUniWrapper.className = 'cueUniWrapper';\n            cueUniWrapper.style.cssText = 'unicode-bidi: normal; direction: ltr;';\n\n            for (let p = 0; p < region.p.length; ++p) {\n                let ptag = region.p[p];\n                let lastSpanRow = 0;\n                for (s = 0; s < ptag.spans.length; ++s) {\n                    let span = ptag.spans[s];\n                    if (span.line.length > 0) {\n                        if ((s !== 0) && lastSpanRow != span.row) {\n                            let brElement = document.createElement('br');\n                            brElement.className = 'lineBreak';\n                            cueUniWrapper.appendChild(brElement);\n                        }\n                        let sameRow = false;\n                        if (lastSpanRow === span.row) {\n                            sameRow = true;\n                        }\n                        lastSpanRow = span.row;\n                        let spanStyle = styleStates[span.name];\n                        let spanElement = document.createElement('span');\n                        spanElement.className = 'spanPadding ' + span.name + ' customSpanColor';\n                        spanElement.style.cssText = getStyle(videoElement, spanStyle);\n                        /* If this is not the first span, and it's on the same\n                         * row as the last one */\n                        if ((s !== 0) && sameRow) {\n                            /* and it's the last span on this row */\n                            if (s === ptag.spans.length - 1) {\n                                /* trim only the right side */\n                                spanElement.textContent = rtrim(span.line);\n                            } else {\n                                /* don't trim at all */\n                                spanElement.textContent = span.line;\n                            }\n                        } else {\n                            /* if there is more than 1 span and this isn't the last span */\n                            if (ptag.spans.length > 1 && s < (ptag.spans.length - 1)) {\n                                /* Check if next text is on same row */\n                                if (span.row === ptag.spans[s + 1].row) {\n                                    /* Next element on same row, trim start */\n                                    spanElement.textContent = ltrim(span.line);\n                                } else {\n                                    /* Different rows, trim both */\n                                    spanElement.textContent = span.line.trim();\n                                }\n                            } else {\n                                spanElement.textContent = span.line.trim();\n                            }\n                        }\n                        cueUniWrapper.appendChild(spanElement);\n                    }\n                }\n            }\n\n            bodyDiv.appendChild(cueUniWrapper);\n\n            finalDiv.appendChild(bodyDiv);\n\n            let fontSize = { 'bodyStyle': ['%', 90] };\n            for (s in styleStates) {\n                if (styleStates.hasOwnProperty(s)) {\n                    fontSize[s] = ['%', 90];\n                }\n            }\n\n            captionsArray.push({ type: 'html',\n                                start: startTime,\n                                end: endTime,\n                                cueHTMLElement: finalDiv,\n                                cueID: cueID,\n                                cellResolution: [32, 15],\n                                isFromCEA608: true,\n                                regions: regions,\n                                regionID: region.name,\n                                videoHeight: videoElement.videoHeight,\n                                videoWidth: videoElement.videoWidth,\n                                fontSize: fontSize,\n                                lineHeight: {},\n                                linePadding: {}\n                               });\n        }\n        return captionsArray;\n    }\n\n    instance = {\n        createHTMLCaptionsFromScreen: createHTMLCaptionsFromScreen\n    };\n    return instance;\n}\n\nEmbeddedTextHtmlRender.__dashjs_factory_name = 'EmbeddedTextHtmlRender';\nexport default FactoryMaker.getSingletonFactory(EmbeddedTextHtmlRender);\n"]}