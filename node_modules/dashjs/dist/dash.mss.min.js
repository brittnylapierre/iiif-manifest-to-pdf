/*! v2.6.7-e2394a6, 2018-03-14T14:47:11Z */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"extend",value:function(a,b){if(a){var c=!!b&&b.override,d=!!b&&b.publicOnly;for(var e in a)!a.hasOwnProperty(e)||this[e]&&!c||d&&-1===a[e].indexOf("public_")||(this[e]=a[e])}}}]),a}();c.default=f,b.exports=c.default},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a(1),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.FRAGMENT_INFO_LOADING_COMPLETED="fragmentInfoLoadingCompleted"}return f(b,a),b}(i.default),k=new j;c.default=k,b.exports=c.default},{1:1}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){}function c(){u=!1,y=null,z=null,A=0,B=NaN,C.registerExternalController(r),v=C.getType(),s=C.getFragmentModel(),t=C.getIndexHandler()}function d(){return C.getRepresentationController().getCurrentRepresentation()}function e(a){s.executeRequest(a)}function f(a){return a&&a.url&&(a.url=a.url.replace("Fragments","FragmentInfo"),a.type="FragmentInfoSegment"),a}function h(a){if(null!==a&&a.action===a.ACTION_COMPLETE)return void o();if(null!==a){if(x=a.startTime+a.duration,a=f(a),C.getFragmentModel().isFragmentLoadedOrPending(a))return a=t.getNextSegmentRequest(d()),void h(a);H("[FragmentInfoController]["+v+"] onFragmentRequest "+a.url),e(a)}else H("[FragmentInfoController]["+v+"] bufferFragmentInfo failed")}function j(){var a;if(u){H("[FragmentInfoController]["+v+"] Start buffering process..."),a=x,H("[FragmentInfoController]["+v+"] loadNextFragment for time: "+a);var b=d();h(t.getSegmentRequestForTime(b,a))}}function k(a){var b=Math.round(Math.min(1e3*a,2e3));H("[FragmentInfoController]["+v+"] Check buffer delta = "+b+" ms"),clearTimeout(w),w=setTimeout(function(){w=null,j()},b)}function l(a){if(a.streamProcessor===C){var b=a.fragmentInfo.request,c=void 0,d=void 0;if(!a.fragmentInfo.response)return void H("[FragmentInfoController]["+v+"] ERROR loading ",b.url);B=b.duration,H("[FragmentInfoController]["+v+"] FragmentInfo loaded ",b.url);try{(0,i.default)(q).create({metricsModel:E,playbackController:F,ISOBoxer:G,log:H}).updateSegmentList(a.fragmentInfo,C),c=((new Date).getTime()-y)/1e3,d=x+B-z,A=d-c>0?d-c:0,k(A)}catch(a){H("[FragmentInfoController]["+v+"] ERROR - Internal error while processing fragment info segment ")}}}function m(){u&&(y=(new Date).getTime(),z=x,H("[FragmentInfoController]["+v+"] startPlayback"),j.call(this))}function n(){var a=void 0;if(!0!==u){D.on(g.default.FRAGMENT_INFO_LOADING_COMPLETED,l,r),u=!0,H("[FragmentInfoController]["+v+"] START");var b=d();a=b.segments,a&&a.length>0?(x=a[a.length-1].presentationStartTime-a[a.length-1].duration,m()):(t.updateSegmentList(b),a=b.segments,a&&a.length>0&&(x=a[a.length-1].presentationStartTime-a[a.length-1].duration),m())}}function o(){u&&(H("[FragmentInfoController]["+v+"] STOP"),D.off(g.default.FRAGMENT_INFO_LOADING_COMPLETED,l,r),clearTimeout(w),u=!1,y=null,z=null)}function p(){o(),C.unregisterExternalController(r)}a=a||{};var q=this.context,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=a.streamProcessor,D=a.eventBus,E=a.metricsModel,F=a.playbackController,G=a.ISOBoxer,H=a.log;return r={initialize:c,controllerType:"MssFragmentInfoController",start:n,reset:p},b(),r}Object.defineProperty(c,"__esModule",{value:!0});var f=a(2),g=d(f),h=a(4),i=d(h);e.__dashjs_factory_name="MssFragmentInfoController",c.default=dashjs.FactoryMaker.getClassFactory(e),b.exports=c.default},{2:2,4:4}],4:[function(a,b,c){"use strict";function d(a){function b(){}function c(a,b,c,e){var f=e.getRepresentationController(),g=f.getCurrentRepresentation(),h=e.getIndexHandler(),i=g.adaptation.period.mpd.manifest,j=i.Period_asArray[g.adaptation.period.index].AdaptationSet_asArray[g.adaptation.index],k=j.SegmentTemplate.SegmentTimeline.S,m=b.entry,n=void 0,o=void 0,p=null,q=j.contentType,r=0,s=null,t=void 0;if("dynamic"===i.type&&0!==m.length){if(n=m[0],o=k[k.length-1].tManifest?parseFloat(k[k.length-1].tManifest):k[k.length-1].t,n.fragment_absolute_time<=o)return t={start:k[0].t/j.SegmentTemplate.timescale,end:c.baseMediaDecodeTime/j.SegmentTemplate.timescale+a.duration},void d(a.mediaType,t,e.getStreamInfo().manifestInfo);if(l("[MssFragmentMoofProcessor][",q,"] Add new segment - t = ",n.fragment_absolute_time/1e7),p={},p.t=n.fragment_absolute_time,p.d=n.fragment_duration,k.push(p),i.timeShiftBufferDepth&&i.timeShiftBufferDepth>0){for(p=k[k.length-1],r=p.t,s=r-1e7*i.timeShiftBufferDepth,p=k[0];p.t<s;)l("[MssFragmentMoofProcessor]Remove segment  - t = "+p.t/1e7),k.splice(0,1),p=k[0];t={start:k[0].t/j.SegmentTemplate.timescale,end:c.baseMediaDecodeTime/j.SegmentTemplate.timescale+a.duration},d(a.mediaType,t,e.getStreamInfo().manifestInfo)}h.updateSegmentList(g)}}function d(a,b,c){var d=i.getMetricsFor(a).DVRInfo;d&&(0===d.length||d.length>0&&b.end>d[d.length-1].range.end)&&(l("[MssFragmentMoofProcessor][",a,"] Update DVR Infos ["+b.start+" - "+b.end+"]"),i.addDVRInfo(a,j.getTime(),c,b))}function e(a,b){var c=8,d=0;for(d=0;d<a.boxes.length;d++){if(a.boxes[d].type===b)return c;c+=a.boxes[d].size}return c}function f(a,b){var d=void 0;if(a.response){var f=k.parseBuffer(a.response),g=f.fetch("tfhd");g.track_ID=a.request.mediaInfo.index+1;var h=f.fetch("tfdt"),i=f.fetch("traf");null===h&&(h=k.createFullBox("tfdt",i,g),h.version=1,h.flags=0,h.baseMediaDecodeTime=Math.floor(a.request.startTime*a.request.timescale));var j=f.fetch("trun"),l=f.fetch("tfxd");l&&(l._parent.boxes.splice(l._parent.boxes.indexOf(l),1),l=null);var m=f.fetch("tfrf");m&&(c(a.request,m,h,b),m._parent.boxes.splice(m._parent.boxes.indexOf(m),1),m=null);var n=f.fetch("sepiff");if(null!==n){n.type="senc",n.usertype=void 0;var o=f.fetch("saio");if(null===o){o=k.createFullBox("saio",i),o.version=0,o.flags=0,o.entry_count=1,o.offset=[0];var p=k.createFullBox("saiz",i);if(p.version=0,p.flags=0,p.sample_count=n.sample_count,p.default_sample_info_size=0,p.sample_info_size=[],2&n.flags)for(d=0;d<n.sample_count;d+=1)p.sample_info_size[d]=10+6*n.entry[d].NumberOfEntries;else p.default_sample_info_size=8}}g.flags&=16777214,g.flags|=131072,j.flags|=1;var q=f.fetch("moof"),r=q.getLength();j.data_offset=r+8;var s=f.fetch("saio");if(null!==s){var t=e(q,"traf"),u=e(i,"senc");s.offset[0]=t+u+16}a.response=f.write()}}function g(a,b){if(a.response){var d=k.parseBuffer(a.response),e=d.fetch("tfhd");e.track_ID=a.request.mediaInfo.index+1;var f=d.fetch("tfdt"),g=d.fetch("traf");null===f&&(f=k.createFullBox("tfdt",g,e),f.version=1,f.flags=0,f.baseMediaDecodeTime=Math.floor(a.request.startTime*a.request.timescale));var h=d.fetch("tfrf");h&&(c(a.request,h,f,b),h._parent.boxes.splice(h._parent.boxes.indexOf(h),1),h=null)}}a=a||{};var h=void 0,i=a.metricsModel,j=a.playbackController,k=a.ISOBoxer,l=a.log;return h={convertFragment:f,updateSegmentList:g},b(),h}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssFragmentMoofProcessor",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],5:[function(a,b,c){"use strict";function d(a){function b(a){var b=D.createBox("ftyp",a);return b.major_brand="iso6",b.minor_version=1,b.compatible_brands=[],b.compatible_brands[0]="isom",b.compatible_brands[1]="iso6",b.compatible_brands[2]="msdh",b}function c(a){var b=D.createBox("moov",a);d(b);var c=D.createBox("trak",b);e(c);var l=D.createBox("mdia",c);f(l),g(l);var m=D.createBox("minf",l);switch(G.type){case C.VIDEO:h(m);break;case C.AUDIO:i(m)}j(D.createBox("dinf",m));var n=D.createBox("stbl",m);(D.createFullBox("stts",n)._data=[0,0,0,0,0,0,0,0],D.createFullBox("stsc",n)._data=[0,0,0,0,0,0,0,0],D.createFullBox("stco",n)._data=[0,0,0,0,0,0,0,0],D.createFullBox("stsz",n)._data=[0,0,0,0,0,0,0,0,0,0,0,0],k(n),v(D.createBox("mvex",b)),I&&E)&&t(b,E.getSupportedKeySystemsFromContentProtection(I))}function d(a){var b=D.createFullBox("mvhd",a);return b.version=1,b.creation_time=0,b.modification_time=0,b.timescale=z,b.duration=Math.round(F.duration*z),b.rate=1,b.volume=1,b.reserved1=0,b.reserved2=[0,0],b.matrix=[1,0,0,0,1,0,0,0,16384],b.pre_defined=[0,0,0,0,0,0],b.next_track_ID=J+1,b}function e(a){var b=D.createFullBox("tkhd",a);return b.version=1,b.flags=7,b.creation_time=0,b.modification_time=0,b.track_ID=J,b.reserved1=0,b.duration=Math.round(F.duration*z),b.reserved2=[0,0],b.layer=0,b.alternate_group=0,b.volume=1,b.reserved3=0,b.matrix=[1,0,0,0,1,0,0,0,16384],b.width=H.width,b.height=H.height,b}function f(a){var b=D.createFullBox("mdhd",a);return b.version=1,b.creation_time=0,b.modification_time=0,b.timescale=z,b.duration=Math.round(F.duration*z),b.language=G.lang||"und",b.pre_defined=0,b}function g(a){var b=D.createFullBox("hdlr",a);switch(b.pre_defined=0,G.type){case C.VIDEO:b.handler_type="vide";break;case C.AUDIO:b.handler_type="soun";break;default:b.handler_type="meta"}return b.name=H.id,b.reserved=[0,0,0],b}function h(a){var b=D.createFullBox("vmhd",a);return b.flags=1,b.graphicsmode=0,b.opcolor=[0,0,0],b}function i(a){var b=D.createFullBox("smhd",a);return b.flags=1,b.balance=0,b.reserved=0,b}function j(a){var b=D.createFullBox("dref",a);b.entry_count=1,b.entries=[];var c=D.createFullBox("url ",b,!1);return c.location="",c.flags=1,b.entries.push(c),b}function k(a){var b=D.createFullBox("stsd",a);switch(b.entries=[],G.type){case C.VIDEO:case C.AUDIO:b.entries.push(l(b))}return b.entry_count=b.entries.length,b}function l(a){var b=H.codecs.substring(0,H.codecs.indexOf("."));switch(b){case"avc1":return m(a,b);case"mp4a":return o(a,b);default:throw{name:"Unsupported codec",message:"Unsupported codec",data:{codec:b}}}}function m(a,b){var c=void 0;if(c=I?D.createBox("encv",a,!1):D.createBox("avc1",a,!1),c.reserved1=[0,0,0,0,0,0],c.data_reference_index=1,c.pre_defined1=0,c.reserved2=0,c.pre_defined2=[0,0,0],c.height=H.height,c.width=H.width,c.horizresolution=72,c.vertresolution=72,c.reserved3=0,c.frame_count=1,c.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c.depth=24,c.pre_defined3=65535,c.config=n(),I){var d=D.createBox("sinf",c);q(d,b),r(d),s(d)}return c}function n(){for(var a=null,b=15,c=[],d=[],e=0,f=0,g=0,h=H.codecPrivateData.split("00000001").slice(1),i=void 0,j=0;j<h.length;j++)switch(i=w(h[j]),31&i[0]){case A:c.push(i),b+=i.length+2;break;case B:d.push(i),b+=i.length+2}c.length>0&&(e=c[0][1],g=c[0][2],f=c[0][3]),a=new Uint8Array(b);var k=0;a[k++]=(4278190080&b)>>24,a[k++]=(16711680&b)>>16,a[k++]=(65280&b)>>8,a[k++]=255&b,a.set([97,118,99,67],k),k+=4,a[k++]=1,a[k++]=e,a[k++]=g,a[k++]=f,a[k++]=255,a[k++]=224|c.length;for(var l=0;l<c.length;l++)a[k++]=(65280&c[l].length)>>8,a[k++]=255&c[l].length,a.set(c[l],k),k+=c[l].length;a[k++]=d.length;for(var l=0;l<d.length;l++)a[k++]=(65280&d[l].length)>>8,a[k++]=255&d[l].length,a.set(d[l],k),k+=d[l].length;return a}function o(a,b){var c=void 0;if(c=I?D.createBox("enca",a,!1):D.createBox("mp4a",a,!1),c.reserved1=[0,0,0,0,0,0],c.data_reference_index=1,c.reserved2=[0,0],c.channelcount=H.audioChannels,c.samplesize=16,c.pre_defined=0,c.reserved_3=0,c.samplerate=H.audioSamplingRate<<16,c.esds=p(),I){var d=D.createBox("sinf",c);q(d,b),r(d),s(d)}return c}function p(){var a=w(H.codecPrivateData),b=34+a.length,c=new Uint8Array(b),d=0;return c[d++]=(4278190080&b)>>24,c[d++]=(16711680&b)>>16,c[d++]=(65280&b)>>8,c[d++]=255&b,c.set([101,115,100,115],d),d+=4,c.set([0,0,0,0],d),d+=4,c[d++]=3,c[d++]=20+a.length,c[d++]=(65280&J)>>8,c[d++]=255&J,c[d++]=0,c[d++]=4,c[d++]=15+a.length,c[d++]=64,c[d]=20,c[d]|=0,c[d++]|=1,c[d++]=255,c[d++]=255,c[d++]=255,c[d++]=(4278190080&H.bandwidth)>>24,c[d++]=(16711680&H.bandwidth)>>16,c[d++]=(65280&H.bandwidth)>>8,c[d++]=255&H.bandwidth,c[d++]=(4278190080&H.bandwidth)>>24,c[d++]=(16711680&H.bandwidth)>>16,c[d++]=(65280&H.bandwidth)>>8,c[d++]=255&H.bandwidth,c[d++]=5,c[d++]=a.length,c.set(a,d),c}function q(a,b){D.createBox("frma",a).data_format=x(b)}function r(a){var b=D.createFullBox("schm",a);b.flags=0,b.version=0,b.scheme_type=1667591779,b.scheme_version=65536}function s(a){u(D.createBox("schi",a))}function t(a,b){var c=void 0,d=void 0,e=void 0,f=void 0;for(e=0;e<b.length;e+=1)c=b[e].initData,f=D.parseBuffer(c),(d=f.fetch("pssh"))&&D.Utils.appendBox(a,d)}function u(a){var b=D.createFullBox("tenc",a);b.flags=0,b.version=0,b.default_IsEncrypted=1,b.default_IV_size=8,b.default_KID=I&&I.length>0&&I[0]["cenc:default_KID"]?I[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function v(a){var b=D.createFullBox("trex",a);return b.track_ID=J,b.default_sample_description_index=1,b.default_sample_duration=0,b.default_sample_size=0,b.default_sample_flags=0,b}function w(a){var b=new Uint8Array(a.length/2),c=void 0;for(c=0;c<a.length/2;c+=1)b[c]=parseInt(""+a[2*c]+a[2*c+1],16);return b}function x(a){var b=0,c=void 0;for(c=0;c<a.length;c+=1)b|=a.charCodeAt(c)<<8*(a.length-c-1);return b}function y(a){if(a&&a.adaptation){var d=void 0;return H=a,G=H.adaptation,F=G.period,J=G.index+1,I=F.mpd.manifest.Period_asArray[F.index].AdaptationSet_asArray[G.index].ContentProtection,d=D.createFile(),b(d),c(d),d.write()}}a=a||{};var z=1e7,A=7,B=8,C=a.constants,D=a.ISOBoxer,E=a.protectionController,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0;return{generateMoov:y}}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssFragmentMoovProcessor",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return a.length===b.length&&a.every(function(a,c){return a===b[c]})}function f(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}function g(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}function h(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("IV_size","uint",8),this._procEntries("entry",this.sample_count,function(a){this._procEntryField(a,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(a,"NumberOfEntries","uint",16),this._procSubEntries(a,"clearAndCryptedData",a.NumberOfEntries,function(a){this._procEntryField(a,"BytesOfClearData","uint",16),this._procEntryField(a,"BytesOfEncryptedData","uint",32)}))})}function i(){var a=[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178],b=[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159],c=[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244];e(this.usertype,a)&&(this._procFullBox(),this._parsing&&(this.type="tfxd"),this._procField("fragment_absolute_time","uint",1===this.version?64:32),this._procField("fragment_duration","uint",1===this.version?64:32)),e(this.usertype,b)&&(this._procFullBox(),this._parsing&&(this.type="tfrf"),this._procField("fragment_count","uint",8),this._procEntries("entry",this.fragment_count,function(a){this._procEntryField(a,"fragment_absolute_time","uint",1===this.version?64:32),this._procEntryField(a,"fragment_duration","uint",1===this.version?64:32)})),e(this.usertype,c)&&(this._parsing&&(this.type="sepiff"),h.call(this))}function j(a){function b(){q.addBoxProcessor("uuid",i),q.addBoxProcessor("saio",f),q.addBoxProcessor("saiz",g),q.addBoxProcessor("senc",h)}function c(b){return(0,n.default)(e).create({protectionController:o,constants:a.constants,ISOBoxer:a.ISOBoxer}).generateMoov(b)}function d(a,b){if(a){var c=a.request;if(c)if("MediaSegment"===c.type){var d=(0,l.default)(e).create({metricsModel:j,playbackController:k,ISOBoxer:q,log:r});d.convertFragment(a,b)}else"FragmentInfoSegment"===c.type&&(m.trigger(p.default.FRAGMENT_INFO_LOADING_COMPLETED,{fragmentInfo:a,streamProcessor:b}),a.sender=null)}}a=a||{};var e=this.context,j=a.metricsModel,k=a.playbackController,m=a.eventBus,o=a.protectionController,q=a.ISOBoxer,r=a.log,s=void 0;return s={generateMoov:c,processFragment:d},b(),s}Object.defineProperty(c,"__esModule",{value:!0});var k=a(4),l=d(k),m=a(5),n=d(m),o=a(2),p=d(o);j.__dashjs_factory_name="MssFragmentProcessor",c.default=dashjs.FactoryMaker.getClassFactory(j),b.exports=c.default},{2:2,4:4,5:5}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){}function c(a){var b=a.sender.getStreamProcessor(),c=new i.default,e=b.getRepresentationController(),f=e.getCurrentRepresentation(),g=void 0;g=f.adaptation.period,c.mediaType=f.adaptation.type,c.type=s,c.range=f.range,g.start,c.quality=f.index,c.mediaInfo=b.getMediaInfo(),c.representationId=f.id;var h=d(c,b.getStreamInfo().id);h.bytes=w.generateMoov(f),p.trigger(q.INIT_FRAGMENT_LOADED,{chunk:h,fragmentModel:b.getFragmentModel()}),a.sender=null}function d(a,b){var c=new g.default;return c.streamId=b,c.mediaInfo=a.mediaInfo,c.segmentType=a.type,c.start=a.startTime,c.duration=a.duration,c.end=c.start+c.duration,c.index=a.index,c.quality=a.quality,c.representationId=a.representationId,c}function e(a){var b=a.sender.getStreamProcessor();w.processFragment(a,b)}function f(){if(u.getIsDynamic()&&0!==u.getTime()){var b=u.getStreamController();if(b){b.getActiveStreamProcessors().forEach(function(b){if(b.getType()===r.VIDEO||b.getType()===r.AUDIO||b.getType()===r.FRAGMENTED_TEXT){var c=void 0,d=!1,e=b.getExternalControllers();for(c=0;c<e.length;c++)e[c].controllerType&&"MssFragmentInfoController"===e[c].controllerType&&(d=!0);if(!d){var f=(0,k.default)(n).create({streamProcessor:b,eventBus:p,metricsModel:t,playbackController:u,ISOBoxer:a.ISOBoxer,log:a.log});f.initialize(),f.start()}}})}}}function h(){p.on(q.INIT_REQUESTED,c,y,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(q.PLAYBACK_SEEK_ASKED,f,y,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(q.FRAGMENT_LOADING_COMPLETED,e,y,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH)}function j(){p.off(q.INIT_REQUESTED,c,this),p.off(q.PLAYBACK_SEEK_ASKED,f,this),p.off(q.FRAGMENT_LOADING_COMPLETED,e,this)}function l(){return x=(0,o.default)(n).create(a)}a=a||{};var n=this.context,p=a.eventBus,q=a.events,r=a.constants,s=a.initSegmentType,t=a.metricsModel,u=a.playbackController,v=a.protectionController,w=(0,m.default)(n).create({metricsModel:t,playbackController:u,protectionController:v,eventBus:p,constants:r,ISOBoxer:a.ISOBoxer,log:a.log}),x=void 0,y=void 0;return y={reset:j,createMssParser:l,registerEvents:h},b(),y}Object.defineProperty(c,"__esModule",{value:!0});var f=a(10),g=d(f),h=a(11),i=d(h),j=a(3),k=d(j),l=a(6),m=d(l),n=a(9),o=d(n);e.__dashjs_factory_name="MssHandler",c.default=dashjs.FactoryMaker.getClassFactory(e),b.exports=c.default},{10:10,11:11,3:3,6:6,9:9}],8:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a(7),f=d(e),g="undefined"!=typeof window&&window||b,h=g.dashjs;h||(h=g.dashjs={}),h.MssHandler=f.default,c.default=h,c.MssHandler=f.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{7:7}],9:[function(a,b,c){"use strict";function d(a){function b(){D=a.mediaPlayerModel}function c(a){var b={},c=void 0,e=void 0;b.duration=0===parseFloat(a.getAttribute("Duration"))?1/0:parseFloat(a.getAttribute("Duration"))/y,b.AdaptationSet_asArray=[],c=a.getElementsByTagName("StreamIndex");for(var f=0;f<c.length;f++)null!==(e=d(c[f]))&&b.AdaptationSet_asArray.push(e);return b.AdaptationSet_asArray.length>0&&(b.AdaptationSet=b.AdaptationSet_asArray.length>1?b.AdaptationSet_asArray:b.AdaptationSet_asArray[0]),b}function d(a){var b={},c=[],d={},f=void 0,g=void 0,i=void 0,j=void 0;for(b.id=a.getAttribute("Name")?a.getAttribute("Name"):a.getAttribute("Type"),b.contentType=a.getAttribute("Type"),b.lang=a.getAttribute("Language")||"und",b.mimeType=B[b.contentType],b.subType=a.getAttribute("Subtype"),b.maxWidth=a.getAttribute("MaxWidth"),b.maxHeight=a.getAttribute("MaxHeight"),d=h(a),f=a.getElementsByTagName("QualityLevel"),j=0;j<f.length;j++)f[j].BaseURL=b.BaseURL,f[j].mimeType=b.mimeType,f[j].Id=b.id+"_"+f[j].getAttribute("Index"),null!==(g=e(f[j],a))&&(g.SegmentTemplate=d,c.push(g));return 0===c.length?null:(b.Representation=c.length>1?c:c[0],b.Representation_asArray=c,b.SegmentTemplate=d,i=d.SegmentTimeline.S_asArray,{start:i[0].t/d.timescale,end:(i[i.length-1].t+i[i.length-1].d)/d.timescale},b)}function e(a,b){var c={},d=null,e=b.getAttribute("Type");if(c.id=a.Id,c.bandwidth=parseInt(a.getAttribute("Bitrate"),10),c.mimeType=a.mimeType,c.width=parseInt(a.getAttribute("MaxWidth"),10),c.height=parseInt(a.getAttribute("MaxHeight"),10),d=a.getAttribute("FourCC"),null!==d&&""!==d||(d=b.getAttribute("FourCC")),null===d||""===d)if("audio"===e)d="AAC";else if("video"===e)return v('[MssParser] FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;return-1===z.indexOf(d.toUpperCase())?(v("[MssParser] Codec not supported: "+d),null):("H264"===d||"AVC1"===d?c.codecs=f(a):d.indexOf("AAC")>=0?(c.codecs=g(a,d),c.audioSamplingRate=parseInt(a.getAttribute("SamplingRate"),10),c.audioChannels=parseInt(a.getAttribute("Channels"),10)):(d.indexOf("TTML")||d.indexOf("DFXP"))&&(c.codecs=x.STPP),c.codecPrivateData=""+a.getAttribute("CodecPrivateData"),c.BaseURL=a.BaseURL,c)}function f(a){var b=a.getAttribute("CodecPrivateData").toString(),c=void 0;return c=/00000001[0-9]7/.exec(b),"avc1."+(c&&c[0]?b.substr(b.indexOf(c[0])+10,6):void 0)}function g(a,b){var c=0,d=a.getAttribute("CodecPrivateData").toString(),e=parseInt(a.getAttribute("SamplingRate"),10),f=void 0,g=void 0,h=void 0,i=void 0;return"AACH"===b&&(c=5),void 0===d||""===d?(c=2,h=A[e],"AACH"===b?(c=5,d=new Uint8Array(4),i=A[2*e],d[0]=c<<3|h>>1,d[1]=h<<7|a.Channels<<3|i>>1,d[2]=i<<7|8,d[3]=0,g=new Uint16Array(2),g[0]=(d[0]<<8)+d[1],g[1]=(d[2]<<8)+d[3],f=g[0].toString(16),f=g[0].toString(16)+g[1].toString(16)):(d=new Uint8Array(2),d[0]=c<<3|h>>1,d[1]=h<<7|parseInt(a.getAttribute("Channels"),10)<<3,g=new Uint16Array(1),g[0]=(d[0]<<8)+d[1],f=g[0].toString(16)),d=""+f,d=d.toUpperCase(),a.setAttribute("CodecPrivateData",d)):0===c&&(c=(248&parseInt(d.substr(0,2),16))>>3),"mp4a.40."+c}function h(a){var b={},c=void 0;return c=a.getAttribute("Url").replace("{bitrate}","$Bandwidth$"),c=c.replace("{start time}","$Time$"),b.media=c,b.timescale=y,b.SegmentTimeline=i(a),b}function i(a){var b={},c=a.getElementsByTagName("c"),d=[],e=void 0,f=void 0,g=void 0,h=void 0,i=0;for(h=0;h<c.length;h++)e={},g=c[h].getAttribute("t"),e.tManifest=parseFloat(g),e.t=parseFloat(g),e.d=parseFloat(c[h].getAttribute("d")),0!==h||e.t||(e.t=0),h>0&&(f=d[d.length-1],f.d||(f.tManifest?f.d=parseFloat(g)-parseFloat(f.tManifest):f.d=e.t-f.t),e.t||(f.tManifest?(e.tManifest=parseFloat(f.tManifest)+f.d,e.t=parseFloat(e.tManifest)):e.t=f.t+f.d)),i+=e.d,d.push(e);return b.S=d,b.S_asArray=d,b.duration=i/y,b}function j(a){var b=void 0,c=void 0,d=void 0,e=void 0;return b=u.decodeArray(a.firstChild.data),c=k(b),c=new Uint16Array(c.buffer),c=String.fromCharCode.apply(null,c),d=(new DOMParser).parseFromString(c,"application/xml"),e=d.querySelector("KID").textContent,e=u.decodeArray(e),l(e),e}function k(a){var b=void 0,c=void 0,d=void 0,e=0;for((a[e+3]<<24)+(a[e+2]<<16)+(a[e+1]<<8)+a[e],e+=4,(a[e+1]<<8)+a[e],e+=2;e<a.length;)if(b=(a[e+1]<<8)+a[e],e+=2,1===b)return c=(a[e+1]<<8)+a[e],e+=2,d=new Uint8Array(c),d.set(a.subarray(e,e+c)),d;return null}function l(a){m(a,0,3),m(a,1,2),m(a,4,5),m(a,6,7)}function m(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function n(a){var b={__text:a.firstChild.data,__prefix:"mspr"};return{schemeIdUri:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",value:"com.microsoft.playready",pro:b,pro_asArray:b}}function o(a,b){var c=new Uint8Array(2+b.length);c[0]=18,c[1]=16,c.set(b,2);var d=32+c.length,e=new Uint8Array(d),f=0;return e[f++]=(4278190080&d)>>24,e[f++]=(16711680&d)>>16,e[f++]=(65280&d)>>8,e[f++]=255&d,e.set([112,115,115,104,0,0,0,0],f),f+=8,e.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],f),f+=16,e[f++]=(4278190080&c.length)>>24,e[f++]=(16711680&c.length)>>16,e[f++]=(65280&c.length)>>8,e[f++]=255&c.length,e.set(c,f),e=String.fromCharCode.apply(null,e),e=u.encodeASCII(e),{schemeIdUri:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",value:"com.widevine.alpha",pssh:{__text:e}}}function p(a,b){var d={},e=[],f=a.getElementsByTagName("SmoothStreamingMedia")[0],g=a.getElementsByTagName("Protection")[0],h=null,i=void 0,k=void 0,l=void 0,m=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0;for(d.protocol="MSS",d.profiles="urn:mpeg:dash:profile:isoff-live:2011",d.type="TRUE"===f.getAttribute("IsLive")?"dynamic":"static",d.timeShiftBufferDepth=parseFloat(f.getAttribute("DVRWindowLength"))/y,d.mediaPresentationDuration=0===parseFloat(f.getAttribute("Duration"))?1/0:parseFloat(f.getAttribute("Duration"))/y,d.minBufferTime=D.getStableBufferTime(),d.ttmlTimeIsRelative=!0,"dynamic"===d.type&&(d.availabilityStartTime=new Date(b.getTime()-1e3*d.timeShiftBufferDepth),d.refreshManifestOnSwitchTrack=!0,d.doNotUpdateDVRWindowOnBufferUpdated=!0,d.ignorePostponeTimePeriod=!0),d.Period=c(f),d.Period_asArray=[d.Period],i=d.Period,i.start=0,void 0!==g&&(h=a.getElementsByTagName("ProtectionHeader")[0],h.firstChild.data=h.firstChild.data.replace(/\n|\r/g,""),m=j(h),l=n(h),l["cenc:default_KID"]=m,e.push(l),l=o(h,m),l["cenc:default_KID"]=m,e.push(l),d.ContentProtection=e,d.ContentProtection_asArray=e),k=i.AdaptationSet_asArray,s=0;s<k.length;s+=1)k[s].SegmentTemplate.initialization="$Bandwidth$",void 0!==d.ContentProtection&&(k[s].ContentProtection=d.ContentProtection,k[s].ContentProtection_asArray=d.ContentProtection_asArray),"dynamic"===d.type&&d.timeShiftBufferDepth>0&&"video"===k[s].contentType&&d.timeShiftBufferDepth>k[s].SegmentTemplate.SegmentTimeline.duration&&(d.timeShiftBufferDepth=k[s].SegmentTemplate.SegmentTimeline.duration);if(d.timeShiftBufferDepth<d.minBufferTime&&(d.minBufferTime=d.timeShiftBufferDepth),delete d.ContentProtection,delete d.ContentProtection_asArray,"static"===d.type){for(s=0;s<k.length;s++)"audio"!==k[s].contentType&&"video"!==k[s].contentType||(r=k[s].SegmentTemplate.SegmentTimeline.S_asArray,q=r[0].t,void 0===p&&(p=q),p=Math.min(p,q),d.mediaPresentationDuration=Math.min(d.mediaPresentationDuration,((r[r.length-1].t+r[r.length-1].d)/y).toFixed(3)));if(p>0){for(s=0;s<k.length;s++){for(r=k[s].SegmentTemplate.SegmentTimeline.S_asArray,t=0;t<r.length;t++)r[t].tManifest||(r[t].tManifest=r[t].t),r[t].t-=p;"audio"!==k[s].contentType&&"video"!==k[s].contentType||(i.start=Math.max(r[0].t,i.start))}i.start/=y}}return i.duration=d.mediaPresentationDuration,d}function q(a){var b=null;if(window.DOMParser)try{var c=new window.DOMParser;if(b=c.parseFromString(a,"text/xml"),b.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML")}catch(d){w.manifestError("parsing the manifest failed","parse",a,d),b=null}return b}function r(){return null}function s(){return null}function t(a){var b=null,c=null,d=window.performance.now();b=q(a);var e=window.performance.now();if(null===b)return null;c=p(b,new Date);var f=window.performance.now();return v("Parsing complete: (xmlParsing: "+(e-d).toPrecision(3)+"ms, mss2dash: "+(f-e).toPrecision(3)+"ms, total: "+((f-d)/1e3).toPrecision(3)+"s)"),c}a=a||{};var u=a.BASE64,v=a.log,w=a.errHandler,x=a.constants,y=1e7,z=["AAC","AACL","AVC1","H264","TTML","DFXP"],A={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},B={video:"video/mp4",audio:"audio/mp4",text:"application/mp4"},C=void 0,D=void 0;return C={parse:t,getMatchers:r,getIron:s},b(),C}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssParser",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(){d(this,a),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null};c.default=e,b.exports=c.default},{}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(){d(this,a),this.action=a.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null};e.ACTION_DOWNLOAD="download",e.ACTION_COMPLETE="complete",c.default=e,b.exports=c.default},{}]},{},[8]);
//# sourceMappingURL=dash.mss.min.js.map