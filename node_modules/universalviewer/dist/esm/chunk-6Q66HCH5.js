import{A as _e,B as Fe,a as C,b as Oe,c as E,d as Le,e as q,h as He,l as we,m as T,n as K,o as Be,p as B,q as r,r as St,u as ee,x as _}from"./chunk-WDDAVPLK.js";import{b as O,c as de}from"./chunk-YAXTLTJC.js";var fe=O(Q=>{function Ne(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function kt(e,t,i){}function Rt(e,t,i){}var Ot=/javascript\s*\:/img;function Lt(e,t){return Ot.test(t)?"":t}Q.whiteList=Ne();Q.getDefaultWhiteList=Ne;Q.onAttr=kt;Q.onIgnoreAttr=Rt;Q.safeAttrValue=Lt});var ge=O((Ui,Ue)=>{Ue.exports={indexOf:function(e,t){var i,s;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,s=e.length;i<s;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var s,n;if(Array.prototype.forEach)return e.forEach(t,i);for(s=0,n=e.length;s<n;s++)t.call(i,e[s],s,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}});var Ge=O((Pi,Pe)=>{var W=ge();function Ht(e,t){e=W.trimRight(e),e[e.length-1]!==";"&&(e+=";");var i=e.length,s=!1,n=0,a=0,l="";function o(){if(!s){var h=W.trim(e.slice(n,a)),f=h.indexOf(":");if(f!==-1){var x=W.trim(h.slice(0,f)),b=W.trim(h.slice(f+1));if(x){var I=t(n,l.length,x,b,h);I&&(l+=I+"; ")}}}n=a+1}for(;a<i;a++){var c=e[a];if(c==="/"&&e[a+1]==="*"){var u=e.indexOf("*/",a+2);if(u===-1)break;a=u+1,n=a+1,s=!1}else c==="("?s=!0:c===")"?s=!1:c===";"?s||o():c===`
`&&o()}return W.trim(l)}Pe.exports=Ht});var Ve=O((Mi,Qe)=>{var ie=fe(),wt=Ge(),Gi=ge();function Me(e){return e==null}function Bt(e){var t={};for(var i in e)t[i]=e[i];return t}function ye(e){e=Bt(e||{}),e.whiteList=e.whiteList||ie.whiteList,e.onAttr=e.onAttr||ie.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||ie.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||ie.safeAttrValue,this.options=e}ye.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,s=i.whiteList,n=i.onAttr,a=i.onIgnoreAttr,l=i.safeAttrValue,o=wt(e,function(c,u,h,f,x){var b=s[h],I=!1;if(b===!0?I=b:typeof b=="function"?I=b(f):b instanceof RegExp&&(I=b.test(f)),I!==!0&&(I=!1),f=l(h,f),!!f){var $={position:u,sourcePosition:c,source:x,isWhite:I};if(I){var v=n(h,f,$);return Me(v)?h+":"+f:v}else{var v=a(h,f,$);if(!Me(v))return v}}});return o};Qe.exports=ye});var ne=O((se,me)=>{var De=fe(),ze=Ve();function _t(e,t){var i=new ze(t);return i.process(e)}se=me.exports=_t;se.FilterCSS=ze;for(pe in De)se[pe]=De[pe];var pe;typeof window!="undefined"&&(window.filterCSS=me.exports)});var re=O((yi,qe)=>{qe.exports={indexOf:function(e,t){var i,s;if(Array.prototype.indexOf)return e.indexOf(t);for(i=0,s=e.length;i<s;i++)if(e[i]===t)return i;return-1},forEach:function(e,t,i){var s,n;if(Array.prototype.forEach)return e.forEach(t,i);for(s=0,n=e.length;s<n;s++)t.call(i,e[s],s,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,i=t.exec(e);return i?i.index:-1}}});var be=O(p=>{var Ft=ne().FilterCSS,Nt=ne().getDefaultWhiteList,ae=re();function Je(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var We=new Ft;function Ut(e,t,i){}function Pt(e,t,i){}function Gt(e,t,i){}function Mt(e,t,i){}function Xe(e){return e.replace(Qt,"&lt;").replace(Vt,"&gt;")}function yt(e,t,i,s){if(i=st(i),t==="href"||t==="src"){if(i=ae.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i[0]==="#"||i[0]==="/"))return""}else if(t==="background"){if(oe.lastIndex=0,oe.test(i))return""}else if(t==="style"){if(je.lastIndex=0,je.test(i)||(Ze.lastIndex=0,Ze.test(i)&&(oe.lastIndex=0,oe.test(i))))return"";s!==!1&&(s=s||We,i=s.process(i))}return i=nt(i),i}var Qt=/</g,Vt=/>/g,Dt=/"/g,zt=/&quot;/g,qt=/&#([a-zA-Z0-9]*);?/gim,Jt=/&colon;?/gim,Wt=/&newline;?/gim,oe=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,je=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Ze=/u\s*r\s*l\s*\(.*/gi;function Ye(e){return e.replace(Dt,"&quot;")}function Ke(e){return e.replace(zt,'"')}function et(e){return e.replace(qt,function(i,s){return s[0]==="x"||s[0]==="X"?String.fromCharCode(parseInt(s.substr(1),16)):String.fromCharCode(parseInt(s,10))})}function tt(e){return e.replace(Jt,":").replace(Wt," ")}function it(e){for(var t="",i=0,s=e.length;i<s;i++)t+=e.charCodeAt(i)<32?" ":e.charAt(i);return ae.trim(t)}function st(e){return e=Ke(e),e=et(e),e=tt(e),e=it(e),e}function nt(e){return e=Ye(e),e=Xe(e),e}function Xt(){return""}function jt(e,t){typeof t!="function"&&(t=function(){});var i=!Array.isArray(e);function s(l){return i?!0:ae.indexOf(e,l)!==-1}var n=[],a=!1;return{onIgnoreTag:function(l,o,c){if(s(l))if(c.isClosing){var u="[/removed]",h=c.position+u.length;return n.push([a!==!1?a:c.position,h]),a=!1,u}else return a||(a=c.position),"[removed]";else return t(l,o,c)},remove:function(l){var o="",c=0;return ae.forEach(n,function(u){o+=l.slice(c,u[0]),c=u[1]}),o+=l.slice(c),o}}}function Zt(e){return e.replace(Yt,"")}var Yt=/<!--[\s\S]*?-->/g;function Kt(e){var t=e.split("");return t=t.filter(function(i){var s=i.charCodeAt(0);return s===127?!1:s<=31?s===10||s===13:!0}),t.join("")}p.whiteList=Je();p.getDefaultWhiteList=Je;p.onTag=Ut;p.onIgnoreTag=Pt;p.onTagAttr=Gt;p.onIgnoreTagAttr=Mt;p.safeAttrValue=yt;p.escapeHtml=Xe;p.escapeQuote=Ye;p.unescapeQuote=Ke;p.escapeHtmlEntities=et;p.escapeDangerHtml5Entities=tt;p.clearNonPrintableCharacter=it;p.friendlyAttrValue=st;p.escapeAttrValue=nt;p.onIgnoreTagStripAll=Xt;p.StripTagBody=jt;p.stripCommentTag=Zt;p.stripBlankChar=Kt;p.cssFilter=We;p.getDefaultCSSWhiteList=Nt});var Ee=O(ve=>{var F=re();function ei(e){var t=F.spaceIndex(e);if(t===-1)var i=e.slice(1,-1);else var i=e.slice(1,t+1);return i=F.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function ti(e){return e.slice(0,2)==="</"}function ii(e,t,i){var s="",n=0,a=!1,l=!1,o=0,c=e.length,u="",h="";for(o=0;o<c;o++){var f=e.charAt(o);if(a===!1){if(f==="<"){a=o;continue}}else if(l===!1){if(f==="<"){s+=i(e.slice(n,o)),a=o,n=o;continue}if(f===">"){s+=i(e.slice(n,a)),h=e.slice(a,o+1),u=ei(h),s+=t(a,s.length,u,h,ti(h)),n=o+1,a=!1;continue}if((f==='"'||f==="'")&&e.charAt(o-1)==="="){l=f;continue}}else if(f===l){l=!1;continue}}return n<e.length&&(s+=i(e.substr(n))),s}var si=/[^a-zA-Z0-9_:\.\-]/gim;function ni(e,t){var i=0,s=[],n=!1,a=e.length;function l(f,x){if(f=F.trim(f),f=f.replace(si,"").toLowerCase(),!(f.length<1)){var b=t(f,x||"");b&&s.push(b)}}for(var o=0;o<a;o++){var c=e.charAt(o),u,h;if(n===!1&&c==="="){n=e.slice(i,o),i=o+1;continue}if(n!==!1&&o===i&&(c==='"'||c==="'")&&e.charAt(o-1)==="="){if(h=e.indexOf(c,o+1),h===-1)break;u=F.trim(e.slice(i+1,h)),l(n,u),n=!1,o=h,i=o+1;continue}if(/\s|\n|\t/.test(c))if(e=e.replace(/\s|\n|\t/g," "),n===!1)if(h=ri(e,o),h===-1){u=F.trim(e.slice(i,o)),l(u),n=!1,i=o+1;continue}else{o=h-1;continue}else if(h=ai(e,o-1),h===-1){u=F.trim(e.slice(i,o)),u=rt(u),l(n,u),n=!1,i=o+1;continue}else continue}return i<e.length&&(n===!1?l(e.slice(i)):l(n,rt(F.trim(e.slice(i))))),F.trim(s.join(" "))}function ri(e,t){for(;t<e.length;t++){var i=e[t];if(i!==" ")return i==="="?t:-1}}function ai(e,t){for(;t>0;t--){var i=e[t];if(i!==" ")return i==="="?t:-1}}function oi(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function rt(e){return oi(e)?e.substr(1,e.length-2):e}ve.parseTag=ii;ve.parseAttr=ni});var ut=O((Di,lt)=>{var li=ne().FilterCSS,A=be(),at=Ee(),ui=at.parseTag,ci=at.parseAttr,le=re();function ue(e){return e==null}function hi(e){var t=le.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=le.trim(e.slice(t+1,-1));var i=e[e.length-1]==="/";return i&&(e=le.trim(e.slice(0,-1))),{html:e,closing:i}}function di(e){var t={};for(var i in e)t[i]=e[i];return t}function ot(e){e=di(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=A.onIgnoreTagStripAll),e.whiteList=e.whiteList||A.whiteList,e.onTag=e.onTag||A.onTag,e.onTagAttr=e.onTagAttr||A.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||A.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||A.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||A.safeAttrValue,e.escapeHtml=e.escapeHtml||A.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new li(e.css))}ot.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,i=t.options,s=i.whiteList,n=i.onTag,a=i.onIgnoreTag,l=i.onTagAttr,o=i.onIgnoreTagAttr,c=i.safeAttrValue,u=i.escapeHtml,h=t.cssFilter;i.stripBlankChar&&(e=A.stripBlankChar(e)),i.allowCommentTag||(e=A.stripCommentTag(e));var f=!1;if(i.stripIgnoreTagBody){var f=A.StripTagBody(i.stripIgnoreTagBody,a);a=f.onIgnoreTag}var x=ui(e,function(b,I,$,v,Ct){var Y={sourcePosition:b,position:I,isClosing:Ct,isWhite:s.hasOwnProperty($)},D=n($,v,Y);if(!ue(D))return D;if(Y.isWhite){if(Y.isClosing)return"</"+$+">";var ke=hi(v),Tt=s[$],Re=ci(ke.html,function(G,M){var he=le.indexOf(Tt,G)!==-1,z=l($,G,M,he);if(!ue(z))return z;if(he)return M=c($,G,M,h),M?G+'="'+M+'"':G;var z=o($,G,M,he);return ue(z)?void 0:z}),v="<"+$;return Re&&(v+=" "+Re),ke.closing&&(v+=" /"),v+=">",v}else{var D=a($,v,Y);return ue(D)?u(v):D}},u);return f&&(x=f.remove(x)),x};lt.exports=ot});var ft=O((X,ce)=>{var ct=be(),ht=Ee(),dt=ut();function fi(e,t){var i=new dt(t);return i.process(e)}X=ce.exports=fi;X.FilterXSS=dt;for(N in ct)X[N]=ct[N];var N;for(N in ht)X[N]=ht[N];var N;typeof window!="undefined"&&(window.filterXSS=ce.exports);function gi(){return typeof self!="undefined"&&typeof DedicatedWorkerGlobalScope!="undefined"&&self instanceof DedicatedWorkerGlobalScope}gi()&&(self.filterXSS=ce.exports)});var J=class{constructor(t,i){this.informationType=t;this.param=i}};var y;(function(i){i[i.AUTH_CORS_ERROR=0]="AUTH_CORS_ERROR",i[i.DEGRADED_RESOURCE=1]="DEGRADED_RESOURCE"})(y||(y={}));var te=class{};te.FORBIDDEN="forbiddenResourceMessage";var S=de(_e()),At=C(),g=class{static loadExternalResources(t,i){return new Promise(s=>{ee.loadExternalResourcesAuth09(t,i,g.clickThrough,g.restricted,g.login,g.getAccessToken,g.storeAccessToken,g.getStoredAccessToken,g.handleExternalResourceResponse).then(n=>{s(n)}).catch(n=>{switch(n.name){case _.AUTHORIZATION_FAILED.toString():g.publish(r.LOGIN_FAILED);break;case _.FORBIDDEN.toString():g.publish(r.FORBIDDEN);break;case _.RESTRICTED.toString():break;default:g.publish(r.SHOW_MESSAGE,[n.message||n])}})})}static clickThrough(t){return new Promise(i=>{g.publish(r.SHOW_CLICKTHROUGH_DIALOGUE,[{resource:t,acceptCallback:()=>{if(t.clickThroughService){let s=window.open(t.clickThroughService.id),n=window.setInterval(()=>{s&&s.closed&&(window.clearInterval(n),g.publish(r.CLICKTHROUGH),i())},500)}}}])})}static restricted(t){return new Promise((i,s)=>{g.publish(r.SHOW_RESTRICTED_DIALOGUE,[{resource:t,acceptCallback:()=>{g.publish(r.LOAD_FAILED),s(t)}}])})}static login(t){return new Promise(i=>{let s={};t.status===S.FORBIDDEN&&(s.warningMessage=te.FORBIDDEN,s.showCancelButton=!0),g.publish(r.SHOW_LOGIN_DIALOGUE,[{resource:t,loginCallback:()=>{if(t.loginService){let n=window.open(t.loginService.id+"?t="+new Date().getTime()),a=window.setInterval(function(){n&&n.closed&&(window.clearInterval(a),g.publish(r.LOGIN),i())},500)}},logoutCallback:()=>{if(t.logoutService){let n=window.open(t.logoutService.id+"?t="+new Date().getTime()),a=window.setInterval(function(){n&&n.closed&&(window.clearInterval(a),g.publish(r.LOGOUT),i())},500)}},options:s}])})}static getAccessToken(t,i){return new Promise((s,n)=>{if(t.tokenService){let a=t.tokenService.id,l=a+"|"+new Date().getTime(),o=u=>{window.removeEventListener("message",o);let h=u.data;h.error?n(i?h.errorDescription:void 0):s(h)};window.addEventListener("message",o,!1);let c=a+"?messageId="+l;At("#commsFrame").prop("src",c)}else n("Token service not found")})}static storeAccessToken(t,i,s){return new Promise((n,a)=>{t.tokenService?(T.set(t.tokenService.id,i,i.expiresIn,s),n()):a("Token service not found")})}static getStoredAccessToken(t,i){return new Promise((s,n)=>{let a=[],l=null;if(t.tokenService&&(l=T.get(t.tokenService.id,i)),l)a.push(l);else{let c=B.getUrlParts(t.dataUri).hostname,u=T.getItems(i);for(let h=0;h<u.length;h++)l=u[h],l.key.includes(c)&&a.push(l)}a=a.sort((c,u)=>c.expiresAt-u.expiresAt);let o;a.length&&(o=a[a.length-1].value,s(o))})}static handleExternalResourceResponse(t){return new Promise((i,s)=>{if(t.isResponseHandled=!0,t.status===S.OK)i(t);else if(t.status===S.MOVED_TEMPORARILY)i(t),g.publish(r.RESOURCE_DEGRADED,[t]);else if(t.error.status===S.UNAUTHORIZED||t.error.status===S.INTERNAL_SERVER_ERROR)s(t.error.statusText);else if(t.error.status===S.FORBIDDEN){let n=new Error;n.message="Forbidden",n.name=_.FORBIDDEN.toString(),s(n)}else s(t.error.statusText)})}static handleDegraded(t){let i=new J(y.DEGRADED_RESOURCE,t);g.publish(r.SHOW_INFORMATION,[i])}};var pi=ft(),L=e=>pi(e,{whiteList:{a:["href","title","target","class"],b:[],br:[],i:[],img:["src","alt"],p:[],small:[],span:[],strong:[],sub:[],sup:[]}});var zi=(e,t)=>{let i;return function(...s){let n=this;clearTimeout(i),i=setTimeout(()=>e.apply(n,s),t)}};function mi(e){return new Promise(t=>{let i=document.createElement("script");i.src=e,i.onload=()=>t(),document.head.appendChild(i)})}function bi(e){return new Promise(t=>{let i=document.createElement("link");i.rel="stylesheet",i.href=e,i.onload=()=>t(),document.head.appendChild(i)})}var qi=async e=>{await Promise.all(e.map(async t=>{await mi(t)}))},Ji=async e=>{await Promise.all(e.map(async t=>{await bi(t)}))},k=e=>e.is(":visible");var gt=de(_e()),vi=C(),d=class{static loadExternalResources(t,i,s){return new Promise(n=>{d.storageStrategy=i,t=t.map(a=>(a.authAPIVersion=1,a.options=s,a)),ee.loadExternalResourcesAuth1(t,d.openContentProviderInteraction,d.openTokenService,d.getStoredAccessToken,d.userInteractedWithContentProvider,d.getContentProviderInteraction,d.handleMovedTemporarily,d.showOutOfOptionsMessages).then(a=>{n(a)}).catch(a=>{switch(a.name){case _.AUTHORIZATION_FAILED.toString():d.publish(r.LOGIN_FAILED);break;case _.FORBIDDEN.toString():d.publish(r.FORBIDDEN);break;case _.RESTRICTED.toString():break;default:d.publish(r.SHOW_MESSAGE,[a.message||a])}})})}static getCookieServiceUrl(t){return t.id+"?origin="+d.getOrigin()}static openContentProviderInteraction(t){let i=d.getCookieServiceUrl(t);return window.open(i)}static getOrigin(t){let i=window.location;return t&&(i=document.createElement("a"),i.href=t),i.protocol+"//"+i.hostname+(i.port?":"+i.port:"")}static userInteractedWithContentProvider(t){return new Promise(i=>{let s=window.setInterval(()=>{t.closed&&(window.clearInterval(s),i(!0))},500)})}static handleMovedTemporarily(t){return new Promise(i=>{d.showDegradedMessage(t),t.isResponseHandled=!0,i()})}static showDegradedMessage(t){let i=new J(y.DEGRADED_RESOURCE,t);d.publish(r.SHOW_INFORMATION,[i])}static storeAccessToken(t,i){return new Promise((s,n)=>{t.tokenService?(T.set(t.tokenService.id,i,i.expiresIn,d.storageStrategy),s()):n("Token service not found")})}static getStoredAccessToken(t){return new Promise((i,s)=>{let n=[],a=null;if(t.tokenService&&(a=T.get(t.tokenService.id,d.storageStrategy)),a)n.push(a);else{let o=B.getUrlParts(t.dataUri).hostname,c=T.getItems(d.storageStrategy);for(let u=0;u<c.length;u++)a=c[u],a.key.includes(o)&&n.push(a)}n=n.sort((o,c)=>o.expiresAt-c.expiresAt);let l=null;n.length&&(l=n[n.length-1].value),i(l)})}static getContentProviderInteraction(t,i){return new Promise(s=>{t.isResponseHandled&&!t.authHoldingPage?(d.showDegradedMessage(t),s(null)):t.authHoldingPage?(t.authHoldingPage.location.href=d.getCookieServiceUrl(i),s(t.authHoldingPage)):d.publish(r.SHOW_AUTH_DIALOGUE,[{service:i,closeCallback:()=>{s(null)},confirmCallback:()=>{let n=d.openContentProviderInteraction(i);s(n)},cancelCallback:()=>{s(null)}}])})}static openTokenService(t,i){return new Promise((s,n)=>{let a=d.getOrigin(i.id),l=new Date().getTime();d.messages[l]={resolve:s,reject:n,serviceOrigin:a,resource:t},window.addEventListener("message",d.receiveToken,!1);let o=i.id+"?messageId="+l+"&origin="+d.getOrigin();vi("#commsFrame").prop("src",o);let c=5e3;setTimeout(()=>{d.messages[l]&&(d.messages[l].reject("Message unhandled after "+c+"ms, rejecting"),delete d.messages[l])},c)})}static receiveToken(t){if(t.data.hasOwnProperty("messageId")){let i=d.messages[t.data.messageId];i&&t.origin==i.serviceOrigin&&d.storeAccessToken(i.resource,t.data).then(()=>{i.resolve(t.data),delete d.messages[t.data.messageId]})}}static showOutOfOptionsMessages(t,i){if(t.status==gt.MOVED_TEMPORARILY)return;let s="";i.getFailureHeader()&&(s+="<p>"+i.getFailureHeader()+"</p>"),i.getFailureDescription()&&(s+=i.getFailureDescription()),d.publish(r.SHOW_MESSAGE,[L(s)])}},j=d;j.messages={};var xe=class{constructor(t,i,s){this.isResized=!1;this.$element=t,this.fitToParentWidth=i||!1,this.fitToParentHeight=s||!1,this.create()}create(){this.extensionHost.subscribe(r.RESIZE,()=>{this.resize()})}whenResized(t){Oe.waitFor(()=>this.isResized,t)}onAccessibleClick(t,i,s=!0){s&&t.on("click",n=>{i(n)}),t.on("keyup",n=>{n.keyCode===32&&i(n)})}resize(){let t=this.$element.parent();this.fitToParentWidth&&this.$element.width(t.width()),this.fitToParentHeight&&this.$element.height(t.height()),this.isResized=!0}};var Ei=C(),U=class extends xe{constructor(t,i,s){super(t,i,s)}create(){this.extensionHost=this.$element.closest(".uv-extension-host").data("component"),super.create(),this.extension=this.extensionHost.extension,this.config={},this.config.content={},this.config.options={};var t=this;t.modules&&t.modules.length&&(t.modules=t.modules.reverse(),t.modules.forEach(i=>{t.config=Ei.extend(!0,t.config,t.extension.data.config.modules[i])})),this.content=this.config.content,this.options=this.config.options}init(){}setConfig(t){this.modules||(this.modules=[]),this.modules.push(t)}resize(){super.resize()}};var P=C(),R=class extends U{constructor(t){super(t,!1,!1);this.allowClose=!0;this.isActive=!1;this.isUnopened=!0}create(){this.setConfig("dialogue"),super.create(),this.extensionHost.subscribe(r.CLOSE_ACTIVE_DIALOGUE,()=>{this.isActive&&this.allowClose&&this.close()}),this.extensionHost.subscribe(r.ESCAPE,()=>{this.isActive&&this.allowClose&&this.close()}),this.$top=P('<div class="top"></div>'),this.$element.append(this.$top),this.$closeButton=P('<button type="button" class="btn btn-default close" tabindex="0">'+this.content.close+"</button>"),this.$middle=P('<div class="middle"></div>'),this.$element.append(this.$middle),this.$content=P('<div class="content"></div>'),this.$middle.append(this.$content),this.$buttons=P('<div class="buttons"></div>'),this.$middle.append(this.$buttons),this.$bottom=P('<div class="bottom"></div>'),this.$element.append(this.$bottom),this.config.topCloseButtonEnabled?this.$top.append(this.$closeButton):this.$buttons.append(this.$closeButton),this.$closeButton.on("click",t=>{t.preventDefault(),this.close()}),this.returnFunc=this.close}enableClose(){this.allowClose=!0,this.$closeButton.show()}disableClose(){this.allowClose=!1,this.$closeButton.hide()}setDockedPosition(){let t=Math.floor(this.extension.height()-this.$element.outerHeight(!0)),i=0,s=0,n=0;if(this.$triggerButton){let a=4,l=2,o=this.$triggerButton.offset().top,c=this.extension.$element.offset().top,u=this.$element.outerHeight(!0);t=o-c-u+a;let f=this.$triggerButton.offset().left,x=this.extension.$element.offset().left,b=f-x;n=He.normalise(b,0,this.extension.width()),i=Math.floor(this.extension.width()*n-this.$element.width()*n)+l,s=Math.floor(this.$element.width()*n)}this.$bottom.css("backgroundPosition",s+"px 0px"),this.$element.css({top:t,left:i})}open(t){this.$element.attr("aria-hidden","false"),this.$element.show(),t?(this.$triggerButton=P(t),this.$bottom.show()):this.$bottom.hide(),this.isActive=!0,setTimeout(()=>{let i=this.$element.find(".default");if(i.length)i.focus();else{let s=this.$element.find("input:visible").first();s.length?s.focus():this.$closeButton.focus()}},1),this.extensionHost.publish(r.SHOW_OVERLAY),this.isUnopened&&(this.isUnopened=!1,this.afterFirstOpen()),this.resize()}afterFirstOpen(){}close(){!this.isActive||(this.$element.attr("aria-hidden","true"),this.$element.hide(),this.isActive=!1,this.extensionHost.publish(this.closeCommand),this.extensionHost.publish(r.HIDE_OVERLAY))}resize(){super.resize(),this.$element.css({top:Math.floor(this.extension.height()/2-this.$element.height()/2),left:Math.floor(this.extension.width()/2-this.$element.width()/2)})}};var pt=C(),Ie=class extends R{constructor(t){super(t)}create(){this.setConfig("authDialogue"),super.create(),this.openCommand=r.SHOW_AUTH_DIALOGUE,this.closeCommand=r.HIDE_AUTH_DIALOGUE,this.extensionHost.subscribe(this.openCommand,t=>{this.closeCallback=t.closeCallback,this.confirmCallback=t.confirmCallback,this.cancelCallback=t.cancelCallback,this.service=t.service,this.open()}),this.extensionHost.subscribe(this.closeCommand,()=>{this.close()}),this.$title=pt('<div role="heading" class="heading"></div>'),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>            </div>'),this.$buttons.prepend(this._buttonsToAdd()),this.$message=this.$content.find(".message"),this.$confirmButton=this.$buttons.find(".confirm"),this.$confirmButton.text(this.content.confirm),this.$cancelButton=this.$buttons.find(".close"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$confirmButton.on("click",t=>{t.preventDefault(),this.confirmCallback&&this.confirmCallback(),this.close()}),this.$cancelButton.on("click",t=>{t.preventDefault(),this.cancelCallback&&this.cancelCallback(),this.close()})}open(){super.open();let t=this.service.getHeader(),i=this.service.getDescription(),s=this.service.getConfirmLabel();t&&this.$title.text(L(t)),i&&(this.$message.html(L(i)),this.$message.targetBlank(),this.$message.find("a").on("click",function(){let n=pt(this).attr("href");this.extensionHost.publish(r.EXTERNAL_LINK_CLICKED,n)})),s&&this.$confirmButton.text(L(s)),this.resize()}resize(){super.resize()}_buttonsToAdd(){var t='<a class="confirm btn btn-primary" href="#" target="_parent"></a>';return this.config.topCloseButtonEnabled&&(t+='<button class="close btn btn-default"></button>'),t}};var mt=C(),$e=class extends R{constructor(t){super(t)}create(){this.setConfig("clickThroughDialogue"),super.create(),this.openCommand=r.SHOW_CLICKTHROUGH_DIALOGUE,this.closeCommand=r.HIDE_CLICKTHROUGH_DIALOGUE,this.extensionHost.subscribe(this.openCommand,t=>{this.acceptCallback=t.acceptCallback,this.resource=t.resource,this.open()}),this.extensionHost.subscribe(this.closeCommand,()=>{this.close()}),this.$title=mt('<div role="heading" class="heading"></div>'),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="acceptTerms btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$acceptTermsButton=this.$content.find(".acceptTerms"),this.$acceptTermsButton.text("Accept Terms and Open"),this.$element.hide(),this.$acceptTermsButton.on("click",t=>{t.preventDefault(),this.close(),this.extensionHost.publish(r.ACCEPT_TERMS),this.acceptCallback&&this.acceptCallback()})}open(){super.open(),this.resource.clickThroughService&&(this.$title.text(this.resource.clickThroughService.getProperty("label")),this.$message.html(this.resource.clickThroughService.getProperty("description")),this.$message.targetBlank()),this.$message.find("a").on("click",function(){var t=mt(this).attr("href");this.extensionHost.publish(r.EXTERNAL_LINK_CLICKED,t)}),this.resize()}resize(){super.resize()}};var bt=C(),Ce=class extends R{constructor(t){super(t)}create(){this.setConfig("loginDialogue"),super.create(),this.openCommand=r.SHOW_LOGIN_DIALOGUE,this.closeCommand=r.HIDE_LOGIN_DIALOGUE,this.extensionHost.subscribe(this.openCommand,t=>{this.loginCallback=t.loginCallback,this.logoutCallback=t.logoutCallback,this.options=t.options,this.resource=t.resource,this.open()}),this.extensionHost.subscribe(this.closeCommand,()=>{this.close()}),this.$title=bt('<div role="heading" class="heading"></div>'),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="logout btn btn-primary" href="#" target="_parent"></a>                    <a class="login btn btn-primary" href="#" target="_parent"></a>                    <a class="cancel btn btn-primary" href="#"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$loginButton=this.$content.find(".login"),this.$loginButton.text(this.content.login),this.$logoutButton=this.$content.find(".logout"),this.$logoutButton.text(this.content.logout),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$loginButton.on("click",t=>{t.preventDefault(),this.close(),this.loginCallback&&this.loginCallback()}),this.$logoutButton.on("click",t=>{t.preventDefault(),this.close(),this.logoutCallback&&this.logoutCallback()}),this.$cancelButton.on("click",t=>{t.preventDefault(),this.close()}),this.updateLogoutButton()}open(){super.open();let t="";this.resource.loginService&&(this.$title.text(this.resource.loginService.getProperty("label")),t=this.resource.loginService.getProperty("description")),this.options.warningMessage&&(t='<span class="warning">'+this.extension.data.config.content[this.options.warningMessage]+'</span><span class="description">'+t+"</span>"),this.updateLogoutButton(),this.$message.html(t),this.$message.targetBlank(),this.$message.find("a").on("click",function(){var i=bt(this).attr("href");this.extensionHost.publish(r.EXTERNAL_LINK_CLICKED,i)}),this.options.showCancelButton?this.$cancelButton.show():this.$cancelButton.hide(),this.resize()}updateLogoutButton(){this.extension.isLoggedIn?this.$logoutButton.show():this.$logoutButton.hide()}resize(){super.resize()}};var vt=C(),Te=class extends R{constructor(t){super(t)}create(){this.setConfig("restrictedDialogue"),super.create(),this.openCommand=r.SHOW_RESTRICTED_DIALOGUE,this.closeCommand=r.HIDE_RESTRICTED_DIALOGUE,this.extensionHost.subscribe(this.openCommand,t=>{this.acceptCallback=t.acceptCallback,this.options=t.options,this.resource=t.resource,this.open()}),this.extensionHost.subscribe(this.closeCommand,()=>{this.close()}),this.$title=vt('<div role="heading" class="heading"></div>'),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="cancel btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$message.targetBlank(),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$cancelButton.on("click",t=>{t.preventDefault(),this.close()})}open(){super.open(),this.isAccepted=!1;let t="";this.resource.restrictedService&&(this.$title.text(this.resource.restrictedService.getProperty("label")),t=this.resource.restrictedService.getProperty("description")),this.$message.html(t),this.$message.targetBlank(),this.$message.find("a").on("click",function(){var i=vt(this).attr("href");this.extensionHost.publish(r.EXTERNAL_LINK_CLICKED,i)}),this.resize()}close(){super.close(),!this.isAccepted&&this.acceptCallback&&(this.isAccepted=!0,this.acceptCallback())}resize(){super.resize()}};var Et=C(),Se=class extends R{constructor(t){super(t)}create(){this.setConfig("genericDialogue"),super.create(),this.openCommand=r.SHOW_GENERIC_DIALOGUE,this.closeCommand=r.HIDE_GENERIC_DIALOGUE,this.extensionHost.subscribe(this.openCommand,t=>{this.acceptCallback=t.acceptCallback,this.showMessage(t)}),this.extensionHost.subscribe(this.closeCommand,()=>{this.close()}),this.$message=Et("<p></p>"),this.$content.append(this.$message),this.$acceptButton=Et(`
          <button class="btn btn-primary accept default">
            ${this.content.ok}
          </button>
        `),this.$buttons.append(this.$acceptButton),this.$buttons.find(".close").hide(),this.$acceptButton.onPressed(()=>{this.accept()}),this.returnFunc=()=>{this.isActive&&this.accept()},this.$element.hide()}accept(){this.extensionHost.publish(r.CLOSE_ACTIVE_DIALOGUE),this.acceptCallback&&this.acceptCallback()}showMessage(t){this.$message.html(t.message),t.buttonText?this.$acceptButton.text(t.buttonText):this.$acceptButton.text(this.content.ok),t.allowClose===!1&&this.disableClose(),this.open()}resize(){super.resize()}};var H=C(),Ae=class extends U{constructor(t){super(t,!0,!0)}create(){super.create(),this.extensionHost.subscribe(r.SHOW_OVERLAY,()=>{this.$overlays.show()}),this.extensionHost.subscribe(r.HIDE_OVERLAY,()=>{this.$overlays.hide()}),this.$element.append('<a class="sr-only" href="#download-btn">'+this.extension.data.config.content.skipToDownload+"</a>"),this.$headerPanel=H('<div class="headerPanel"></div>'),this.$element.append(this.$headerPanel),this.$mainPanel=H('<div class="mainPanel"></div>'),this.$element.append(this.$mainPanel),this.$centerPanel=H('<div class="centerPanel"></div>'),this.$centerPanel.append('<h2 class="sr-only">'+this.extension.data.config.content.mediaViewer+"</h2>"),this.$mainPanel.append(this.$centerPanel),this.$leftPanel=H('<div class="leftPanel"></div>'),this.$mainPanel.append(this.$leftPanel),this.$rightPanel=H('<div class="rightPanel"></div>'),this.$mainPanel.append(this.$rightPanel),this.$footerPanel=H('<div class="footerPanel"></div>'),this.$element.append(this.$footerPanel),this.$mobileFooterPanel=H('<div class="mobileFooterPanel"></div>'),this.$element.append(this.$mobileFooterPanel),this.$overlays=H('<div class="overlays"></div>'),this.$element.append(this.$overlays),this.$overlays.hide(),this.$genericDialogue=H('<div class="overlay genericDialogue" aria-hidden="true"></div>'),this.$overlays.append(this.$genericDialogue),this.$overlays.on("click",t=>{H(t.target).hasClass("overlays")&&(t.preventDefault(),this.extensionHost.publish(r.CLOSE_ACTIVE_DIALOGUE))}),new Se(this.$genericDialogue)}resize(){super.resize(),setTimeout(()=>{this.$overlays.width(this.extension.width()),this.$overlays.height(this.extension.height())},1);let t=this.$element.height()-parseInt(this.$mainPanel.css("paddingTop"))-(k(this.$headerPanel)?this.$headerPanel.height():0)-(k(this.$footerPanel)?this.$footerPanel.height():0)-(k(this.$mobileFooterPanel)?this.$mobileFooterPanel.height():0);this.$mainPanel.height(t)}};var It=de(St());var m;(function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Spacebar=32]="Spacebar",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.PrintScrn=44]="PrintScrn",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Zero=48]="Zero",e[e.One=49]="One",e[e.Two=50]="Two",e[e.Three=51]="Three",e[e.Four=52]="Four",e[e.Five=53]="Five",e[e.Six=54]="Six",e[e.Seven=55]="Seven",e[e.Eight=56]="Eight",e[e.Nine=57]="Nine",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.Numpad0=96]="Numpad0",e[e.Numpad1=97]="Numpad1",e[e.Numpad2=98]="Numpad2",e[e.Numpad3=99]="Numpad3",e[e.Numpad4=100]="Numpad4",e[e.Numpad5=101]="Numpad5",e[e.Numpad6=102]="Numpad6",e[e.Numpad7=103]="Numpad7",e[e.Numpad8=104]="Numpad8",e[e.Numpad9=105]="Numpad9",e[e.Multiply=106]="Multiply",e[e.NumpadPlus=107]="NumpadPlus",e[e.NumpadMinus=109]="NumpadMinus",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.Semicolon=186]="Semicolon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.LessThan=188]="LessThan",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.GreaterThan=190]="GreaterThan",e[e.ForwardSlash=191]="ForwardSlash",e[e.QuestionMark=191]="QuestionMark",e[e.GraveAccent=192]="GraveAccent",e[e.Tilde=192]="Tilde",e[e.OpenCurlyBracket=219]="OpenCurlyBracket",e[e.OpenSquareBracket=219]="OpenSquareBracket",e[e.BackSlash=220]="BackSlash",e[e.VerticalPipe=220]="VerticalPipe",e[e.CloseCurlyBracket=221]="CloseCurlyBracket",e[e.CloseSquareBracket=221]="CloseSquareBracket",e[e.Quote=222]="Quote",e[e.CommandFF=224]="CommandFF"})(m||(m={}));var xt;(function(e){e[e.Backspace=8]="Backspace",e[e.Enter=13]="Enter",e[e.Spacebar=32]="Spacebar",e[e.Hash=35]="Hash",e[e.GraveAccent=39]="GraveAccent",e[e.DoubleQuote=34]="DoubleQuote",e[e.Asterisk=42]="Asterisk",e[e.Plus=43]="Plus",e[e.Comma=44]="Comma",e[e.Minus=45]="Minus",e[e.Period=46]="Period",e[e.ForwardSlash=47]="ForwardSlash",e[e.Zero=48]="Zero",e[e.One=49]="One",e[e.Two=50]="Two",e[e.Three=51]="Three",e[e.Four=52]="Four",e[e.Five=53]="Five",e[e.Six=54]="Six",e[e.Seven=55]="Seven",e[e.Eight=56]="Eight",e[e.Nine=57]="Nine",e[e.Colon=58]="Colon",e[e.Semicolon=59]="Semicolon",e[e.LessThan=60]="LessThan",e[e.Equals=61]="Equals",e[e.GreaterThan=62]="GreaterThan",e[e.QuestionMark=63]="QuestionMark",e[e.At=64]="At",e[e.OpenSquareBracket=91]="OpenSquareBracket",e[e.BackSlash=92]="BackSlash",e[e.CloseSquareBracket=93]="CloseSquareBracket",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.OpenCurlyBracket=123]="OpenCurlyBracket",e[e.VerticalPipe=124]="VerticalPipe",e[e.CloseCurlyBracket=125]="CloseCurlyBracket",e[e.Tilde=126]="Tilde"})(xt||(xt={}));var w=C(),xi=class{constructor(){this.isCreated=!1;this.isLoggedIn=!1;this.metrics=[];this.shifted=!1;this.tabbing=!1;this.locales={}}create(){let t=this;if(this.browserDetect=new $t,this.browserDetect.init(),g.publish=this.extensionHost.publish.bind(this.extensionHost),j.publish=this.extensionHost.publish.bind(this.extensionHost),this.$element=w(this.extensionHost.options.target),this.$element.data("component",this.extensionHost),this.fire(r.CREATE,{data:this.data,settings:this.getSettings(),preview:this.getSharePreview()}),this._parseMetrics(),this._initLocales(),console.log("add classes"),this.$element.empty(),this.$element.removeClass(),this.$element.addClass("uv-extension-host"),this.$element.addClass("loading"),this.data.locales&&this.$element.addClass(this.data.locales[0].name.toLowerCase()),this.$element.addClass(this.type.name),this.$element.addClass("browser-"+this.browserDetect.browser),this.$element.addClass("browser-version-"+this.browserDetect.version),this.$element.prop("tabindex",-1),this.data.embedded&&this.$element.addClass("embedded"),this.isMobile()&&this.$element.addClass("mobile"),q.supportsFullscreen()&&this.$element.addClass("fullscreen-supported"),this.isFullScreen()&&this.$element.addClass("fullscreen"),this.$element.on("mousemove",i=>{this.mouseX=i.pageX,this.mouseY=i.pageY}),!this.data.isReload){let i=q.getHiddenProp();if(i){let s=i.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(s,()=>{q.isHidden()||this.resize()})}E.getBool(this.data.config.options.dropEnabled,!0)&&this.$element.on("drop",s=>{s.preventDefault();let n=s.originalEvent.dataTransfer.getData("URL"),a=B.getUrlParts(n),l=B.getQuerystringParameterFromString("manifest",a.search);if(l||(l=B.getQuerystringParameterFromString("collection",a.search)),l){this.fire(r.DROP,l);let o={};o.manifest=l,this.reload(o)}}),this.$element.on("dragover",s=>{s.preventDefault()}),this.$element.on("keyup keydown",s=>{this.shifted=s.shiftKey,this.tabbing=s.keyCode===m.Tab}),this.$element.on("keydown",s=>{let n=null,a=!0;!s.ctrlKey&&!s.altKey&&!s.shiftKey&&(s.keyCode===m.Enter&&(n=r.RETURN,a=!1),s.keyCode===m.Escape&&(n=r.ESCAPE),s.keyCode===m.PageUp&&(n=r.PAGE_UP),s.keyCode===m.PageDown&&(n=r.PAGE_DOWN),s.keyCode===m.End&&(n=r.END),s.keyCode===m.Home&&(n=r.HOME),(s.keyCode===m.NumpadPlus||s.keyCode===171||s.keyCode===m.Equals)&&(n=r.PLUS,a=!1),(s.keyCode===m.NumpadMinus||s.keyCode===173||s.keyCode===m.Dash)&&(n=r.MINUS,a=!1),t.useArrowKeysToNavigate()&&(s.keyCode===m.LeftArrow&&(n=r.LEFT_ARROW),s.keyCode===m.UpArrow&&(n=r.UP_ARROW),s.keyCode===m.RightArrow&&(n=r.RIGHT_ARROW),s.keyCode===m.DownArrow&&(n=r.DOWN_ARROW))),n&&(a&&s.preventDefault(),this.extensionHost.publish(n))})}this.extensionHost.subscribe(r.EXIT_FULLSCREEN,()=>{this.isOverlayActive()&&this.extensionHost.publish(r.ESCAPE),this.extensionHost.publish(r.ESCAPE),this.extensionHost.publish(r.RESIZE)}),this.$element.append('<iframe id="commsFrame" style="display:none"></iframe>'),this.extensionHost.subscribeAll((i,s)=>{[r.LOAD,r.CREATE,r.DROP,r.TOGGLE_FULLSCREEN,r.EXTERNAL_RESOURCE_OPENED].includes(i)||this.fire(i,s)}),this.extensionHost.subscribe(r.EXTERNAL_RESOURCE_OPENED,()=>{this.fire(r.EXTERNAL_RESOURCE_OPENED)}),this.extensionHost.subscribe(r.LOGIN_FAILED,()=>{this.showMessage(this.data.config.content.authorisationFailedMessage)}),this.extensionHost.subscribe(r.LOGIN,()=>{this.isLoggedIn=!0}),this.extensionHost.subscribe(r.LOGOUT,()=>{this.isLoggedIn=!1}),this.extensionHost.subscribe(r.BOOKMARK,()=>{this.bookmark()}),this.extensionHost.subscribe(r.CANVAS_INDEX_CHANGE,i=>{this.data.canvasIndex=i,this.lastCanvasIndex=this.helper.canvasIndex,this.helper.canvasIndex=i}),this.extensionHost.subscribe(r.CLOSE_LEFT_PANEL,()=>{this.resize()}),this.extensionHost.subscribe(r.CLOSE_RIGHT_PANEL,()=>{this.resize()}),this.extensionHost.subscribe(r.COLLECTION_INDEX_CHANGE,i=>{this.data.collectionIndex=i}),this.extensionHost.subscribe(r.CREATED,()=>{this.isCreated=!0}),this.extensionHost.subscribe(r.ESCAPE,()=>{this.isFullScreen()&&!this.isOverlayActive()&&this.extensionHost.publish(r.TOGGLE_FULLSCREEN)}),this.extensionHost.subscribe(r.LOAD,()=>{setTimeout(()=>{this.extensionHost.publish(r.RESIZE),this.fire(r.LOAD,this.helper.getCurrentCanvas().id),this.$element.removeClass("loading")},100)}),this.extensionHost.subscribe(r.FEEDBACK,()=>{this.feedback()}),this.extensionHost.subscribe(r.FORBIDDEN,()=>{this.extensionHost.publish(r.OPEN_EXTERNAL_RESOURCE)}),this.extensionHost.subscribe(r.LOAD_FAILED,()=>{!t.lastCanvasIndex==null&&t.lastCanvasIndex!==t.helper.canvasIndex&&this.extensionHost.publish(r.CANVAS_INDEX_CHANGE,t.lastCanvasIndex)}),this.extensionHost.subscribe(r.MANIFEST_INDEX_CHANGE,i=>{this.data.manifestIndex=i}),this.extensionHost.subscribe(r.OPEN,()=>{let i=Be.format(this.data.config.options.openTemplate,this.helper.manifestUri);window.open(i)}),this.extensionHost.subscribe(r.OPEN_LEFT_PANEL,()=>{this.$element.hasClass("loading")||this.resize()}),this.extensionHost.subscribe(r.OPEN_RIGHT_PANEL,()=>{this.$element.hasClass("loading")||this.resize()}),this.extensionHost.subscribe(r.RANGE_CHANGE,i=>{i?(this.data.rangeId=i.id,this.helper.rangeId=i.id):(this.data.rangeId=void 0,this.helper.rangeId=void 0)}),this.extensionHost.subscribe(r.RESOURCE_DEGRADED,i=>{g.handleDegraded(i)}),this.extensionHost.subscribe(r.SHOW_MESSAGE,i=>{this.showMessage(i)}),this.extensionHost.subscribe(r.SHOW_TERMS_OF_USE,()=>{let i=this.helper.getLicense();if(!i){let s=this.helper.getRequiredStatement();s&&s.value&&(i=s.value)}i&&this.showMessage(i)}),this.extensionHost.subscribe(r.TOGGLE_FULLSCREEN,()=>{let i=this.data.config.options.overrideFullScreen;this.extensionHost.isFullScreen=!this.extensionHost.isFullScreen,i||(w("#top").focus(),this.extensionHost.isFullScreen?this.$element.addClass("fullscreen"):this.$element.removeClass("fullscreen")),this.fire(r.TOGGLE_FULLSCREEN,{isFullScreen:this.extensionHost.isFullScreen,overrideFullScreen:i})}),this.shell=new Ae(this.$element),this.createModules(),this.extensionHost.publish(r.RESIZE),setTimeout(()=>{this.render(),this.extensionHost.publish(r.CREATED),this._setDefaultFocus()},1)}async loadConfig(t){let i=this.locales[t];if(!i)throw new Error("Unable to load config");return i=JSON.parse(JSON.stringify(i)),i}createModules(){this.$authDialogue=w('<div class="overlay auth" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$authDialogue),this.authDialogue=new Ie(this.$authDialogue),this.$clickThroughDialogue=w('<div class="overlay clickthrough" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$clickThroughDialogue),this.clickThroughDialogue=new $e(this.$clickThroughDialogue),this.$restrictedDialogue=w('<div class="overlay login" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$restrictedDialogue),this.restrictedDialogue=new Te(this.$restrictedDialogue),this.$loginDialogue=w('<div class="overlay login" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$loginDialogue),this.loginDialogue=new Ce(this.$loginDialogue)}_setDefaultFocus(){setTimeout(()=>{this.data.config.options.allowStealFocus&&w("[tabindex=0]").focus()},1)}width(){return this.$element.width()}height(){return this.$element.height()}exitFullScreen(){this.extensionHost.publish(r.EXIT_FULLSCREEN)}fire(t,...i){this.data.debug&&console.log(t,arguments[1]),this.extensionHost.fire(t,arguments[1])}redirect(t){this.fire(r.REDIRECT,t)}refresh(){this.fire(r.REFRESH,null)}render(){if((!this.isCreated||this.data.collectionIndex!==this.helper.collectionIndex)&&this.extensionHost.publish(r.COLLECTION_INDEX_CHANGE,this.data.collectionIndex),(!this.isCreated||this.data.manifestIndex!==this.helper.manifestIndex)&&this.data.manifest!==void 0&&this.extensionHost.publish(r.MANIFEST_INDEX_CHANGE,this.data.manifestIndex),(!this.isCreated||this.data.canvasIndex!==this.helper.canvasIndex)&&(this.data.canvasIndex!==void 0?this.extensionHost.publish(r.CANVAS_INDEX_CHANGE,this.data.canvasIndex):console.error("canvasIndex is undefined")),(!this.isCreated||this.data.rangeId!==this.helper.rangeId)&&this.data.rangeId){let t=this.helper.getRangeById(this.data.rangeId);t?this.extensionHost.publish(r.RANGE_CHANGE,t):console.warn("range id not found:",this.data.rangeId)}}_initLocales(){let t=this.data.config.localisation.locales.slice(0),i=this.data.locales,s=[];i?(i.forEach(a=>{let l=t.filter(c=>c.name===a.name);if(l.length){var o=l[0];a.label&&(o.label=a.label),o.added=!0,s.push(o)}}),E.getBool(this.data.config.options.limitLocales,!1)||t.forEach(a=>{a.added||s.push(a),delete a.added}),this.data.locales=s):console.warn("No locales configured")}_parseMetrics(){let t=this.data.config.options.metrics;if(t)for(let i=0;i<t.length;i++){let s=t[i];this.metrics.push(s)}}_updateMetric(){setTimeout(()=>{for(let i=this.metrics.length-1;i>=0;i--){let s=this.metrics[i];if(window.innerWidth>=s.minWidth){if(this.metric!==s.type){this.metric=s.type;for(var t=0;t<this.metrics.length;t++)this.$element.removeClass(this.metrics[t].type);this.$element.addClass(s.type),this.extensionHost.publish(r.METRIC_CHANGE)}break}}},1)}resize(){this._updateMetric(),this.extensionHost.publish(r.RESIZE)}reload(t){this.extensionHost.publish(r.RELOAD,t)}isSeeAlsoEnabled(){return this.data.config.options.seeAlsoEnabled!==!1}getShareUrl(){if(this.data.embedded){if(this.helper.hasRelatedPage()){var t=this.helper.getRelated();return t&&t.length&&(t=t[0]),t["@id"]}}else return q.isInIFrame()?parent.document.location.href:document.location.href;return null}getIIIFShareUrl(t=!1){let i;return t&&(this.helper.manifest?i=this.helper.manifest.id:i=this.helper.manifestUri),`${i}?manifest=${i}`}addTimestamp(t){return t+"?t="+Le.getTimeStamp()}getDomain(){return B.getUrlParts(this.helper.manifestUri).host}getAppUri(){return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+"/uv.html"}getSettings(){if(E.getBool(this.data.config.options.saveUserSettings,!1)){let t=T.get("uv.settings",K.LOCAL);if(t)return w.extend(this.data.config.options,t.value)}return this.data.config.options}updateSettings(t){if(E.getBool(this.data.config.options.saveUserSettings,!1)){let i=T.get("uv.settings",K.LOCAL);i&&(t=w.extend(i.value,t)),T.set("uv.settings",t,31536e4,K.LOCAL)}this.data.config.options=w.extend(this.data.config.options,t)}getLocale(){return this.helper.options.locale}getSharePreview(){let t=this.helper.getLabel(),i=this.helper.getCurrentCanvas(),s=i.getProperty("thumbnail");return(!s||typeof s!="string")&&(s=i.getCanonicalImageUri(this.data.config.options.bookmarkThumbWidth)),{title:t,image:s}}getPagedIndices(t=this.helper.canvasIndex){return[t]}getCurrentCanvases(){let t=this.getPagedIndices(this.helper.canvasIndex),i=[];for(let s=0;s<t.length;s++){let n=t[s],a=this.helper.getCanvasByIndex(n);i.push(a)}return i}getCanvasLabels(t){let i=this.getPagedIndices(),s="";if(i.length===1)s=t;else for(let n=1;n<=i.length;n++)s.length&&(s+=","),s+=t+" "+n;return s}getCurrentCanvasRange(){return this.helper.getCanvasRange(this.helper.getCurrentCanvas())}getExternalResources(t){let i=this.getPagedIndices(),s=[];i.forEach(l=>{let o=this.helper.getCanvasByIndex(l),c;if(o.externalResource?c=o.externalResource:c=new Fe(o,{authApiVersion:this.data.config.options.authAPIVersion}),t){let u=t.find(h=>h.dataUri===c.dataUri);u?s.push(u):s.push(c)}else s.push(c)});let n=this.data.config.options.tokenStorage;return this.data.config.options.authAPIVersion===1?new Promise(l=>{let o={locale:this.helper.options.locale};j.loadExternalResources(s,n,o).then(c=>{this.resources=c.map(u=>this._prepareResourceData(u)),l(this.resources)})}):new Promise(l=>{g.loadExternalResources(s,n).then(o=>{this.resources=o.map(c=>this._prepareResourceData(c)),l(this.resources)})})}_prepareResourceData(t){return t.data.hasServiceDescriptor=t.hasServiceDescriptor(),t.hasServiceDescriptor()||(t.data.id=t.dataUri,t.data.width=t.width,t.data.height=t.height),t.data.index=t.index,we.toPlainObject(t.data)}getMediaFormats(t){let i=t.getContent();return i&&i.length?i[0].getBody():[{id:t.id,type:t.getType(),getFormat:function(){return""}}]}viewCanvas(t){if(this.helper.isCanvasIndexOutOfRange(t)){this.showMessage(this.data.config.content.canvasIndexOutOfRange);return}this.extensionHost.publish(r.OPEN_EXTERNAL_RESOURCE)}showMessage(t,i,s,n){this.closeActiveDialogue(),this.extensionHost.publish(r.SHOW_GENERIC_DIALOGUE,{message:t,acceptCallback:i,buttonText:s,allowClose:n})}closeActiveDialogue(){this.extensionHost.publish(r.CLOSE_ACTIVE_DIALOGUE)}isOverlayActive(){return k(this.shell.$overlays)}isDesktopMetric(){return this.metric==="lg"||this.metric==="xl"}isMobileMetric(){return this.metric==="sm"||this.metric==="md"}viewManifest(t){let i={};i.manifest=this.helper.manifestUri,i.collectionIndex=this.helper.getCollectionIndex(t),i.manifestIndex=t.index,i.canvasIndex=0,this.reload(i)}viewCollection(t){let i={};i.manifest=t.parentCollection?t.parentCollection.id:this.helper.manifestUri,i.collectionIndex=t.index,i.manifestIndex=0,i.canvasIndex=0,this.reload(i)}isFullScreen(){return this.extensionHost.isFullScreen}isHeaderPanelEnabled(){return E.getBool(this.data.config.options.headerPanelEnabled,!0)}isLeftPanelEnabled(){if(E.getBool(this.data.config.options.leftPanelEnabled,!0)){if(this.helper.hasParentCollection())return!0;if(this.helper.isMultiCanvas()){let t=this.helper.getViewingHint();if(!t||t&&t!==It.ViewingHint.CONTINUOUS)return!0}}return!1}isRightPanelEnabled(){return E.getBool(this.data.config.options.rightPanelEnabled,!0)}isFooterPanelEnabled(){return E.getBool(this.data.config.options.footerPanelEnabled,!0)}isMobile(){let t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|android|ipad|playbook|silk|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}useArrowKeysToNavigate(){return E.getBool(this.data.config.options.useArrowKeysToNavigate,!0)}bookmark(){}feedback(){this.fire(r.FEEDBACK,this.data)}getAlternateLocale(){let t=null;return this.data.locales&&this.data.locales.length>1&&(t=this.data.locales[1]),t}getSerializedLocales(){return this.data.locales?this.serializeLocales(this.data.locales):null}serializeLocales(t){let i="";for(let s=0;s<t.length;s++){let n=t[s];s>0&&(i+=","),i+=n.name,n.label&&(i+=":"+n.label)}return i}changeLocale(t){let i={};if(this.data.locales){i.locales=this.data.locales.slice(0);let s=i.locales.findIndex(a=>a.name===t),n=0;i.locales.splice(n,0,i.locales.splice(s,1)[0]),this.reload(i)}}},$t=class{constructor(){this.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Safari",identity:"Safari"},{string:navigator.userAgent,subString:"Opera",identity:"Opera"}]}init(){this.browser=this.searchString(this.dataBrowser)||"Other",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"Unknown",this.browser=="Explorer"&&this.version=="7"&&navigator.userAgent.match(/Trident/i)&&(this.version=this.searchVersionIE())}searchString(t){for(var i=0;i<t.length;i++){var s=t[i].string;if(this.versionSearchString=t[i].subString,s.indexOf(t[i].subString)!=-1)return t[i].identity}}searchVersion(t){var i=t.indexOf(this.versionSearchString);if(i!=-1)return parseFloat(t.substring(i+this.versionSearchString.length+1))}searchVersionIE(){var t=navigator.userAgent.toString().toLowerCase(),i=/(trident)(?:.*rv:([\w.]+))?/.exec(t)||/(msie) ([\w.]+)/.exec(t)||["",null,-1],s="unknown";return i!==null&&i.length===3&&i[2]&&(s=i[2].split(".")[0]),s}};var V;(function(u){u[u.TOP_LEFT=0]="TOP_LEFT",u[u.TOP_CENTER=1]="TOP_CENTER",u[u.TOP_RIGHT=2]="TOP_RIGHT",u[u.CENTER_LEFT=3]="CENTER_LEFT",u[u.CENTER=4]="CENTER",u[u.CENTER_RIGHT=5]="CENTER_RIGHT",u[u.BOTTOM_LEFT=6]="BOTTOM_LEFT",u[u.BOTTOM_CENTER=7]="BOTTOM_CENTER",u[u.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(V||(V={}));var Z=C(),Ii=class extends U{constructor(t){super(t,!1,!0);this.subtitleExpanded=!1;this.isAttributionOpen=!1;this.attributionPosition=V.BOTTOM_LEFT}create(){super.create(),this.$title=Z('<h1 class="title"></h1>'),this.$element.append(this.$title),this.$subtitle=Z(`<div class="subtitle">
                                <div class="wrapper">
                                    <button type="button" class="expand-btn" aria-label="Expand">
                                        <span aria-hidden="true">+</span>
                                    </button>
                                    <span class="text"></span>
                                </div>
                            </div>`),this.$element.append(this.$subtitle),this.$subtitleWrapper=this.$subtitle.find(".wrapper"),this.$subtitleExpand=this.$subtitle.find(".expand-btn"),this.$subtitleText=this.$subtitle.find(".text"),this.$content=Z('<div id="content" class="content"></div>'),this.$element.append(this.$content),this.$attribution=Z(`
                                <div class="attribution">
                                  <div class="header">
                                    <div class="title"></div>
                                    <button type="button" class="close" aria-label="Close">
                                      <span aria-hidden="true">&#215;</span>
                                    </button>
                                  </div>
                                  <div class="main">
                                    <div class="attribution-text"></div>
                                    <div class="license"></div>
                                    <div class="logo"></div>
                                  </div>
                                </div>
        `),this.$attribution.find(".header .title").text(this.content.attribution),this.$content.append(this.$attribution),this.closeAttribution(),this.$closeAttributionButton=this.$attribution.find(".header .close"),this.$closeAttributionButton.on("click",t=>{t.preventDefault(),this.closeAttribution()}),this.$subtitleExpand.on("click",t=>{t.preventDefault(),this.subtitleExpanded=!this.subtitleExpanded,this.subtitleExpanded?(this.$subtitleWrapper.addClass("expanded"),this.$subtitleExpand.text("-")):(this.$subtitleWrapper.removeClass("expanded"),this.$subtitleExpand.text("+")),this.resize()}),E.getBool(this.options.titleEnabled,!0)?this.$title.show():this.$title.hide(),E.getBool(this.options.subtitleEnabled,!1)?this.$subtitle.show():this.$subtitle.hide(),this.whenResized(()=>{this.updateRequiredStatement()})}openAttribution(){this.$attribution.show(),this.isAttributionOpen=!0}closeAttribution(){this.$attribution.hide(),this.isAttributionOpen=!1}updateRequiredStatement(){let t=this.extension.helper.getRequiredStatement(),i=E.getBool(this.options.requiredStatementEnabled,!0);if(!t||!t.value||!i)return;this.openAttribution();let s=this.$attribution.find(".title"),n=this.$attribution.find(".attribution-text"),a=this.$attribution.find(".license"),l=this.$attribution.find(".logo");if(t.label){let o=L(t.label);s.html(o)}else s.text(this.content.attribution);if(t.value){let o=L(t.value);n.html(o),n.find("img").one("load",()=>{this.resize()}).each(function(){this.complete&&Z(this).load()}),n.targetBlank()}a.hide(),l.hide(),this.resize()}resize(){super.resize();let t=k(this.extension.shell.$leftPanel)?Math.floor(this.extension.shell.$leftPanel.width()):0,i=k(this.extension.shell.$rightPanel)?Math.floor(this.extension.shell.$rightPanel.width()):0,s=Math.floor(this.$element.parent().width()-t-i);this.$element.css({left:t,width:s});let n,a;if(this.options&&this.options.titleEnabled===!1||!k(this.$title)?n=0:n=this.$title.outerHeight(!0),this.options&&this.options.subtitleEnabled===!1||!k(this.$subtitle)?a=0:a=this.$subtitle.outerHeight(!0),this.$content.height(this.$element.height()-n-a),this.$content.width(this.$element.width()),this.$attribution&&this.isAttributionOpen){switch(this.attributionPosition){case V.BOTTOM_LEFT:this.$attribution.css("top",this.$content.height()-this.$attribution.outerHeight()-this.$attribution.verticalMargins()),this.$attribution.css("left",0);break;case V.BOTTOM_RIGHT:this.$attribution.css("top",this.$content.height()-this.$attribution.outerHeight()-this.$attribution.verticalMargins()),this.$attribution.css("left",this.$content.width()-this.$attribution.outerWidth()-this.$attribution.horizontalMargins());break}this.$content.width()<=this.$attribution.width()?this.$attribution.hide():this.$attribution.show()}this.subtitle&&this.options.subtitleEnabled?(this.$subtitleText.html(L(this.subtitle.replace(/<br\s*[\/]?>/gi,"; "))),this.$subtitleText.removeClass("elided"),this.$subtitle.show(),this.$subtitleWrapper.css("max-height",this.$content.height()+this.$subtitle.outerHeight()),this.$subtitleWrapper.width(this.$content.width()),this.subtitleExpanded?this.$subtitleText.width(this.$content.width()-this.$subtitleText.horizontalMargins()-2):(this.$subtitleText.width("auto"),this.$subtitleWrapper.width("auto"),this.$subtitleExpand.hide(),this.$subtitleText.width()>this.$content.width()&&(this.$subtitleExpand.show(),this.$subtitleText.addClass("elided"),this.$subtitleText.width(this.$content.width()-(this.$subtitleExpand.outerWidth()+this.$subtitleText.horizontalMargins()))))):this.$subtitle.hide()}};export{U as a,V as b,L as c,zi as d,qi as e,Ji as f,k as g,Ii as h,y as i,R as j,m as k,xi as l};
