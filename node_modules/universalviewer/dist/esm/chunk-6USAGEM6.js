import{a as F,c as et,g as it,i as J,j}from"./chunk-UO64ZU74.js";import{C as tt,a as V,c as x,e as Q,k as z,p as Z,q as C}from"./chunk-WDDAVPLK.js";import{b as ot,c as rt}from"./chunk-YAXTLTJC.js";var nt=ot((G,X)=>{(function(P,f){typeof G=="object"&&typeof X=="object"?X.exports=f():typeof define=="function"&&define.amd?define("IIIFMetadataComponent",[],f):typeof G=="object"?G.IIIFMetadataComponent=f():P.IIIFMetadataComponent=f()})(typeof self!="undefined"?self:G,function(){return function(P){var f={};function O(v){if(f[v])return f[v].exports;var p=f[v]={i:v,l:!1,exports:{}};return P[v].call(p.exports,p,p.exports,O),p.l=!0,p.exports}return O.m=P,O.c=f,O.d=function(v,p,g){O.o(v,p)||Object.defineProperty(v,p,{enumerable:!0,get:g})},O.r=function(v){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(v,"__esModule",{value:!0})},O.t=function(v,p){if(1&p&&(v=O(v)),8&p||4&p&&typeof v=="object"&&v&&v.__esModule)return v;var g=Object.create(null);if(O.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:v}),2&p&&typeof v!="string")for(var o in v)O.d(g,o,function(h){return v[h]}.bind(null,o));return g},O.n=function(v){var p=v&&v.__esModule?function(){return v.default}:function(){return v};return O.d(p,"a",p),p},O.o=function(v,p){return Object.prototype.hasOwnProperty.call(v,p)},O.p="",O(O.s=0)}([function(P,f,O){P.exports=O(1)},function(P,f,O){"use strict";var v,p=this&&this.__extends||(v=function(s,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}v(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(f,"__esModule",{value:!0});var g,o=O(2),h=O(3),c=O(4);(function(s){s.LINES="lines",s.CHARS="chars"})(g=f.LimitType||(f.LimitType={}));var r=function(s){function e(t){var i=s.call(this,t)||this;return i._data=i.data(),i._data=i.options.data,i._init(),i._resize(),i}return p(e,s),e.prototype._init=function(){return s.prototype._init.call(this),this._$element=$(this.el),this._$metadataGroupTemplate=$('<div class="group">          <div class="header"></div>          <div class="items"></div>      </div>'),this._$metadataItemTemplate=$('<div class="item">          <div class="label"></div>          <div class="values"></div>      </div>'),this._$metadataItemValueTemplate=$('<div class="value"></div>'),this._$metadataItemURIValueTemplate=$('<a class="value" href="" target="_blank"></a>'),this._$copyTextTemplate=$('<div class="copyText" alt="'+this.options.data.content.copyToClipboard+'" title="'+this.options.data.content.copyToClipboard+'">        <div class="copiedText">'+this.options.data.content.copiedToClipboard+" </div>        </div>"),this._$metadataGroups=$('<div class="groups"></div>'),this._$element.append(this._$metadataGroups),this._$noData=$('<div class="noData">'+this.options.data.content.noData+"</div>"),this._$element.append(this._$noData),!0},e.prototype.data=function(){return{aggregateValues:"",canvases:null,canvasDisplayOrder:"",metadataGroupOrder:"",canvasExclude:"",canvasLabels:"",content:{attribution:"Attribution",canvasHeader:"About the canvas",copiedToClipboard:"Copied to clipboard",copyToClipboard:"Copy to clipboard",description:"Description",imageHeader:"About the image",less:"less",license:"License",logo:"Logo",manifestHeader:"About the item",more:"more",noData:"No data to display",rangeHeader:"About the range",sequenceHeader:"About the sequence"},copiedMessageDuration:2e3,copyToClipboardEnabled:!1,helper:null,licenseFormatter:null,limit:4,limitType:g.LINES,limitToRange:!1,manifestDisplayOrder:"",manifestExclude:"",range:null,rtlLanguageCodes:"ar, ara, dv, div, he, heb, ur, urd",sanitizer:function(t){return t},showAllLanguages:!1}},e.prototype._getManifestGroup=function(){return this._metadataGroups.filter(function(t){return t.resource.isManifest()})[0]},e.prototype._getCanvasGroups=function(){return this._metadataGroups.filter(function(t){return t.resource.isCanvas()})},e.prototype.set=function(t){var i=this;if(this._data=Object.assign(this._data,t),this._data&&this._data.helper){var n,a={canvases:this._data.canvases,licenseFormatter:this._data.licenseFormatter,range:this._data.range};if(this._metadataGroups=this._data.helper.getMetadata(a),this._data.manifestDisplayOrder&&((n=this._getManifestGroup()).items=this._sortItems(n.items,this._readCSV(this._data.manifestDisplayOrder))),this._data.canvasDisplayOrder&&this._getCanvasGroups().forEach(function(E,I){E.items=i._sortItems(E.items,i._readCSV(i._data.canvasDisplayOrder))}),this._data.metadataGroupOrder&&(this._metadataGroups=this._sortGroups(this._metadataGroups,this._readCSV(this._data.metadataGroupOrder))),this._data.canvasLabels&&this._label(this._getCanvasGroups(),this._readCSV(this._data.canvasLabels,!1)),this._data.manifestExclude&&((n=this._getManifestGroup()).items=this._exclude(n.items,this._readCSV(this._data.manifestExclude))),this._data.canvasExclude&&this._getCanvasGroups().forEach(function(E,I){E.items=i._exclude(E.items,i._readCSV(i._data.canvasExclude))}),this._data.limitToRange){var d=[];this._metadataGroups.forEach(function(E,I){E.resource.isRange()&&d.push(E)}),d.length&&(this._metadataGroups=d)}this._render()}},e.prototype._sortItems=function(t,i){var n=this,a=[],d=t.slice(0);return i.forEach(function(E,I){var A=d.filter(function(b){return n._normalise(b.getLabel())===E})[0];if(A){a.push(A);var L=d.indexOf(A);L>-1&&d.splice(L,1)}}),d.forEach(function(E,I){a.push(E)}),a},e.prototype._sortGroups=function(t,i){var n=[],a=t.slice(0);return i.forEach(function(d,E){var I=a.filter(function(L){return L.resource.getIIIFResourceType().toLowerCase()==d.toLowerCase()})[0];if(I){n.push(I);var A=a.indexOf(I);A>-1&&a.splice(A,1)}}),n},e.prototype._label=function(t,i){t.forEach(function(n,a){n.label=i[a]})},e.prototype._exclude=function(t,i){var n=this;return i.forEach(function(a,d){var E=t.filter(function(A){return n._normalise(A.getLabel())===a})[0];if(E){var I=t.indexOf(E);I>-1&&t.splice(I,1)}}),t},e.prototype._normalise=function(t){return t?t.toLowerCase().replace(/ /g,""):null},e.prototype._render=function(){var t=this;this._metadataGroups.length?(this._$noData.hide(),this._$metadataGroups.empty(),this._metadataGroups.forEach(function(i,n){var a=t._buildMetadataGroup(i);t._$metadataGroups.append(a);var d=a.find(".value");t._data.limit&&t._data.content&&(t._data.limitType===g.LINES?d.toggleExpandTextByLines(t._data.limit,t._data.content.less,t._data.content.more,function(){}):t._data.limitType===g.CHARS&&d.ellipsisHtmlFixed(t._data.limit,function(){}))})):this._$noData.show()},e.prototype._buildMetadataGroup=function(t){var i=this._$metadataGroupTemplate.clone(),n=i.find(">.header");if(this._data.content){if(t.resource.isManifest()&&this._data.content.manifestHeader)(d=this._sanitize(this._data.content.manifestHeader))&&n.html(d);else if(t.resource.isSequence()&&this._data.content.sequenceHeader)(d=this._sanitize(this._data.content.sequenceHeader))&&n.html(d);else if(t.resource.isRange()&&this._data.content.rangeHeader)(d=this._sanitize(this._data.content.rangeHeader))&&n.html(d);else if(t.resource.isCanvas()&&(t.label||this._data.content.canvasHeader)){var a=t.label||this._data.content.canvasHeader;n.html(this._sanitize(a))}else if(t.resource.isAnnotation()&&this._data.content.imageHeader){var d;(d=this._sanitize(this._data.content.imageHeader))&&n.html(d)}}n.text()||n.hide();for(var E=i.find(".items"),I=0;I<t.items.length;I++){var A=t.items[I],L=this._buildMetadataItem(A);E.append(L)}return i},e.prototype._buildMetadataItem=function(t){var i,n=this._$metadataItemTemplate.clone(),a=n.find(".label"),d=n.find(".values"),E=t.getLabel(),I=E,A=new RegExp("/w+:(/?/?)[^s]+/gm","i");if(this._data.content&&I&&t.isRootLevel)switch(I.toLowerCase()){case"attribution":I=this._data.content.attribution;break;case"description":I=this._data.content.description;break;case"license":I=this._data.content.license;break;case"logo":I=this._data.content.logo}if(I=this._sanitize(I),a.html(I),this._addReadingDirection(a,this._getLabelLocale(t)),n.addClass(c.Strings.toCssClass(I)),E&&E.toLowerCase()==="license"&&A.exec(t.value[0].value)!==null)i=this._buildMetadataItemURIValue(t.value[0].value),d.append(i);else if(this._data.showAllLanguages&&t.value&&t.value.length>1)for(var L=0;L<t.value.length;L++){var b=t.value[L];i=this._buildMetadataItemValue(b.value,b.locale),d.append(i)}else{var m=this._getValueLocale(t),l=!1;for(L=0;L<t.value.length;L++){var b=t.value[L];m.toLowerCase()===b.locale.toLowerCase()&&(l=!0,i=this._buildMetadataItemValue(b.value,b.locale),d.append(i))}l||(b=t.value[0])&&(i=this._buildMetadataItemValue(b.value,b.locale),d.append(i))}this._data.copyToClipboardEnabled&&c.Clipboard.supportsCopy()&&a.text()&&this._addCopyButton(n,a,d);var _=this;return n.on("click","a.iiif-viewer-link",function(y){y.preventDefault();var T=$(y.target),S=T.attr("data-uv-navigate")||T.prop("href");_.fire(u.IIIF_VIEWER_LINK_CLICKED,S)}),n.on("click","[data-uv-navigate]",function(y){y.preventDefault();var T=$(y.target).attr("data-uv-navigate")||null;T&&_.fire(u.IIIF_VIEWER_LINK_CLICKED,T)}),n},e.prototype._getLabelLocale=function(t){if(!this._data||!this._data.helper)return"";var i=this._data.helper.options.locale;if(t.label.length){var n=t.label[0].locale;if(n.toLowerCase()!==i.toLowerCase())return n}return i},e.prototype._getValueLocale=function(t){return this._data&&this._data.helper?this._data.helper.options.locale:""},e.prototype._buildMetadataItemValue=function(t,i){t=(t=this._sanitize(t)).replace(`
`,"<br>");var n=this._$metadataItemValueTemplate.clone();return n.html(t),n.find("a").each(function(){var a=$(this);a.hasClass("iiif-viewer-link")||a.prop("target","_blank")}),i&&this._addReadingDirection(n,i),n},e.prototype._buildMetadataItemURIValue=function(t){t=this._sanitize(t);var i=this._$metadataItemURIValueTemplate.clone();return i.prop("href",t),i.text(t),i},e.prototype._addReadingDirection=function(t,i){i=o.Utils.getInexactLocale(i),this._readCSV(this._data.rtlLanguageCodes).filter(function(n){return n===i}).length>0&&(t.prop("dir","rtl"),t.addClass("rtl"))},e.prototype._addCopyButton=function(t,i,n){var a=this._$copyTextTemplate.clone(),d=a.children();i.append(a),c.Device.isTouch()?a.show():(t.on("mouseenter",function(){a.show()}),t.on("mouseleave",function(){a.hide()}),a.on("mouseleave",function(){d.hide()}));var E=this,I=n.text();a.on("click",function(A){E._copyItemValues(a,I)})},e.prototype._copyItemValues=function(t,i){c.Clipboard.copy(i);var n=t.find(".copiedText");n.show(),setTimeout(function(){n.hide()},this._data.copiedMessageDuration)},e.prototype._readCSV=function(t,i){i===void 0&&(i=!0);var n=[];if(t&&(n=t.split(","),i))for(var a=0;a<n.length;a++)n[a]=this._normalise(n[a]);return n},e.prototype._sanitize=function(t){return this._data.sanitizer?this._data.sanitizer(t):null},e.prototype._resize=function(){},e}(h.BaseComponent);f.MetadataComponent=r;var u=function(){function s(){}return s.IIIF_VIEWER_LINK_CLICKED="iiifViewerLinkClicked",s}();f.Events=u},function(P,f,O){P.exports=function(v){var p={};function g(o){if(p[o])return p[o].exports;var h=p[o]={i:o,l:!1,exports:{}};return v[o].call(h.exports,h,h.exports,g),h.l=!0,h.exports}return g.m=v,g.c=p,g.d=function(o,h,c){g.o(o,h)||Object.defineProperty(o,h,{enumerable:!0,get:c})},g.r=function(o){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},g.t=function(o,h){if(1&h&&(o=g(o)),8&h||4&h&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(g.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),2&h&&typeof o!="string")for(var r in o)g.d(c,r,function(u){return o[u]}.bind(null,r));return c},g.n=function(o){var h=o&&o.__esModule?function(){return o.default}:function(){return o};return g.d(h,"a",h),h},g.o=function(o,h){return Object.prototype.hasOwnProperty.call(o,h)},g.p="",g(g.s=4)}([function(v,p,g){"use strict";function o(h){for(var c in h)p.hasOwnProperty(c)||(p[c]=h[c])}Object.defineProperty(p,"__esModule",{value:!0}),o(g(6)),o(g(7)),o(g(8)),o(g(9)),o(g(10)),o(g(11)),o(g(12)),o(g(13)),o(g(14)),o(g(15)),o(g(16)),o(g(17)),o(g(18)),o(g(19)),o(g(20)),o(g(21)),o(g(22)),o(g(23)),o(g(24)),o(g(25)),o(g(26)),o(g(27)),o(g(28)),o(g(29)),o(g(30)),o(g(31)),o(g(32)),o(g(2))},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),function(o){o.BOOKMARKING="oa:bookmarking",o.CLASSIFYING="oa:classifying",o.COMMENTING="oa:commenting",o.DESCRIBING="oa:describing",o.EDITING="oa:editing",o.HIGHLIGHTING="oa:highlighting",o.IDENTIFYING="oa:identifying",o.LINKING="oa:linking",o.MODERATING="oa:moderating",o.PAINTING="sc:painting",o.QUESTIONING="oa:questioning",o.REPLYING="oa:replying",o.TAGGING="oa:tagging",o.TRANSCRIBING="oad:transcribing"}(p.AnnotationMotivation||(p.AnnotationMotivation={})),function(o){o.AUTO_ADVANCE="auto-advance",o.CONTINUOUS="continuous",o.FACING_PAGES="facing-pages",o.HIDDEN="hidden",o.INDIVIDUALS="individuals",o.MULTI_PART="multi-part",o.NO_NAV="no-nav",o.NON_PAGED="non-paged",o.PAGED="paged",o.REPEAT="repeat",o.SEQUENCE="sequence",o.THUMBNAIL_NAV="thumbnail-nav",o.TOGETHER="together",o.UNORDERED="unordered"}(p.Behavior||(p.Behavior={})),function(o){o.CANVAS="canvas",o.CHOICE="choice",o.CONTENT_AS_TEXT="contentastext",o.DOCUMENT="document",o.IMAGE="image",o.MOVING_IMAGE="movingimage",o.PDF="pdf",o.PHYSICAL_OBJECT="physicalobject",o.SOUND="sound",o.TEXTUALBODY="textualbody",o.VIDEO="video"}(p.ExternalResourceType||(p.ExternalResourceType={})),function(o){o.ANNOTATION="annotation",o.CANVAS="canvas",o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range",o.SEQUENCE="sequence"}(p.IIIFResourceType||(p.IIIFResourceType={})),function(o){o.AUDIO_MP4="audio/mp4",o.CORTO="application/corto",o.DRACO="application/draco",o.GLTF="model/gltf+json",o.JPG="image/jpeg",o.M3U8="application/vnd.apple.mpegurl",o.MP3="audio/mp3",o.MPEG_DASH="application/dash+xml",o.OBJ="text/plain",o.PDF="application/pdf",o.PLY="application/ply",o.THREEJS="application/vnd.threejs+json",o.VIDEO_MP4="video/mp4",o.WEBM="video/webm"}(p.MediaType||(p.MediaType={})),function(o){o.DOC="application/msword",o.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",o.PDF="application/pdf"}(p.RenderingFormat||(p.RenderingFormat={})),function(o){o.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",o.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",o.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",o.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",o.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",o.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",o.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",o.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",o.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",o.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",o.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",o.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",o.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",o.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",o.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",o.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",o.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",o.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",o.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",o.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",o.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",o.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",o.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",o.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",o.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",o.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",o.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",o.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",o.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",o.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",o.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",o.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",o.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",o.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",o.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",o.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",o.SEARCH_0="http://iiif.io/api/search/0/search",o.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",o.SEARCH_1="http://iiif.io/api/search/1/search",o.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",o.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",o.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",o.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",o.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",o.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",o.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(p.ServiceProfile||(p.ServiceProfile={})),function(o){o.BOTTOM_TO_TOP="bottom-to-top",o.LEFT_TO_RIGHT="left-to-right",o.RIGHT_TO_LEFT="right-to-left",o.TOP_TO_BOTTOM="top-to-bottom"}(p.ViewingDirection||(p.ViewingDirection={})),function(o){o.CONTINUOUS="continuous",o.INDIVIDUALS="individuals",o.NON_PAGED="non-paged",o.PAGED="paged",o.TOP="top"}(p.ViewingHint||(p.ViewingHint={}))},function(v,p,g){"use strict";var o=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(a,d){function E(L){try{A(n.next(L))}catch(b){d(b)}}function I(L){try{A(n.throw(L))}catch(b){d(b)}}function A(L){var b;L.done?a(L.value):(b=L.value,b instanceof i?b:new i(function(m){m(b)})).then(E,I)}A((n=n.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var i,n,a,d,E={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return d={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function I(A){return function(L){return function(b){if(i)throw new TypeError("Generator is already executing.");for(;E;)try{if(i=1,n&&(a=2&b[0]?n.return:b[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,b[1])).done)return a;switch(n=0,a&&(b=[2&b[0],a.value]),b[0]){case 0:case 1:a=b;break;case 4:return E.label++,{value:b[1],done:!1};case 5:E.label++,n=b[1],b=[0];continue;case 7:b=E.ops.pop(),E.trys.pop();continue;default:if(!(a=(a=E.trys).length>0&&a[a.length-1])&&(b[0]===6||b[0]===2)){E=0;continue}if(b[0]===3&&(!a||b[1]>a[0]&&b[1]<a[3])){E.label=b[1];break}if(b[0]===6&&E.label<a[1]){E.label=a[1],a=b;break}if(a&&E.label<a[2]){E.label=a[2],E.ops.push(b);break}a[2]&&E.ops.pop(),E.trys.pop();continue}b=t.call(e,E)}catch(m){b=[6,m],n=0}finally{i=a=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([A,L])}}};Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=g(1),u=g(33);g(34);var s=function(){function e(){}return e.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},e.getImageQuality=function(t){return t===r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||t===r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||t===r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||t===r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||t===r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||t===r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||t===r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||t===r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||t===r.ServiceProfile.IMAGE_1_LEVEL_1||t===r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||t===r.ServiceProfile.IMAGE_1_LEVEL_2||t===r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},e.getInexactLocale=function(t){return t.indexOf("-")!==-1?t.substr(0,t.indexOf("-")):t},e.getLocalisedValue=function(t,i){if(!Array.isArray(t))return t;for(var n=0;n<t.length;n++){var a=t[n];if(i===a["@language"])return a["@value"]}var d=i.substr(0,i.indexOf("-"));for(n=0;n<t.length;n++){var E=t[n];if(E["@language"]===d)return E["@value"]}return null},e.generateTreeNodeIds=function(t,i){var n;i===void 0&&(i=0),n=t.parentNode?t.parentNode.id+"-"+i:"0",t.id=n;for(var a=0;a<t.nodes.length;a++){var d=t.nodes[a];e.generateTreeNodeIds(d,a)}},e.normaliseType=function(t){return(t=t.toLowerCase()).indexOf(":")!==-1?t.split(":")[1]:t},e.normaliseUrl=function(t){return(t=t.substr(t.indexOf("://"))).indexOf("#")!==-1&&(t=t.split("#")[0]),t},e.normalisedUrlsMatch=function(t,i){return e.normaliseUrl(t)===e.normaliseUrl(i)},e.isImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.isLevel0ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},e.isLevel1ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},e.isLevel2ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(t,r.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.parseManifest=function(t,i){return c.Deserialiser.parse(t,i)},e.checkStatus=function(t){if(t.ok)return t;var i=new Error(t.statusText);return i.response=t,Promise.reject(i)},e.loadManifest=function(t){return new Promise(function(i){fetch(t).then(e.checkStatus).then(function(n){return n.json()}).then(function(n){i(n)})})},e.loadExternalResourcesAuth1=function(t,i,n,a,d,E,I,A){return new Promise(function(L,b){var m=t.map(function(l){return e.loadExternalResourceAuth1(l,i,n,a,d,E,I,A)});Promise.all(m).then(function(){L(t)}).catch(function(l){b(l)})})},e.loadExternalResourceAuth1=function(t,i,n,a,d,E,I,A){return o(this,void 0,void 0,function(){var L;return h(this,function(b){switch(b.label){case 0:return[4,a(t)];case 1:return(L=b.sent())?[4,t.getData(L)]:[3,6];case 2:return b.sent(),t.status!==u.OK?[3,3]:[2,t];case 3:return[4,e.doAuthChain(t,i,n,d,E,I,A)];case 4:b.sent(),b.label=5;case 5:if(t.status===u.OK||t.status===u.MOVED_TEMPORARILY)return[2,t];throw e.createAuthorizationFailedError();case 6:return[4,t.getData()];case 7:return b.sent(),t.status!==u.MOVED_TEMPORARILY&&t.status!==u.UNAUTHORIZED?[3,9]:[4,e.doAuthChain(t,i,n,d,E,I,A)];case 8:b.sent(),b.label=9;case 9:if(t.status===u.OK||t.status===u.MOVED_TEMPORARILY)return[2,t];throw e.createAuthorizationFailedError()}})})},e.doAuthChain=function(t,i,n,a,d,E,I){return o(this,void 0,void 0,function(){var A,L,b,m,l,_,y,T;return h(this,function(S){switch(S.label){case 0:return t.isAccessControlled()?((A=t.externalService)&&(A.options=t.options),(L=t.kioskService)&&(L.options=t.options),(b=t.clickThroughService)&&(b.options=t.options),(m=t.loginService)&&(m.options=t.options),t.isResponseHandled||t.status!==u.MOVED_TEMPORARILY?[3,2]:[4,E(t)]):[2,t];case 1:return S.sent(),[2,t];case 2:return l=null,_=null,(l=A)?(_=l,[4,e.attemptResourceWithToken(t,n,l)]):[3,4];case 3:return S.sent(),[2,t];case 4:return(l=L)?(_=l,(y=i(l))?[4,a(y)]:[3,7]):[3,7];case 5:return S.sent(),[4,e.attemptResourceWithToken(t,n,l)];case 6:return S.sent(),[2,t];case 7:return(l=b)?(_=l,[4,d(t,l)]):[3,11];case 8:return(T=S.sent())?[4,a(T)]:[3,11];case 9:return S.sent(),[4,e.attemptResourceWithToken(t,n,l)];case 10:return S.sent(),[2,t];case 11:return(l=m)?(_=l,[4,d(t,l)]):[3,15];case 12:return(T=S.sent())?[4,a(T)]:[3,15];case 13:return S.sent(),[4,e.attemptResourceWithToken(t,n,l)];case 14:return S.sent(),[2,t];case 15:return _&&I(t,_),[2]}})})},e.attemptResourceWithToken=function(t,i,n){return o(this,void 0,void 0,function(){var a,d;return h(this,function(E){switch(E.label){case 0:return(a=n.getService(r.ServiceProfile.AUTH_1_TOKEN))?[4,i(t,a)]:[3,3];case 1:return(d=E.sent())&&d.accessToken?[4,t.getData(d)]:[3,3];case 2:return E.sent(),[2,t];case 3:return[2]}})})},e.loadExternalResourcesAuth09=function(t,i,n,a,d,E,I,A,L,b){return new Promise(function(m,l){var _=t.map(function(y){return e.loadExternalResourceAuth09(y,i,n,a,d,E,I,A,L,b)});Promise.all(_).then(function(){m(t)}).catch(function(y){l(y)})})},e.loadExternalResourceAuth09=function(t,i,n,a,d,E,I,A,L,b){return new Promise(function(m,l){b&&b.pessimisticAccessControl?t.getData().then(function(){t.isAccessControlled()?t.clickThroughService?(m(n(t)),m(a(t))):d(t).then(function(){E(t,!0).then(function(_){t.getData(_).then(function(){m(L(t))}).catch(function(y){l(e.createInternalServerError(y))})}).catch(function(_){l(e.createInternalServerError(_))})}).catch(function(_){l(e.createInternalServerError(_))}):m(t)}).catch(function(_){l(e.createInternalServerError(_))}):A(t,i).then(function(_){_?t.getData(_).then(function(){t.status===u.OK?m(L(t)):e.authorize(t,i,n,a,d,E,I,A).then(function(){m(L(t))}).catch(function(y){l(e.createAuthorizationFailedError())})}).catch(function(y){l(e.createAuthorizationFailedError())}):e.authorize(t,i,n,a,d,E,I,A).then(function(){m(L(t))}).catch(function(y){l(e.createAuthorizationFailedError())})}).catch(function(_){l(e.createAuthorizationFailedError())})})},e.createError=function(t,i){var n=new Error;return n.message=i,n.name=String(t),n},e.createAuthorizationFailedError=function(){return e.createError(c.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},e.createRestrictedError=function(){return e.createError(c.StatusCode.RESTRICTED,"Restricted")},e.createInternalServerError=function(t){return e.createError(c.StatusCode.INTERNAL_SERVER_ERROR,t)},e.authorize=function(t,i,n,a,d,E,I,A){return new Promise(function(L,b){t.getData().then(function(){t.isAccessControlled()?A(t,i).then(function(m){m?t.getData(m).then(function(){t.status===u.OK?L(t):e.showAuthInteraction(t,i,n,a,d,E,I,L,b)}).catch(function(l){b(e.createInternalServerError(l))}):E(t,!1).then(function(l){l?I(t,l,i).then(function(){t.getData(l).then(function(){t.status===u.OK?L(t):e.showAuthInteraction(t,i,n,a,d,E,I,L,b)}).catch(function(_){b(e.createInternalServerError(_))})}).catch(function(_){b(e.createInternalServerError(_))}):e.showAuthInteraction(t,i,n,a,d,E,I,L,b)})}).catch(function(m){b(e.createInternalServerError(m))}):L(t)})})},e.showAuthInteraction=function(t,i,n,a,d,E,I,A,L){t.status!==u.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?n(t).then(function(){E(t,!0).then(function(b){I(t,b,i).then(function(){t.getData(b).then(function(){A(t)}).catch(function(m){L(e.createInternalServerError(m))})}).catch(function(m){L(e.createInternalServerError(m))})}).catch(function(b){L(e.createInternalServerError(b))})}):d(t).then(function(){E(t,!0).then(function(b){I(t,b,i).then(function(){t.getData(b).then(function(){A(t)}).catch(function(m){L(e.createInternalServerError(m))})}).catch(function(m){L(e.createInternalServerError(m))})}).catch(function(b){L(e.createInternalServerError(b))})}):A(t)},e.getService=function(t,i){for(var n=this.getServices(t),a=0;a<n.length;a++){var d=n[a];if(d.getProfile()===i)return d}return null},e.getResourceById=function(t,i){return e.traverseAndFind(t.__jsonld,"@id",i)},e.traverseAndFind=function(t,i,n){if(t.hasOwnProperty(i)&&t[i]===n)return t;for(var a=0;a<Object.keys(t).length;a++)if(typeof t[Object.keys(t)[a]]=="object"){var d=e.traverseAndFind(t[Object.keys(t)[a]],i,n);if(d!=null)return d}},e.getServices=function(t){var i,n=[];if(!(i=t.__jsonld?t.__jsonld.service:t.service))return n;Array.isArray(i)||(i=[i]);for(var a=0;a<i.length;a++){var d=i[a];if(typeof d=="string"){var E=this.getResourceById(t.options.resource,d);E&&n.push(new c.Service(E.__jsonld||E,t.options))}else n.push(new c.Service(d,t.options))}return n},e.getTemporalComponent=function(t){var i=/t=([^&]+)/g.exec(t),n=null;return i&&i[1]&&(n=i[1].split(",")),n},e}();p.Utils=s},function(v,p,g){"use strict";g.r(p),p.default=function(o,h){return h=h||{},new Promise(function(c,r){var u=new XMLHttpRequest,s=[],e=[],t={},i=function(){return{ok:(u.status/100|0)==2,statusText:u.statusText,status:u.status,url:u.responseURL,text:function(){return Promise.resolve(u.responseText)},json:function(){return Promise.resolve(JSON.parse(u.responseText))},blob:function(){return Promise.resolve(new Blob([u.response]))},clone:i,headers:{keys:function(){return s},entries:function(){return e},get:function(a){return t[a.toLowerCase()]},has:function(a){return a.toLowerCase()in t}}}};for(var n in u.open(h.method||"get",o,!0),u.onload=function(){u.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(a,d,E){s.push(d=d.toLowerCase()),e.push([d,E]),t[d]=t[d]?t[d]+","+E:E}),c(i())},u.onerror=r,u.withCredentials=h.credentials=="include",h.headers)u.setRequestHeader(n,h.headers[n]);u.send(h.body||null)})}},function(v,p,g){v.exports=g(5)},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),function(h){for(var c in h)p.hasOwnProperty(c)||(p[c]=h[c])}(g(0));var o=g(2);p.loadManifest=function(h){return o.Utils.loadManifest(h)},p.parseManifest=function(h,c){return o.Utils.parseManifest(h,c)}},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=function(){function h(c){this.__jsonld=c,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return h.prototype.getProperty=function(c){var r=null;return this.__jsonld&&((r=this.__jsonld[c])||(r=this.__jsonld["@"+c])),r},h}();p.JSONLDResource=o},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=g(1),u=function(s){function e(t,i){var n=s.call(this,t)||this;return n.options=i,n}return h(e,s),e.prototype.getIIIFResourceType=function(){return c.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLabel=function(){var t=this.getProperty("label");return t?c.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getDefaultLabel=function(){return c.LanguageMap.getValue(this.getLabel())},e.prototype.getMetadata=function(){var t=this.getProperty("metadata"),i=[];if(!t)return i;for(var n=0;n<t.length;n++){var a=t[n],d=new c.LabelValuePair(this.options.locale);d.parse(a),i.push(d)}return i},e.prototype.getRendering=function(t){for(var i=this.getRenderings(),n=0;n<i.length;n++){var a=i[n];if(a.getFormat()===t)return a}return null},e.prototype.getRenderings=function(){var t,i=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return i;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var a=t[n];i.push(new c.Rendering(a,this.options))}return i},e.prototype.getService=function(t){return c.Utils.getService(this,t)},e.prototype.getServices=function(){return c.Utils.getServices(this)},e.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new c.Thumbnail(t,this.options):null},e.prototype.isAnnotation=function(){return this.getIIIFResourceType()===r.IIIFResourceType.ANNOTATION},e.prototype.isCanvas=function(){return this.getIIIFResourceType()===r.IIIFResourceType.CANVAS},e.prototype.isCollection=function(){return this.getIIIFResourceType()===r.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===r.IIIFResourceType.MANIFEST},e.prototype.isRange=function(){return this.getIIIFResourceType()===r.IIIFResourceType.RANGE},e.prototype.isSequence=function(){return this.getIIIFResourceType()===r.IIIFResourceType.SEQUENCE},e}(c.JSONLDResource);p.ManifestResource=u},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t){return u.call(this,e,t)||this}return h(s,u),s.prototype.getFormat=function(){var e=this.getProperty("format");return e?e.toLowerCase():null},s.prototype.getResources=function(){var e=[];if(!this.__jsonld.resources)return e;for(var t=0;t<this.__jsonld.resources.length;t++){var i=this.__jsonld.resources[t],n=new c.Annotation(i,this.options);e.push(n)}return e},s.prototype.getType=function(){var e=this.getProperty("type");return e?c.Utils.normaliseType(e):null},s.prototype.getWidth=function(){return this.getProperty("width")},s.prototype.getHeight=function(){return this.getProperty("height")},s.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},s.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},s}(c.ManifestResource);p.Resource=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=g(1),u=function(s){function e(t,i){var n=s.call(this,t,i)||this;n.index=-1,n.isLoaded=!1;var a={defaultLabel:"-",locale:"en-GB",resource:n,pessimisticAccessControl:!1};return n.options=Object.assign(a,i),n}return h(e,s),e.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?c.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getDescription=function(){var t=this.getProperty("description");return t?c.LanguageMap.parse(t,this.options.locale):[]},e.prototype.getIIIFResourceType=function(){return c.Utils.normaliseType(this.getProperty("type"))},e.prototype.getLogo=function(){var t=this.getProperty("logo");return t?typeof t=="string"?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},e.prototype.getLicense=function(){return c.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},e.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},e.prototype.getRelated=function(){return this.getProperty("related")},e.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},e.prototype.getTrackingLabel=function(){var t=this.getService(r.ServiceProfile.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},e.prototype.getDefaultTree=function(){return this.defaultTree=new c.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},e.prototype.getRequiredStatement=function(){var t=null,i=this.getProperty("requiredStatement");if(i)(t=new c.LabelValuePair(this.options.locale)).parse(i);else{var n=this.getAttribution();n&&((t=new c.LabelValuePair(this.options.locale)).value=n)}return t},e.prototype.isCollection=function(){return this.getIIIFResourceType()===r.IIIFResourceType.COLLECTION},e.prototype.isManifest=function(){return this.getIIIFResourceType()===r.IIIFResourceType.MANIFEST},e.prototype.load=function(){var t=this;return new Promise(function(i){if(t.isLoaded)i(t);else{var n=t.options;n.navDate=t.getNavDate();var a=t.__jsonld.id;a||(a=t.__jsonld["@id"]),c.Utils.loadManifest(a).then(function(d){t.parentLabel=c.LanguageMap.getValue(t.getLabel(),n.locale);var E=c.Deserialiser.parse(d,n);(t=Object.assign(t,E)).index=n.index,i(t)})}})},e}(c.ManifestResource);p.IIIFResource=u},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t){return u.call(this,e,t)||this}return h(s,u),s.prototype.getBody=function(){var e=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var i=0;i<t.length;i++)if((d=t[i]).items)for(var n=0;n<d.items.length;n++){var a=d.items[n];e.push(new c.AnnotationBody(a,this.options))}else e.push(new c.AnnotationBody(d,this.options));else if(t.items)for(i=0;i<t.items.length;i++){var d=t.items[i];e.push(new c.AnnotationBody(d,this.options))}else e.push(new c.AnnotationBody(t,this.options));return e},s.prototype.getMotivation=function(){return this.getProperty("motivation")||null},s.prototype.getOn=function(){return this.getProperty("on")},s.prototype.getTarget=function(){return this.getProperty("target")},s.prototype.getResource=function(){return new c.Resource(this.getProperty("resource"),this.options)},s}(c.ManifestResource);p.Annotation=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t){return u.call(this,e,t)||this}return h(s,u),s.prototype.getFormat=function(){var e=this.getProperty("format");return e?c.Utils.getMediaType(e):null},s.prototype.getType=function(){return this.getProperty("type")?c.Utils.normaliseType(this.getProperty("type")):null},s.prototype.getWidth=function(){return this.getProperty("width")},s.prototype.getHeight=function(){return this.getProperty("height")},s}(c.ManifestResource);p.AnnotationBody=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t,i){var n=u.call(this,t)||this;return n.label=e,n.options=i,n}return h(s,u),s.prototype.getIIIFResourceType=function(){return c.Utils.normaliseType(this.getProperty("type"))},s.prototype.getLabel=function(){return this.label},s.prototype.getResources=function(){var e=this;return this.getProperty("resources").map(function(t){return new c.Annotation(t,e.options)})},s.prototype.load=function(){var e=this;return new Promise(function(t,i){if(e.isLoaded)t(e);else{var n=e.__jsonld.id;n||(n=e.__jsonld["@id"]),c.Utils.loadManifest(n).then(function(a){e.__jsonld=a,e.context=e.getProperty("context"),e.id=e.getProperty("id"),e.isLoaded=!0,t(e)}).catch(i)}})},s}(c.JSONLDResource);p.AnnotationList=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(r,u){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,e){s.__proto__=e}||function(s,e){for(var t in e)e.hasOwnProperty(t)&&(s[t]=e[t])})(r,u)},function(r,u){function s(){this.constructor=r}o(r,u),r.prototype=u===null?Object.create(u):(s.prototype=u.prototype,new s)});Object.defineProperty(p,"__esModule",{value:!0});var c=function(r){function u(s,e){return r.call(this,s,e)||this}return h(u,r),u.prototype.getItems=function(){return this.getProperty("items")},u}(g(0).ManifestResource);p.AnnotationPage=c},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t){return u.call(this,e,t)||this}return h(s,u),s.prototype.getCanonicalImageUri=function(e){var t,i=null,n="default",a=e;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])i=this.externalResource.data["@id"],a||(a=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(n="native");else{var d=this.getImages();if(d&&d.length){var E=d[0].getResource(),I=E.getServices();if(a||(a=E.getWidth()),I.length){var A=I[0];i=A.id,n=c.Utils.getImageQuality(A.getProfile())}else if(a===E.getWidth())return E.id}if(!i){var L=this.getProperty("thumbnail");if(L){if(typeof L=="string")return L;if(L["@id"])return L["@id"];if(L.length)return L[0].id}}}return t=a+",",i&&i.endsWith("/")&&(i=i.substr(0,i.length-1)),[i,"full",t,0,n+".jpg"].join("/")},s.prototype.getMaxDimensions=function(){var e,t=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(e=this.externalResource.data.profile,Array.isArray(e)&&(e=e.filter(function(i){return i.maxWidth})[0])&&(t=new c.Size(e.maxWidth,e.maxHeight?e.maxHeight:e.maxWidth))),t},s.prototype.getContent=function(){var e=[],t=this.__jsonld.items||this.__jsonld.content;if(!t)return e;var i=null;if(t.length&&(i=new c.AnnotationPage(t[0],this.options)),!i)return e;for(var n=i.getItems(),a=0;a<n.length;a++){var d=n[a],E=new c.Annotation(d,this.options);e.push(E)}return e},s.prototype.getDuration=function(){return this.getProperty("duration")},s.prototype.getImages=function(){var e=[];if(!this.__jsonld.images)return e;for(var t=0;t<this.__jsonld.images.length;t++){var i=this.__jsonld.images[t],n=new c.Annotation(i,this.options);e.push(n)}return e},s.prototype.getIndex=function(){return this.getProperty("index")},s.prototype.getOtherContent=function(){var e=this,t=(Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")]).filter(function(i){return i&&typeof(n=i["@type"])=="string"&&n.toLowerCase()==n.toLowerCase();var n}).map(function(i,n){return new c.AnnotationList(i.label||"Annotation list "+n,i,e.options)}).map(function(i){return i.load()});return Promise.all(t)},s.prototype.getWidth=function(){return this.getProperty("width")},s.prototype.getHeight=function(){return this.getProperty("height")},s}(c.Resource);p.Canvas=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(1),r=g(0),u=function(s){function e(t,i){var n=s.call(this,t,i)||this;return n.items=[],n._collections=null,n._manifests=null,t.__collection=n,n}return h(e,s),e.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(t){return t.isCollection()})},e.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(t){return t.isManifest()})},e.prototype.getCollectionByIndex=function(t){for(var i,n=this.getCollections(),a=0;a<n.length;a++){var d=n[a];d.index===t&&(i=d)}if(i)return i.options.index=t,i.load();throw new Error("Collection index not found")},e.prototype.getManifestByIndex=function(t){for(var i,n=this.getManifests(),a=0;a<n.length;a++){var d=n[a];d.index===t&&(i=d)}if(i)return i.options.index=t,i.load();throw new Error("Manifest index not found")},e.prototype.getTotalCollections=function(){return this.getCollections().length},e.prototype.getTotalManifests=function(){return this.getManifests().length},e.prototype.getTotalItems=function(){return this.items.length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):c.ViewingDirection.LEFT_TO_RIGHT},e.prototype.getDefaultTree=function(){return s.prototype.getDefaultTree.call(this),this.defaultTree.data.type=r.Utils.normaliseType(r.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),r.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var i=0;i<t.getManifests().length;i++){var n=t.getManifests()[i],a=n.getDefaultTree();a.label=n.parentLabel||r.LanguageMap.getValue(n.getLabel(),this.options.locale)||"manifest "+(i+1),a.navDate=n.getNavDate(),a.data.id=n.id,a.data.type=r.Utils.normaliseType(r.TreeNodeType.MANIFEST),t.defaultTree.addNode(a)}},e.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var i=0;i<t.getCollections().length;i++){var n=t.getCollections()[i],a=n.getDefaultTree();a.label=n.parentLabel||r.LanguageMap.getValue(n.getLabel(),this.options.locale)||"collection "+(i+1),a.navDate=n.getNavDate(),a.data.id=n.id,a.data.type=r.Utils.normaliseType(r.TreeNodeType.COLLECTION),t.defaultTree.addNode(a)}},e}(r.IIIFResource);p.Collection=u},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=function(){function h(c,r){this.start=c,this.end=r}return h.prototype.getLength=function(){return this.end-this.start},h}();p.Duration=o},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=g(0),h=function(){function c(r){this.defaultLocale=r}return c.prototype.parse=function(r){this.resource=r,this.label=o.LanguageMap.parse(this.resource.label,this.defaultLocale),this.value=o.LanguageMap.parse(this.resource.value,this.defaultLocale)},c.prototype.getLabel=function(){return this.label?o.LanguageMap.getValue(this.label,this.defaultLocale):null},c.prototype.setLabel=function(r){var u=this;if(this.label&&this.label.length){var s=this.label.filter(function(e){return e.locale===u.defaultLocale||e.locale===o.Utils.getInexactLocale(u.defaultLocale)})[0];s&&(s.value=r)}},c.prototype.getValue=function(){if(this.value){var r=this.defaultLocale;return this.label&&this.label.length&&this.label[0].locale&&(r=this.label[0].locale),o.LanguageMap.getValue(this.value,r)}return null},c.prototype.setValue=function(r){var u=this;if(this.value&&this.value.length){var s=this.value.filter(function(e){return e.locale===u.defaultLocale||e.locale===o.Utils.getInexactLocale(u.defaultLocale)})[0];s&&(s.value=r)}},c}();p.LabelValuePair=h},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),p.Language=function(o,h){Array.isArray(o)?o.length===1?this.value=o[0]:this.value=o.join("<br/>"):this.value=o,this.locale=h}},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(){return u!==null&&u.apply(this,arguments)||this}return h(s,u),s.parse=function(e,t){var i,n=[];if(!e)return n;if(Array.isArray(e))for(var a=0;a<e.length;a++){var d=e[a];i=typeof d=="string"?new c.Language(d,t):new c.Language(d["@value"],d["@language"]||t),n.push(i)}else{if(typeof e=="string")return i=new c.Language(e,t),n.push(i),n;e["@value"]?(i=new c.Language(e["@value"],e["@language"]||t),n.push(i)):Object.keys(e).forEach(function(E){if(!e[E].length)throw new Error("language must have a value");i=new c.Language(e[E],E),n.push(i)})}return n},s.getValue=function(e,t){if(e.length){if(t){var i=e.filter(function(n){return n.locale===t||c.Utils.getInexactLocale(n.locale)===c.Utils.getInexactLocale(t)})[0];if(i)return i.value}return e[0].value}return null},s}(Array);p.LanguageMap=r},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(1),r=g(0),u=function(s){function e(t,i){var n=s.call(this,t,i)||this;if(n.index=0,n._allRanges=null,n.items=[],n._topRanges=[],n.__jsonld.structures&&n.__jsonld.structures.length)for(var a=n._getTopRanges(),d=0;d<a.length;d++){var E=a[d];n._parseRanges(E,String(d))}return n}return h(e,s),e.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new r.Canvas(t,this.options)),t},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getDefaultTree=function(){if(s.prototype.getDefaultTree.call(this),this.defaultTree.data.type=r.Utils.normaliseType(r.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var t=this.getTopRanges();return t.length&&t[0].getTree(this.defaultTree),r.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},e.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var i=0;i<this.__jsonld.structures.length;i++){var n=this.__jsonld.structures[i];n.viewingHint===c.ViewingHint.TOP&&t.push(n)}if(!t.length){var a={};a.ranges=this.__jsonld.structures,t.push(a)}}return t},e.prototype.getTopRanges=function(){return this._topRanges},e.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var i=0;i<this.__jsonld.structures.length;i++){var n=this.__jsonld.structures[i];if(n["@id"]===t||n.id===t)return n}return null},e.prototype._parseRanges=function(t,i,n){var a,d=null;if(typeof t=="string"&&(d=t,t=this._getRangeById(d)),t){(a=new r.Range(t,this.options)).parentRange=n,a.path=i,n?n.items.push(a):this._topRanges.push(a);var E=t.items||t.members;if(E)for(var I=0;I<E.length;I++){var A=E[I];if(A["@type"]&&A["@type"].toLowerCase()==="sc:range"||A.type&&A.type.toLowerCase()==="range")this._parseRanges(A,i+"/"+I,a);else if(A["@type"]&&A["@type"].toLowerCase()==="sc:canvas"||A.type&&A.type.toLowerCase()==="canvas"){a.canvases||(a.canvases=[]);var L=A.id||A["@id"];a.canvases.push(L)}}else if(t.ranges)for(I=0;I<t.ranges.length;I++)this._parseRanges(t.ranges[I],i+"/"+I,a)}else console.warn("Range:",d,"does not exist")},e.prototype.getAllRanges=function(){if(this._allRanges!=null)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),i=function(d){var E=t[d];E.id&&n._allRanges.push(E);var I=function(L,b){L.add(b);var m=b.getRanges();return m.length?m.reduce(I,L):L},A=Array.from(E.getRanges().reduce(I,new Set));n._allRanges=n._allRanges.concat(A)},n=this,a=0;a<t.length;a++)i(a);return this._allRanges},e.prototype.getRangeById=function(t){for(var i=this.getAllRanges(),n=0;n<i.length;n++){var a=i[n];if(a.id===t)return a}return null},e.prototype.getRangeByPath=function(t){for(var i=this.getAllRanges(),n=0;n<i.length;n++){var a=i[n];if(a.path===t)return a}return null},e.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var i=0;i<t.length;i++){var n=t[i],a=new r.Sequence(n,this.options);this.items.push(a)}else this.__jsonld.items&&(a=new r.Sequence(this.__jsonld.items,this.options),this.items.push(a));return this.items},e.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},e.prototype.getTotalSequences=function(){return this.getSequences().length},e.prototype.getManifestType=function(){var t=this.getService(c.ServiceProfile.UI_EXTENSIONS);return t?t.getProperty("manifestType"):r.ManifestType.EMPTY},e.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===c.ViewingHint.PAGED;var i=this.getBehavior();return!!i&&i===c.Behavior.PAGED},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e}(r.IIIFResource);p.Manifest=u},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),function(o){o.EMPTY="",o.MANUSCRIPT="manuscript",o.MONOGRAPH="monograph"}(p.ManifestType||(p.ManifestType={}))},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=g(1),u=function(s){function e(t,i){var n=s.call(this,t,i)||this;return n._ranges=null,n.canvases=null,n.items=[],n}return h(e,s),e.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},e.prototype.getDuration=function(){var t,i;if(this.canvases&&this.canvases.length)for(var n=0;n<this.canvases.length;n++){var a=this.canvases[n],d=c.Utils.getTemporalComponent(a);d&&d.length>1&&(n===0&&(t=Number(d[0])),n===this.canvases.length-1&&(i=Number(d[1])))}else{var E=this.getRanges();for(n=0;n<E.length;n++){var I=E[n].getDuration();I&&(n===0&&(t=I.start),n===E.length-1&&(i=I.end))}}if(t!==void 0&&i!==void 0)return new c.Duration(t,i)},e.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(t){return t.isRange()})},e.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.getTree=function(t){t.data=this,this.treeNode=t;var i=this.getRanges();if(i&&i.length)for(var n=0;n<i.length;n++){var a=i[n],d=new c.TreeNode;t.addNode(d),this._parseTreeNode(d,a)}return c.Utils.generateTreeNodeIds(t),t},e.prototype.spansTime=function(t){var i=this.getDuration();return!!(i&&t>=i.start&&t<=i.end)},e.prototype._parseTreeNode=function(t,i){t.label=c.LanguageMap.getValue(i.getLabel(),this.options.locale),t.data=i,t.data.type=c.Utils.normaliseType(c.TreeNodeType.RANGE),i.treeNode=t;var n=i.getRanges();if(n&&n.length)for(var a=0;a<n.length;a++){var d=n[a];if(d.getBehavior()!==r.Behavior.NO_NAV){var E=new c.TreeNode;t.addNode(E),this._parseTreeNode(E,d)}}},e}(c.ManifestResource);p.Range=u},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(r,u){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,e){s.__proto__=e}||function(s,e){for(var t in e)e.hasOwnProperty(t)&&(s[t]=e[t])})(r,u)},function(r,u){function s(){this.constructor=r}o(r,u),r.prototype=u===null?Object.create(u):(s.prototype=u.prototype,new s)});Object.defineProperty(p,"__esModule",{value:!0});var c=function(r){function u(s,e){return r.call(this,s,e)||this}return h(u,r),u.prototype.getFormat=function(){return this.getProperty("format")},u}(g(0).ManifestResource);p.Rendering=c},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(s,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(s,e)},function(s,e){function t(){this.constructor=s}o(s,e),s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(1),r=g(0),u=function(s){function e(t,i){var n=s.call(this,t,i)||this;return n.items=[],n._thumbnails=null,n}return h(e,s),e.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var i=0;i<t.length;i++){var n=t[i];(a=new r.Canvas(n,this.options)).index=i,this.items.push(a)}else if(this.__jsonld)for(i=0;i<this.__jsonld.length;i++){var a;n=this.__jsonld[i],(a=new r.Canvas(n,this.options)).index=i,this.items.push(a)}return this.items},e.prototype.getCanvasById=function(t){for(var i=0;i<this.getTotalCanvases();i++){var n=this.getCanvasByIndex(i),a=r.Utils.normaliseUrl(n.id);if(r.Utils.normaliseUrl(t)===a)return n}return null},e.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},e.prototype.getCanvasIndexById=function(t){for(var i=0;i<this.getTotalCanvases();i++)if(this.getCanvasByIndex(i).id===t)return i;return null},e.prototype.getCanvasIndexByLabel=function(t,i){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),i&&(t+="r"));for(var n,a,d,E=/(\d*)\D+(\d*)/,I=0;I<this.getTotalCanvases();I++){var A=this.getCanvasByIndex(I);if(r.LanguageMap.getValue(A.getLabel(),this.options.locale)===t||(n=E.exec(t))&&(a=n[1],(d=n[2])&&new RegExp("^"+a+"\\D+"+d+"$").test(A.getLabel().toString())))return I}return-1},e.prototype.getLastCanvasLabel=function(t){for(var i=this.getTotalCanvases()-1;i>=0;i--){var n=this.getCanvasByIndex(i),a=r.LanguageMap.getValue(n.getLabel(),this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(a))return a}else if(a)return a}return this.options.defaultLabel},e.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},e.prototype.getNextPageIndex=function(t,i){var n;if(i){var a=this.getPagedIndices(t),d=this.getViewingDirection();n=d&&d===c.ViewingDirection.RIGHT_TO_LEFT?a[0]+1:a[a.length-1]+1}else n=t+1;return n>this.getLastPageIndex()?-1:n},e.prototype.getPagedIndices=function(t,i){var n=[];if(i){n=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var a=this.getViewingDirection();a&&a===c.ViewingDirection.RIGHT_TO_LEFT&&(n=n.reverse())}else n.push(t);return n},e.prototype.getPrevPageIndex=function(t,i){var n;if(i){var a=this.getPagedIndices(t),d=this.getViewingDirection();n=d&&d===c.ViewingDirection.RIGHT_TO_LEFT?a[a.length-1]-1:a[0]-1}else n=t-1;return n},e.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t){for(var i=0;i<this.getTotalCanvases();i++)if(this.getCanvasByIndex(i).id===t)return i}return 0},e.prototype.getThumbs=function(t,i){for(var n=[],a=this.getTotalCanvases(),d=0;d<a;d++){var E=this.getCanvasByIndex(d),I=new r.Thumb(t,E);n.push(I)}return n},e.prototype.getThumbnails=function(){if(this._thumbnails!=null)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),i=0;i<t.length;i++){var n=t[i].getThumbnail();n&&this._thumbnails.push(n)}return this._thumbnails},e.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},e.prototype.getTotalCanvases=function(){return this.getCanvases().length},e.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},e.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},e.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},e.prototype.isFirstCanvas=function(t){return t===0},e.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},e.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},e.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===c.ViewingHint.PAGED},e.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},e}(r.ManifestResource);p.Sequence=u},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=g(0),h=function(){function c(){}return c.parse=function(r,u){return typeof r=="string"&&(r=JSON.parse(r)),this.parseJson(r,u)},c.parseJson=function(r,u){var s;if(u&&u.navDate&&!isNaN(u.navDate.getTime())&&(r.navDate=u.navDate.toString()),r["@type"])switch(r["@type"]){case"sc:Collection":s=this.parseCollection(r,u);break;case"sc:Manifest":s=this.parseManifest(r,u);break;default:return null}else switch(r.type){case"Collection":s=this.parseCollection(r,u);break;case"Manifest":s=this.parseManifest(r,u);break;default:return null}return s.isLoaded=!0,s},c.parseCollection=function(r,u){var s=new o.Collection(r,u);return u?(s.index=u.index||0,u.resource&&(s.parentCollection=u.resource.parentCollection)):s.index=0,this.parseCollections(s,u),this.parseManifests(s,u),this.parseItems(s,u),s},c.parseCollections=function(r,u){var s;if(r.__jsonld.collections?s=r.__jsonld.collections:r.__jsonld.items&&(s=r.__jsonld.items.filter(function(i){return i.type.toLowerCase()==="collection"})),s)for(var e=0;e<s.length;e++){u&&(u.index=e);var t=this.parseCollection(s[e],u);t.index=e,t.parentCollection=r,r.items.push(t)}},c.parseManifest=function(r,u){return new o.Manifest(r,u)},c.parseManifests=function(r,u){var s;if(r.__jsonld.manifests?s=r.__jsonld.manifests:r.__jsonld.items&&(s=r.__jsonld.items.filter(function(i){return i.type.toLowerCase()==="manifest"})),s)for(var e=0;e<s.length;e++){var t=this.parseManifest(s[e],u);t.index=e,t.parentCollection=r,r.items.push(t)}},c.parseItem=function(r,u){if(r["@type"]){if(r["@type"].toLowerCase()==="sc:manifest")return this.parseManifest(r,u);if(r["@type"].toLowerCase()==="sc:collection")return this.parseCollection(r,u)}else if(r.type){if(r.type.toLowerCase()==="manifest")return this.parseManifest(r,u);if(r.type.toLowerCase()==="collection")return this.parseCollection(r,u)}return null},c.parseItems=function(r,u){var s=r.__jsonld.members||r.__jsonld.items;if(s)for(var e=function(a){u&&(u.index=a);var d=t.parseItem(s[a],u);return d?r.items.filter(function(E){return E.id===d.id})[0]?"continue":(d.index=a,d.parentCollection=r,void r.items.push(d)):{value:void 0}},t=this,i=0;i<s.length;i++){var n=e(i);if(typeof n=="object")return n.value}},c}();p.Deserialiser=h},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(u,s){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(u,s)},function(u,s){function e(){this.constructor=u}o(u,s),u.prototype=s===null?Object.create(s):(e.prototype=s.prototype,new e)});Object.defineProperty(p,"__esModule",{value:!0});var c=g(0),r=function(u){function s(e,t){return u.call(this,e,t)||this}return h(s,u),s.prototype.getProfile=function(){var e=this.getProperty("profile");return e||(e=this.getProperty("dcterms:conformsTo")),Array.isArray(e)?e[0]:e},s.prototype.getConfirmLabel=function(){return c.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},s.prototype.getDescription=function(){return c.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},s.prototype.getFailureDescription=function(){return c.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},s.prototype.getFailureHeader=function(){return c.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},s.prototype.getHeader=function(){return c.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},s.prototype.getServiceLabel=function(){return c.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},s.prototype.getInfoUri=function(){var e=this.id;return e.endsWith("/")||(e+="/"),e+"info.json"},s}(c.ManifestResource);p.Service=r},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),p.Size=function(o,h){this.width=o,this.height=h}},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),function(o){o[o.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",o[o.FORBIDDEN=2]="FORBIDDEN",o[o.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",o[o.RESTRICTED=4]="RESTRICTED"}(p.StatusCode||(p.StatusCode={}))},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=g(0);p.Thumb=function(h,c){this.data=c,this.index=c.index,this.width=h;var r=c.getHeight()/c.getWidth();this.height=r?Math.floor(this.width*r):h,this.uri=c.getCanonicalImageUri(h),this.label=o.LanguageMap.getValue(c.getLabel())}},function(v,p,g){"use strict";var o,h=this&&this.__extends||(o=function(r,u){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,e){s.__proto__=e}||function(s,e){for(var t in e)e.hasOwnProperty(t)&&(s[t]=e[t])})(r,u)},function(r,u){function s(){this.constructor=r}o(r,u),r.prototype=u===null?Object.create(u):(s.prototype=u.prototype,new s)});Object.defineProperty(p,"__esModule",{value:!0});var c=function(r){function u(s,e){return r.call(this,s,e)||this}return h(u,r),u}(g(0).Resource);p.Thumbnail=c},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var o=g(0),h=function(){function c(r,u){this.label=r,this.data=u||{},this.nodes=[]}return c.prototype.addNode=function(r){this.nodes.push(r),r.parentNode=this},c.prototype.isCollection=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.COLLECTION)},c.prototype.isManifest=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.MANIFEST)},c.prototype.isRange=function(){return this.data.type===o.Utils.normaliseType(o.TreeNodeType.RANGE)},c}();p.TreeNode=h},function(v,p,g){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),function(o){o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range"}(p.TreeNodeType||(p.TreeNodeType={}))},function(v,p,g){v.exports=function(o){var h={};function c(r){if(h[r])return h[r].exports;var u=h[r]={i:r,l:!1,exports:{}};return o[r].call(u.exports,u,u.exports,c),u.l=!0,u.exports}return c.m=o,c.c=h,c.d=function(r,u,s){c.o(r,u)||Object.defineProperty(r,u,{enumerable:!0,get:s})},c.r=function(r){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},c.t=function(r,u){if(1&u&&(r=c(r)),8&u||4&u&&typeof r=="object"&&r&&r.__esModule)return r;var s=Object.create(null);if(c.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&u&&typeof r!="string")for(var e in r)c.d(s,e,function(t){return r[t]}.bind(null,e));return s},c.n=function(r){var u=r&&r.__esModule?function(){return r.default}:function(){return r};return c.d(u,"a",u),u},c.o=function(r,u){return Object.prototype.hasOwnProperty.call(r,u)},c.p="",c(c.s=0)}([function(o,h,c){o.exports=c(1)},function(o,h,c){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.CONTINUE=100,h.SWITCHING_PROTOCOLS=101,h.PROCESSING=102,h.OK=200,h.CREATED=201,h.ACCEPTED=202,h.NON_AUTHORITATIVE_INFORMATION=203,h.NO_CONTENT=204,h.RESET_CONTENT=205,h.PARTIAL_CONTENT=206,h.MULTI_STATUS=207,h.MULTIPLE_CHOICES=300,h.MOVED_PERMANENTLY=301,h.MOVED_TEMPORARILY=302,h.SEE_OTHER=303,h.NOT_MODIFIED=304,h.USE_PROXY=305,h.TEMPORARY_REDIRECT=307,h.BAD_REQUEST=400,h.UNAUTHORIZED=401,h.PAYMENT_REQUIRED=402,h.FORBIDDEN=403,h.NOT_FOUND=404,h.METHOD_NOT_ALLOWED=405,h.NOT_ACCEPTABLE=406,h.PROXY_AUTHENTICATION_REQUIRED=407,h.REQUEST_TIME_OUT=408,h.CONFLICT=409,h.GONE=410,h.LENGTH_REQUIRED=411,h.PRECONDITION_FAILED=412,h.REQUEST_ENTITY_TOO_LARGE=413,h.REQUEST_URI_TOO_LARGE=414,h.UNSUPPORTED_MEDIA_TYPE=415,h.REQUESTED_RANGE_NOT_SATISFIABLE=416,h.EXPECTATION_FAILED=417,h.IM_A_TEAPOT=418,h.UNPROCESSABLE_ENTITY=422,h.LOCKED=423,h.FAILED_DEPENDENCY=424,h.UNORDERED_COLLECTION=425,h.UPGRADE_REQUIRED=426,h.PRECONDITION_REQUIRED=428,h.TOO_MANY_REQUESTS=429,h.REQUEST_HEADER_FIELDS_TOO_LARGE=431,h.INTERNAL_SERVER_ERROR=500,h.NOT_IMPLEMENTED=501,h.BAD_GATEWAY=502,h.SERVICE_UNAVAILABLE=503,h.GATEWAY_TIME_OUT=504,h.HTTP_VERSION_NOT_SUPPORTED=505,h.VARIANT_ALSO_NEGOTIATES=506,h.INSUFFICIENT_STORAGE=507,h.BANDWIDTH_LIMIT_EXCEEDED=509,h.NOT_EXTENDED=510,h.NETWORK_AUTHENTICATION_REQUIRED=511}])},function(v,p,g){v.exports=window.fetch||(window.fetch=g(3).default||g(3))}])},function(P,f,O){"use strict";O.r(f),O.d(f,"BaseComponent",function(){return v});var v=function(){function p(g){this.options=g,this.options.data=Object.assign({},this.data(),g.data)}return p.prototype._init=function(){return this.el=this.options.target,this.el?(this.el.innerHTML="",!0):(console.warn("element not found"),!1)},p.prototype.data=function(){return{}},p.prototype.on=function(g,o,h){var c=this._e||(this._e={});(c[g]||(c[g]=[])).push({fn:o,ctx:h})},p.prototype.fire=function(g){for(var o=[],h=1;h<arguments.length;h++)o[h-1]=arguments[h];for(var c=[].slice.call(arguments,1),r=((this._e||(this._e={}))[g]||[]).slice(),u=0,s=r.length;u<s;u++)r[u].fn.apply(r[u].ctx,c)},p.prototype._resize=function(){},p.prototype.set=function(g){},p}()},function(P,f,O){"use strict";O.r(f),O.d(f,"Async",function(){return p}),O.d(f,"Bools",function(){return g}),O.d(f,"Clipboard",function(){return o}),O.d(f,"Colors",function(){return h}),O.d(f,"Dates",function(){return c}),O.d(f,"Device",function(){return r}),O.d(f,"Documents",function(){return u}),O.d(f,"Events",function(){return s}),O.d(f,"Files",function(){return e}),O.d(f,"Keyboard",function(){return t}),O.d(f,"Maths",function(){return i}),O.d(f,"Size",function(){return n}),O.d(f,"Dimensions",function(){return a}),O.d(f,"Numbers",function(){return d}),O.d(f,"Objects",function(){return E}),O.d(f,"Storage",function(){return I}),O.d(f,"StorageItem",function(){return A}),O.d(f,"StorageType",function(){return v}),O.d(f,"Strings",function(){return L}),O.d(f,"Urls",function(){return b});var v,p=function(){function m(){}return m.waitFor=function(l,_,y,T,S,M){T||(T=200),S||(S=100),M||(M=0),(M+=1)>S?y&&y():l()?_():setTimeout(function(){m.waitFor(l,_,y,T,S,M)},T)},m}(),g=function(){function m(){}return m.getBool=function(l,_){return l??_},m}(),o=function(){function m(){}return m.supportsCopy=function(){return document.queryCommandSupported&&document.queryCommandSupported("copy")},m.copy=function(l){l=m.convertBrToNewLine(l);var _=document.createElement("textarea");_.value=l,m.hideButKeepEnabled(_),document.body.appendChild(_),_.focus(),_.select(),document.execCommand("copy"),document.body.removeChild(_)},m.hideButKeepEnabled=function(l){l.style.position="fixed",l.style.top="0",l.style.left="0",l.style.width="2em",l.style.height="2em",l.style.padding="0",l.style.border="none",l.style.outline="none",l.style.boxShadow="none",l.style.background="transparent"},m.convertBrToNewLine=function(l){return l=l.replace(/<br\s*[\/]?>/gi,`
`)},m}(),h=function(){function m(){}return m.float32ColorToARGB=function(l){return[(4278190080&l)>>>24,(16711680&l)>>>16,(65280&l)>>>8,255&l]},m._componentToHex=function(l){var _=l.toString(16);return _.length==1?"0"+_:_},m.rgbToHexString=function(l){return m.coalesce(l),"#"+m._componentToHex(l[0])+m._componentToHex(l[1])+m._componentToHex(l[2])},m.argbToHexString=function(l){return"#"+m._componentToHex(l[0])+m._componentToHex(l[1])+m._componentToHex(l[2])+m._componentToHex(l[3])},m.coalesce=function(l){for(var _=1;_<l.length;_++)l[_]===void 0&&(l[_]=l[_-1])},m}(),c=function(){function m(){}return m.getTimeStamp=function(){return new Date().getTime()},m}(),r=function(){function m(){}return m.getPixelRatio=function(l){return(window.devicePixelRatio||1)/(l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1)},m.isTouch=function(){return"ontouchstart"in window||window.navigator.msMaxTouchPoints>0},m}(),u=function(){function m(){}return m.isInIFrame=function(){try{return window.self!==window.top}catch{return!0}},m.supportsFullscreen=function(){var l=document.documentElement;return(l.requestFullscreen||l.mozRequestFullScreen||l.webkitRequestFullScreen||l.msRequestFullscreen)!==void 0},m.isHidden=function(){return!!m.getHiddenProp()},m.getHiddenProp=function(){var l=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var _=0;_<l.length;_++)if(l[_]+"Hidden"in document)return l[_]+"Hidden";return null},m}(),s=function(){function m(){}return m.debounce=function(l,_){return _=_||100,function(){if(!l.debouncing){var y=Array.prototype.slice.apply(arguments);l.lastReturnVal=l.apply(window,y),l.debouncing=!0}return clearTimeout(l.debounceTimeout),l.debounceTimeout=setTimeout(function(){l.debouncing=!1},_),l.lastReturnVal}},m}(),e=function(){function m(){}return m.simplifyMimeType=function(l){switch(l){case"text/plain":return"txt";case"image/jpeg":return"jpg";case"application/msword":return"doc";case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return"docx";default:var _=l.split("/");return _[_.length-1]}},m}(),t=function(){function m(){}return m.getCharCode=function(l){return typeof l.which=="number"?l.which:l.keyCode},m}(),i=function(){function m(){}return m.normalise=function(l,_,y){return(l-_)/(y-_)},m.median=function(l){l.sort(function(y,T){return y-T});var _=Math.floor(l.length/2);return l.length%2?l[_]:(l[_-1]+l[_])/2},m.clamp=function(l,_,y){return Math.min(Math.max(l,_),y)},m}(),n=function(m,l){this.width=m,this.height=l},a=function(){function m(){}return m.fitRect=function(l,_,y,T){var S,M=0,W=0;return _/l<T/y?(M=l*(S=y/l),W=_*S):(M=l*(S=T/_),W=_*S),new n(Math.floor(M),Math.floor(W))},m.hitRect=function(l,_,y,T,S,M){return S>l&&S<l+y&&M>_&&M<_+T},m}(),d=function(){function m(){}return m.numericalInput=function(l){return l.keyCode==46||l.keyCode==8||l.keyCode==9||l.keyCode==27||l.keyCode==65&&l.ctrlKey===!0||l.keyCode>=35&&l.keyCode<=39||!(l.shiftKey||(l.keyCode<48||l.keyCode>57)&&(l.keyCode<96||l.keyCode>105))||(l.preventDefault(),!1)},m}(),E=function(){function m(){}return m.toPlainObject=function(l){l=Object(l);var _={};for(var y in l)_[y]=l[y];return _},m}(),I=function(){function m(){}return m.clear=function(l){switch(l===void 0&&(l=v.MEMORY),l){case v.MEMORY:this._memoryStorage={};break;case v.SESSION:sessionStorage.clear();break;case v.LOCAL:localStorage.clear()}},m.clearExpired=function(l){l===void 0&&(l=v.MEMORY);for(var _=this.getItems(l),y=0;y<_.length;y++){var T=_[y];this._isExpired(T)&&this.remove(T.key)}},m.get=function(l,_){_===void 0&&(_=v.MEMORY);var y=null;switch(_){case v.MEMORY:y=this._memoryStorage[l];break;case v.SESSION:y=sessionStorage.getItem(l);break;case v.LOCAL:y=localStorage.getItem(l)}if(!y)return null;var T=null;try{T=JSON.parse(y)}catch{return null}return T?this._isExpired(T)?null:(T.key=l,T):null},m._isExpired=function(l){return!(new Date().getTime()<l.expiresAt)},m.getItems=function(l){l===void 0&&(l=v.MEMORY);var _=[];switch(l){case v.MEMORY:for(var y=Object.keys(this._memoryStorage),T=0;T<y.length;T++)(M=this.get(y[T],v.MEMORY))&&_.push(M);break;case v.SESSION:for(T=0;T<sessionStorage.length;T++)(S=sessionStorage.key(T))&&(M=this.get(S,v.SESSION))&&_.push(M);break;case v.LOCAL:for(T=0;T<localStorage.length;T++){var S,M;(S=localStorage.key(T))&&(M=this.get(S,v.LOCAL))&&_.push(M)}}return _},m.remove=function(l,_){switch(_===void 0&&(_=v.MEMORY),_){case v.MEMORY:delete this._memoryStorage[l];break;case v.SESSION:sessionStorage.removeItem(l);break;case v.LOCAL:localStorage.removeItem(l)}},m.set=function(l,_,y,T){T===void 0&&(T=v.MEMORY);var S=1e3*y,M=new A;switch(M.value=_,M.expiresAt=new Date().getTime()+S,T){case v.MEMORY:this._memoryStorage[l]=JSON.stringify(M);break;case v.SESSION:sessionStorage.setItem(l,JSON.stringify(M));break;case v.LOCAL:localStorage.setItem(l,JSON.stringify(M))}return M},m._memoryStorage={},m}(),A=function(){};(function(m){m.MEMORY="memory",m.SESSION="session",m.LOCAL="local"})(v||(v={}));var L=function(){function m(){}return m.ellipsis=function(l,_){if(l.length<=_)return l;var y=l.substr(0,_),T=y.lastIndexOf(" ");return T!=-1&&(y=y.substr(0,Math.min(y.length,T))),y+"&hellip;"},m.htmlDecode=function(l){var _=document.createElement("div");return _.innerHTML=l,_.firstChild.nodeValue},m.format=function(l){for(var _=[],y=1;y<arguments.length;y++)_[y-1]=arguments[y];for(var T=0;T<_.length;T++){var S=new RegExp("\\{"+T+"\\}","gm");l=l.replace(S,_[T])}return l},m.isAlphanumeric=function(l){return/^[a-zA-Z0-9]*$/.test(l)},m.toCssClass=function(l){return l.replace(/[^a-z0-9]/g,function(_){var y=_.charCodeAt(0);return y==32?"-":y>=65&&y<=90?"_"+_.toLowerCase():"__"+("000"+y.toString(16)).slice(-4)})},m.toFileName=function(l){return l.replace(/[^a-z0-9]/gi,"_").toLowerCase()},m.utf8_to_b64=function(l){return window.btoa(unescape(encodeURIComponent(l)))},m}(),b=function(){function m(){}return m.getHashParameter=function(l,_){return _||(_=window.document),_&&_.location?this.getHashParameterFromString(l,_.location.hash):null},m.getHashParameterFromString=function(l,_){var y=new RegExp("#.*[?&]"+l+"=([^&]+)(&|$)").exec(_);return y?decodeURIComponent(y[1].replace(/\+/g," ")):null},m.setHashParameter=function(l,_,y){if(y||(y=window.document),y&&y.location){var T="#?"+this.updateURIKeyValuePair(y.location.hash.replace("#?",""),l,_),S=y.URL;S.indexOf("#")!=-1&&(S=S.substr(0,S.indexOf("#"))),y.location.replace(S+T)}},m.getQuerystringParameter=function(l,_){return _||(_=window),this.getQuerystringParameterFromString(l,_.location.search)},m.getQuerystringParameterFromString=function(l,_){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var y=new RegExp("[\\?&]"+l+"=([^&#]*)").exec(_);return y?decodeURIComponent(y[1].replace(/\+/g," ")):null},m.setQuerystringParameter=function(l,_,y){if(y||(y=window.document),y&&y.location){var T=this.updateURIKeyValuePair(y.location.hash.replace("#?",""),l,_);window.location.search=T}},m.updateURIKeyValuePair=function(l,_,y){_=encodeURIComponent(_),y=encodeURIComponent(y);var T=l.split("&");T[0]==""&&T.shift();for(var S,M=T.length;M--;)if((S=T[M].split("="))[0]==_){S[1]=y,T[M]=S.join("=");break}return M<0&&(T[T.length]=[_,y].join("=")),T.join("&")},m.getUrlParts=function(l){var _=document.createElement("a");return _.href=l,_},m.convertToRelativeUrl=function(l){var _=this.getUrlParts(l),y=_.pathname+_.searchWithin;return y.startsWith("/")||(y="/"+y),y},m}()}])})});var R=V(),st=class extends F{constructor(f){super(f)}create(){this.setConfig("footerPanel"),super.create(),this.component.subscribe(C.TOGGLE_FULLSCREEN,()=>{this.updateFullScreenButton(),this.component.isFullScreen||setTimeout(()=>{this.resize()},1001)}),this.component.subscribe(C.METRIC_CHANGE,()=>{this.updateMinimisedButtons(),this.updateMoreInfoButton()}),this.component.subscribe(C.SETTINGS_CHANGE,()=>{this.updateDownloadButton()}),this.$options=R('<div class="options"></div>'),this.$element.append(this.$options),this.$feedbackButton=R(`
          <button class="feedback btn imageBtn" title="${this.content.feedback}">
            <i class="uv-icon uv-icon-feedback" aria-hidden="true"></i>
            <span class="sr-only">${this.content.feedback}</span>
          </button>
        `),this.$options.prepend(this.$feedbackButton),this.$openButton=R(`
          <button class="open btn imageBtn" title="${this.content.open}">
            <i class="uv-icon-open" aria-hidden="true"></i>
            <span class="sr-only">${this.content.open}</span>
          </button>
        `),this.$options.prepend(this.$openButton),this.$bookmarkButton=R(`
          <button class="bookmark btn imageBtn" title="${this.content.bookmark}">
            <i class="uv-icon uv-icon-bookmark" aria-hidden="true"></i>
            <span class="sr-only">${this.content.bookmark}</span>
          </button>
        `),this.$options.prepend(this.$bookmarkButton),this.$shareButton=R(`
          <button class="share btn imageBtn" title="${this.content.share}">
            <i class="uv-icon uv-icon-share" aria-hidden="true"></i>
            <span class="sr-only">${this.content.share}</span>
          </button>
        `),this.$options.append(this.$shareButton),this.$embedButton=R(`
          <button class="embed btn imageBtn" title="${this.content.embed}">
            <i class="uv-icon uv-icon-embed" aria-hidden="true"></i>
            <span class="sr-only">${this.content.embed}</span>
          </button>
        `),this.$options.append(this.$embedButton),this.$downloadButton=R(`
          <button class="download btn imageBtn" title="${this.content.download}" id="download-btn">
            <i class="uv-icon uv-icon-download" aria-hidden="true"></i>
            <span class="sr-only">${this.content.download}</span>
          </button>
        `),this.$options.prepend(this.$downloadButton),this.$moreInfoButton=R(`
          <button class="moreInfo btn imageBtn" title="${this.content.moreInfo}">
            <i class="uv-icon uv-icon-more-info" aria-hidden="true"></i>
            <span class="sr-only">${this.content.moreInfo}</span>
          </button>
        `),this.$options.prepend(this.$moreInfoButton),this.$fullScreenBtn=R(`
          <button class="fullScreen btn imageBtn" title="${this.content.fullScreen}">
            <i class="uv-icon uv-icon-fullscreen" aria-hidden="true"></i>
            <span class="sr-only">${this.content.fullScreen}</span>
          </button>
        `),this.$options.append(this.$fullScreenBtn),this.$openButton.onPressed(()=>{this.component.publish(C.OPEN)}),this.$feedbackButton.onPressed(()=>{this.component.publish(C.FEEDBACK)}),this.$bookmarkButton.onPressed(()=>{this.component.publish(C.BOOKMARK)}),this.$shareButton.onPressed(()=>{this.component.publish(C.SHOW_SHARE_DIALOGUE,this.$shareButton)}),this.$embedButton.onPressed(()=>{this.component.publish(C.SHOW_EMBED_DIALOGUE,this.$embedButton)}),this.$downloadButton.onPressed(()=>{this.component.publish(C.SHOW_DOWNLOAD_DIALOGUE,this.$downloadButton)}),this.$moreInfoButton.onPressed(()=>{this.component.publish(C.SHOW_MOREINFO_DIALOGUE,this.$moreInfoButton)}),this.onAccessibleClick(this.$fullScreenBtn,f=>{f.preventDefault(),this.component.publish(C.TOGGLE_FULLSCREEN)},!0),x.getBool(this.options.embedEnabled,!0)||this.$embedButton.hide(),this.updateMoreInfoButton(),this.updateOpenButton(),this.updateFeedbackButton(),this.updateBookmarkButton(),this.updateEmbedButton(),this.updateDownloadButton(),this.updateFullScreenButton(),this.updateShareButton(),this.updateMinimisedButtons()}updateMinimisedButtons(){if(x.getBool(this.options.minimiseButtons,!1)){this.$options.addClass("minimiseButtons");return}this.extension.isDesktopMetric()?this.$options.removeClass("minimiseButtons"):this.$options.addClass("minimiseButtons")}updateMoreInfoButton(){}updateOpenButton(){x.getBool(this.options.openEnabled,!1)&&Q.isInIFrame()?this.$openButton.show():this.$openButton.hide()}updateFullScreenButton(){if(!x.getBool(this.options.fullscreenEnabled,!0)||!Q.supportsFullscreen()){this.$fullScreenBtn.hide();return}this.extension.isFullScreen()?(this.$fullScreenBtn.switchClass("fullScreen","exitFullscreen"),this.$fullScreenBtn.find("i").switchClass("uv-icon-fullscreen","uv-icon-exit-fullscreen"),this.$fullScreenBtn.attr("title",this.content.exitFullScreen),R(this.$fullScreenBtn[0].firstChild.nextSibling.nextSibling).replaceWith(this.content.exitFullScreen)):(this.$fullScreenBtn.switchClass("exitFullscreen","fullScreen"),this.$fullScreenBtn.find("i").switchClass("uv-icon-exit-fullscreen","uv-icon-fullscreen"),this.$fullScreenBtn.attr("title",this.content.fullScreen),R(this.$fullScreenBtn[0].firstChild.nextSibling.nextSibling).replaceWith(this.content.fullScreen))}updateEmbedButton(){this.extension.helper.isUIEnabled("embed")&&x.getBool(this.options.embedEnabled,!1)?this.extension.isMobile()||this.$embedButton.show():this.$embedButton.hide()}updateShareButton(){this.extension.helper.isUIEnabled("share")&&x.getBool(this.options.shareEnabled,!0)?this.$shareButton.show():this.$shareButton.hide()}updateDownloadButton(){x.getBool(this.options.downloadEnabled,!0)?this.$downloadButton.show():this.$downloadButton.hide()}updateFeedbackButton(){x.getBool(this.options.feedbackEnabled,!1)?this.$feedbackButton.show():this.$feedbackButton.hide()}updateBookmarkButton(){x.getBool(this.options.bookmarkEnabled,!1)?this.$bookmarkButton.show():this.$bookmarkButton.hide()}resize(){super.resize()}};var H=class{constructor(f,O){this.message=f;this.actions=O}};var q=class{constructor(){}};var K=class{constructor(f){this.extension=f}Get(f){switch(f.informationType){case J.AUTH_CORS_ERROR:return new H(this.extension.data.config.content.authCORSError,[]);case J.DEGRADED_RESOURCE:let O=[],v=new q,p=f.param.loginService.getConfirmLabel();p||(p=this.extension.data.config.content.fallbackDegradedLabel),v.label=p;let g=f.param;v.action=()=>{g.authHoldingPage=window.open("","_blank"),this.extension.component.publish(C.HIDE_INFORMATION),this.extension.component.publish(C.OPEN_EXTERNAL_RESOURCE,[[g]])},O.push(v);let o=f.param.loginService.getServiceLabel();return o||(o=this.extension.data.config.content.fallbackDegradedMessage),new H(o,O)}}};var D=V(),at=class extends F{constructor(f){super(f,!1,!1)}create(){this.setConfig("headerPanel"),super.create(),this.component.subscribe(C.SHOW_INFORMATION,f=>{this.showInformation(f)}),this.component.subscribe(C.HIDE_INFORMATION,()=>{this.hideInformation()}),this.$options=D('<div class="options"></div>'),this.$element.append(this.$options),this.$centerOptions=D('<div class="centerOptions"></div>'),this.$options.append(this.$centerOptions),this.$rightOptions=D('<div class="rightOptions"></div>'),this.$options.append(this.$rightOptions),this.$localeToggleButton=D('<a class="localeToggle" tabindex="0"></a>'),this.$rightOptions.append(this.$localeToggleButton),this.$settingsButton=D(`
          <button class="btn imageBtn settings" tabindex="0" title="${this.content.settings}">
            <i class="uv-icon-settings" aria-hidden="true"></i>
          </button>
        `),this.$settingsButton.attr("title",this.content.settings),this.$rightOptions.append(this.$settingsButton),this.$informationBox=D('<div class="informationBox" aria-hidden="true">                                     <div class="message"></div>                                     <div class="actions"></div>                                     <button type="button" class="close" aria-label="Close">                                         <span aria-hidden="true">&#215;</span>                                    </button>                                   </div>'),this.$element.append(this.$informationBox),this.$informationBox.hide(),this.$informationBox.find(".close").attr("title",this.content.close),this.$informationBox.find(".close").on("click",f=>{f.preventDefault(),this.component.publish(C.HIDE_INFORMATION)}),this.$localeToggleButton.on("click",()=>{this.extension.changeLocale(String(this.$localeToggleButton.data("locale")))}),this.$settingsButton.onPressed(()=>{this.component.publish(C.SHOW_SETTINGS_DIALOGUE,this.$settingsButton)}),x.getBool(this.options.centerOptionsEnabled,!0)||this.$centerOptions.hide(),this.updateLocaleToggle(),this.updateSettingsButton()}updateLocaleToggle(){if(!this.localeToggleIsVisible()){this.$localeToggleButton.hide();return}let f=this.extension.getAlternateLocale(),O=f.name.split("-")[0].toUpperCase();this.$localeToggleButton.data("locale",f.name),this.$localeToggleButton.attr("title",f.label),this.$localeToggleButton.text(O)}updateSettingsButton(){x.getBool(this.options.settingsButtonEnabled,!0)?this.$settingsButton.show():this.$settingsButton.hide()}localeToggleIsVisible(){let f=this.extension.data.locales;return f?f.length>1&&x.getBool(this.options.localeToggleEnabled,!1):!1}showInformation(f){let O=new K(this.extension);this.information=O.Get(f);var v=this.$informationBox.find(".message");v.html(this.information.message).find("a").attr("target","_top");var p=this.$informationBox.find(".actions");p.empty();for(let g=0;g<this.information.actions.length;g++){let o=this.information.actions[g],h=D('<a href="#" class="btn btn-default">'+o.label+"</a>");h.on("click",o.action),p.append(h)}this.$informationBox.attr("aria-hidden","false"),this.$informationBox.show(),this.$element.addClass("showInformation"),this.extension.resize()}hideInformation(){this.$element.removeClass("showInformation"),this.$informationBox.attr("aria-hidden","true"),this.$informationBox.hide(),this.extension.resize()}getSettings(){return this.extension.getSettings()}updateSettings(f){this.extension.updateSettings(f),this.component.publish(C.UPDATE_SETTINGS,f)}resize(){super.resize();let O=this.$element.width()/2,v=this.$centerOptions.outerWidth(),p=O-v/2;if(this.$centerOptions.css({left:p}),it(this.$informationBox)){let g=this.$informationBox.find(".actions"),o=this.$informationBox.find(".message");o.width(Math.floor(this.$element.width())-Math.ceil(o.horizontalMargins())-Math.ceil(g.outerWidth(!0))-Math.ceil(this.$informationBox.find(".close").outerWidth(!0))-2),this.information&&o.text(this.information.message)}this.extension.width()<this.extension.data.config.options.minWidthBreakPoint?this.localeToggleIsVisible()&&this.$localeToggleButton.hide():this.localeToggleIsVisible()&&this.$localeToggleButton.show()}};var B=V(),U=class extends F{constructor(f){super(f,!1,!0);this.isExpanded=!1;this.isFullyExpanded=!1;this.isUnopened=!0;this.autoToggled=!1;this.expandFullEnabled=!0;this.reducedAnimation=!1}create(){super.create(),this.$top=B('<div class="top"></div>'),this.$element.append(this.$top),this.$title=B('<h2 class="title"></h2>'),this.$top.append(this.$title),this.$expandFullButton=B('<a class="expandFullButton" tabindex="0"></a>'),this.$top.append(this.$expandFullButton),x.getBool(this.config.options.expandFullEnabled,!0)||this.$expandFullButton.hide(),this.$collapseButton=B('<div role="button" class="collapseButton" tabindex="0"></div>'),this.$collapseButton.prop("title",this.content.collapse),this.$top.append(this.$collapseButton),this.$closed=B('<div class="closed"></div>'),this.$element.append(this.$closed),this.$expandButton=B('<a role="button" class="expandButton" tabindex="0"></a>'),this.$expandButton.prop("title",this.content.expand),this.$closed.append(this.$expandButton),this.$closedTitle=B('<a class="title"></a>'),this.$closed.append(this.$closedTitle),this.$main=B('<div class="main"></div>'),this.$element.append(this.$main),this.onAccessibleClick(this.$expandButton,()=>{this.toggle()}),this.$expandFullButton.on("click",()=>{this.expandFull()}),this.$closedTitle.on("click",()=>{this.toggle()}),this.$title.on("click",()=>{this.isFullyExpanded?this.collapseFull():this.toggle()}),this.onAccessibleClick(this.$collapseButton,()=>{this.isFullyExpanded?this.collapseFull():this.toggle()}),this.$top.hide(),this.$main.hide(),this.component.subscribe(C.SETTINGS_CHANGE,f=>{this.reducedAnimation=f.reducedAnimation||!1})}init(){super.init()}setTitle(f){this.$title.text(f),this.$closedTitle.text(f)}toggle(f){f?this.autoToggled=!0:this.autoToggled=!1,this.isExpanded&&(this.$top.attr("aria-hidden","true"),this.$main.attr("aria-hidden","true"),this.$closed.attr("aria-hidden","false"),this.$top.hide(),this.$main.hide(),this.$closed.show()),this.reducedAnimation?(this.$element.css("width",this.getTargetWidth()),this.$element.css("left",this.getTargetLeft()),this.toggled()):this.$element.stop().animate({width:this.getTargetWidth(),left:this.getTargetLeft()},this.options.panelAnimationDuration,()=>{this.toggled()})}toggled(){this.toggleStart(),this.isExpanded=!this.isExpanded,this.isExpanded&&(this.$top.attr("aria-hidden","false"),this.$main.attr("aria-hidden","false"),this.$closed.attr("aria-hidden","true"),this.$closed.hide(),this.$top.show(),this.$main.show()),this.toggleFinish(),this.isUnopened=!1}expandFull(){this.isExpanded||this.toggled();var f=this.getFullTargetWidth(),O=this.getFullTargetLeft();this.expandFullStart(),this.$element.stop().animate({width:f,left:O},this.options.panelAnimationDuration,()=>{this.expandFullFinish()})}collapseFull(){var f=this.getTargetWidth(),O=this.getTargetLeft();this.collapseFullStart(),this.$element.stop().animate({width:f,left:O},this.options.panelAnimationDuration,()=>{this.collapseFullFinish()})}getTargetWidth(){return 0}getTargetLeft(){return 0}getFullTargetWidth(){return 0}getFullTargetLeft(){return 0}toggleStart(){}toggleFinish(){this.isExpanded&&!this.autoToggled?this.focusCollapseButton():this.focusExpandButton()}expandFullStart(){}expandFullFinish(){this.isFullyExpanded=!0,this.$expandFullButton.hide(),this.focusCollapseButton()}collapseFullStart(){}collapseFullFinish(){this.isFullyExpanded=!1,this.expandFullEnabled&&this.$expandFullButton.show(),this.focusExpandFullButton()}focusExpandButton(){setTimeout(()=>{this.$expandButton.focus()},1)}focusExpandFullButton(){setTimeout(()=>{this.$expandFullButton.focus()},1)}focusCollapseButton(){setTimeout(()=>{this.$collapseButton.focus()},1)}resize(){super.resize(),this.$main.height(this.$element.parent().height()-this.$top.outerHeight(!0))}};var Y=class extends U{constructor(f){super(f)}create(){super.create(),this.$element.width(this.options.panelCollapsedWidth)}init(){super.init(),x.getBool(this.extension.getSettings().rightPanelOpen,this.options.panelOpen)&&this.toggle(!0),this.component.subscribe(C.TOGGLE_EXPAND_RIGHT_PANEL,()=>{this.isFullyExpanded?this.collapseFull():this.expandFull()})}getTargetWidth(){return this.isExpanded?this.options.panelCollapsedWidth:this.options.panelExpandedWidth}getTargetLeft(){return this.isExpanded?this.$element.parent().width()-this.options.panelCollapsedWidth:this.$element.parent().width()-this.options.panelExpandedWidth}toggleFinish(){super.toggleFinish(),this.isExpanded?this.component.publish(C.OPEN_RIGHT_PANEL):this.component.publish(C.CLOSE_RIGHT_PANEL),this.extension.updateSettings({rightPanelOpen:this.isExpanded})}resize(){super.resize(),this.$element.css({left:Math.floor(this.$element.parent().width()-this.$element.outerWidth())})}};var k=rt(nt()),lt=V(),ut=class extends Y{constructor(f){super(f)}create(){this.setConfig("moreInfoRightPanel"),super.create(),this.component.subscribe(C.CANVAS_INDEX_CHANGE,()=>{this.databind()}),this.component.subscribe(C.RANGE_CHANGE,()=>{this.databind()}),this.setTitle(this.config.content.title),this.$metadata=lt('<div class="iiif-metadata-component"></div>'),this.$main.append(this.$metadata),this.metadataComponent=new k.MetadataComponent({target:this.$metadata[0],data:this._getData()}),this.metadataComponent.on("iiifViewerLinkClicked",f=>{let O=Z.getHashParameterFromString("rid",f);if(O){let v=this.extension.helper.getRangeById(O);v&&this.component.publish(C.RANGE_CHANGE,v)}},!1)}toggleFinish(){super.toggleFinish(),this.databind()}databind(){this.metadataComponent.set(this._getData())}_getCurrentRange(){return this.extension.helper.getCurrentRange()}_getData(){return{canvasDisplayOrder:this.config.options.canvasDisplayOrder,canvases:this.extension.getCurrentCanvases(),canvasExclude:this.config.options.canvasExclude,canvasLabels:this.extension.getCanvasLabels(this.content.page),content:this.config.content,copiedMessageDuration:2e3,copyToClipboardEnabled:x.getBool(this.config.options.copyToClipboardEnabled,!1),helper:this.extension.helper,licenseFormatter:new tt(this.config.license?this.config.license:{}),limit:this.config.options.textLimit||4,limitType:k.LimitType.LINES,limitToRange:x.getBool(this.config.options.limitToRange,!1),manifestDisplayOrder:this.config.options.manifestDisplayOrder,manifestExclude:this.config.options.manifestExclude,range:this._getCurrentRange(),rtlLanguageCodes:this.config.options.rtlLanguageCodes,sanitizer:f=>et(f),showAllLanguages:this.config.options.showAllLanguages}}resize(){super.resize(),this.$main.height(this.$element.height()-this.$top.height()-this.$main.verticalMargins())}};var ct=class extends U{constructor(f){super(f)}create(){super.create(),this.$element.width(this.options.panelCollapsedWidth),this.component.subscribe(C.TOGGLE_EXPAND_LEFT_PANEL,()=>{this.isFullyExpanded?this.collapseFull():this.expandFull()})}init(){super.init(),x.getBool(this.extension.getSettings().leftPanelOpen,this.options.panelOpen)&&this.toggle(!0)}getTargetWidth(){return this.isFullyExpanded||!this.isExpanded?this.options.panelExpandedWidth:this.options.panelCollapsedWidth}getFullTargetWidth(){return this.$element.parent().width()}toggleFinish(){super.toggleFinish(),this.isExpanded?this.component.publish(C.OPEN_LEFT_PANEL):this.component.publish(C.CLOSE_LEFT_PANEL),this.extension.updateSettings({leftPanelOpen:this.isExpanded})}resize(){super.resize(),this.isFullyExpanded&&this.$element.width(this.$element.parent().width())}};var N=V(),ht=class extends j{constructor(f){super(f)}create(){this.setConfig("settingsDialogue"),super.create(),this.openCommand=C.SHOW_SETTINGS_DIALOGUE,this.closeCommand=C.HIDE_SETTINGS_DIALOGUE;let f;this.component.subscribe(this.openCommand,O=>{f=O,this.open()}),this.component.subscribe(this.closeCommand,()=>{f&&f.focus(),this.close()}),this.$title=N('<div role="heading" class="heading"></div>'),this.$content.append(this.$title),this.$scroll=N('<div class="scroll"></div>'),this.$content.append(this.$scroll),this.$version=N('<div class="version"></div>'),this.$content.append(this.$version),this.$website=N('<div class="website"></div>'),this.$content.append(this.$website),this.$locale=N('<div class="setting locale"></div>'),this.$scroll.append(this.$locale),this.$localeLabel=N('<label for="locale">'+this.content.locale+"</label>"),this.$locale.append(this.$localeLabel),this.$localeDropDown=N('<select id="locale"></select>'),this.$locale.append(this.$localeDropDown),this.$title.text(this.content.title),this.$website.html(this.content.website),this.$website.targetBlank(),this._createLocalesMenu(),this._createAccessibilityMenu(),this.$element.hide()}getSettings(){return this.extension.getSettings()}updateSettings(f){this.extension.updateSettings(f),this.component.publish(C.UPDATE_SETTINGS,f)}open(){super.open(),this.$version.text("v"+process.env.PACKAGE_VERSION)}_createLocalesMenu(){let f=this.extension.data.locales;if(f&&f.length>1){for(let O=0;O<f.length;O++){let v=f[O];this.$localeDropDown.append('<option value="'+v.name+'">'+v.label+"</option>")}this.$localeDropDown.val(f[0].name)}else this.$locale.hide();this.$localeDropDown.change(()=>{this.extension.changeLocale(this.$localeDropDown.val())})}resize(){super.resize()}_createAccessibilityMenu(){this.$reducedAnimation=N('<div class="setting reducedAnimation"></div>'),this.$scroll.append(this.$reducedAnimation),this.$reducedAnimationCheckbox=N('<input id="reducedAnimation" type="checkbox" tabindex="0" />'),this.$reducedAnimation.append(this.$reducedAnimationCheckbox),this.$reducedAnimationLabel=N('<label for="reducedAnimation">'+this.content.reducedMotion+"</label>"),this.$reducedAnimation.append(this.$reducedAnimationLabel),this.$reducedAnimationCheckbox.change(()=>{let f={};this.$reducedAnimationCheckbox.is(":checked")?f.reducedAnimation=!0:f.reducedAnimation=!1,this.updateSettings(f)})}};var w=V(),pt=class extends j{constructor(f){super(f);this.aspectRatio=.75;this.isEmbedViewVisible=!1;this.isShareViewVisible=!1;this.maxWidth=8e3;this.maxHeight=this.maxWidth*this.aspectRatio;this.minWidth=200;this.minHeight=this.minWidth*this.aspectRatio;this.shareManifestsEnabled=!1}create(){this.setConfig("shareDialogue"),super.create(),this.openCommand=C.SHOW_SHARE_DIALOGUE,this.closeCommand=C.HIDE_SHARE_DIALOGUE,this.shareManifestsEnabled=this.options.shareManifestsEnabled||!1;let f;this.component.subscribe(this.openCommand,v=>{f=v,this.open(v),this.isShareAvailable()?this.openShareView():this.openEmbedView()}),this.component.subscribe(this.closeCommand,()=>{f&&f.focus(),this.close()}),this.component.subscribe(C.SHOW_EMBED_DIALOGUE,v=>{this.open(v),this.openEmbedView()}),this.$tabs=w('<div class="tabs"></div>'),this.$content.append(this.$tabs),this.$shareButton=w('<a class="share tab default" tabindex="0">'+this.content.share+"</a>"),this.$tabs.append(this.$shareButton),this.$embedButton=w('<a class="embed tab" tabindex="0">'+this.content.embed+"</a>"),this.$tabs.append(this.$embedButton),this.$tabsContent=w('<div class="tabsContent"></div>'),this.$content.append(this.$tabsContent),this.$footer=w('<div class="footer"></div>'),this.$content.append(this.$footer),this.$shareView=w('<div class="shareView view"></div>'),this.$tabsContent.append(this.$shareView),this.$shareHeader=w('<div class="header"></div>'),this.$shareView.append(this.$shareHeader),this.$shareLink=w('<a class="shareLink" onclick="return false;"></a>'),this.$shareView.append(this.$shareLink),this.$shareInput=w(`<input class="shareInput" type="text" readonly="readonly" aria-label="${this.content.shareUrl}"/>`),this.$shareView.append(this.$shareInput),this.$shareFrame=w('<iframe class="shareFrame"></iframe>'),this.$shareView.append(this.$shareFrame),this.$embedView=w('<div class="embedView view"></div>'),this.$tabsContent.append(this.$embedView),this.$embedHeader=w('<div class="header"></div>'),this.$embedView.append(this.$embedHeader),this.$code=w(`<input class="code" type="text" readonly="readonly" aria-label="${this.content.embed}"/>`),this.$embedView.append(this.$code),this.$customSize=w('<div class="customSize"></div>'),this.$embedView.append(this.$customSize),this.$size=w('<span class="size">'+this.content.size+"</span>"),this.$customSize.append(this.$size),this.$customSizeDropDown=w('<select id="size" aria-label="'+this.content.size+'"></select>'),this.$customSize.append(this.$customSizeDropDown),this.$customSizeDropDown.append('<option value="small" data-width="560" data-height="420">560 x 420</option>'),this.$customSizeDropDown.append('<option value="medium" data-width="640" data-height="480">640 x 480</option>'),this.$customSizeDropDown.append('<option value="large" data-width="800" data-height="600">800 x 600</option>'),this.$customSizeDropDown.append('<option value="custom">'+this.content.customSize+"</option>"),this.$widthInput=w('<input class="width" type="text" maxlength="10" aria-label="'+this.content.width+'"/>'),this.$customSize.append(this.$widthInput),this.$x=w('<span class="x">x</span>'),this.$customSize.append(this.$x),this.$heightInput=w('<input class="height" type="text" maxlength="10" aria-label="'+this.content.height+'"/>'),this.$customSize.append(this.$heightInput);let O=this.extension.getIIIFShareUrl(this.shareManifestsEnabled);this.shareManifestsEnabled&&(this.$iiifButton=w('<a class="imageBtn iiif" href="'+O+'" title="'+this.content.iiif+'" target="_blank"></a>'),this.$footer.append(this.$iiifButton)),this.$termsOfUseButton=w('<a href="#">'+this.extension.data.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$widthInput.on("keydown",v=>z.numericalInput(v)),this.$heightInput.on("keydown",v=>z.numericalInput(v)),this.$shareInput.focus(function(){w(this).select()}),this.$code.focus(function(){w(this).select()}),this.onAccessibleClick(this.$shareButton,()=>{this.openShareView()}),this.onAccessibleClick(this.$embedButton,()=>{this.openEmbedView()}),this.$customSizeDropDown.change(()=>{this.update()}),this.$widthInput.change(()=>{this.updateHeightRatio(),this.update()}),this.$heightInput.change(()=>{this.updateWidthRatio(),this.update()}),this.onAccessibleClick(this.$termsOfUseButton,()=>{this.component.publish(C.SHOW_TERMS_OF_USE)}),this.$element.hide(),this.update()}open(f){super.open(f),this.update()}getShareUrl(){return this.extension.getShareUrl()}isShareAvailable(){return!!this.getShareUrl()}update(){this.isShareAvailable()?this.$shareButton.show():this.$shareButton.hide();let f=this.getSelectedSize();f.val()==="custom"?(this.$widthInput.show(),this.$x.show(),this.$heightInput.show()):(this.$widthInput.hide(),this.$x.hide(),this.$heightInput.hide(),this.currentWidth=Number(f.data("width")),this.currentHeight=Number(f.data("height")),this.$widthInput.val(String(this.currentWidth)),this.$heightInput.val(String(this.currentHeight))),this.updateInstructions(),this.updateShareOptions(),this.updateShareFrame(),this.updateTermsOfUseButton()}updateShareOptions(){let f=this.getShareUrl();f&&(this.$shareInput.val(f),this.$shareLink.prop("href",f),this.$shareLink.text(f)),this.extension.isMobile()?(this.$shareInput.hide(),this.$shareLink.show()):(this.$shareInput.show(),this.$shareLink.hide())}updateInstructions(){x.getBool(this.options.instructionsEnabled,!1)?(this.$shareHeader.show(),this.$embedHeader.show(),this.$shareHeader.text(this.content.shareInstructions),this.$embedHeader.text(this.content.embedInstructions)):(this.$shareHeader.hide(),this.$embedHeader.hide())}getSelectedSize(){return this.$customSizeDropDown.find(":selected")}updateWidthRatio(){this.currentHeight=Number(this.$heightInput.val()),this.currentHeight<this.minHeight?(this.currentHeight=this.minHeight,this.$heightInput.val(String(this.currentHeight))):this.currentHeight>this.maxHeight&&(this.currentHeight=this.maxHeight,this.$heightInput.val(String(this.currentHeight))),this.currentWidth=Math.floor(this.currentHeight/this.aspectRatio),this.$widthInput.val(String(this.currentWidth))}updateHeightRatio(){this.currentWidth=Number(this.$widthInput.val()),this.currentWidth<this.minWidth?(this.currentWidth=this.minWidth,this.$widthInput.val(String(this.currentWidth))):this.currentWidth>this.maxWidth&&(this.currentWidth=this.maxWidth,this.$widthInput.val(String(this.currentWidth))),this.currentHeight=Math.floor(this.currentWidth*this.aspectRatio),this.$heightInput.val(String(this.currentHeight))}updateShareFrame(){let f=this.extension.helper.getShareServiceUrl();!f||(x.getBool(this.config.options.shareFrameEnabled,!0)&&f?(this.$shareFrame.prop("src",f),this.$shareFrame.show()):this.$shareFrame.hide())}updateTermsOfUseButton(){let f=this.extension.helper.getRequiredStatement();x.getBool(this.extension.data.config.options.termsOfUseEnabled,!1)&&f&&f.value?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()}openShareView(){this.isShareViewVisible=!0,this.isEmbedViewVisible=!1,this.$embedView.hide(),this.$shareView.show(),this.$shareButton.addClass("on default"),this.$embedButton.removeClass("on default"),this.resize()}openEmbedView(){this.isShareViewVisible=!1,this.isEmbedViewVisible=!0,this.$embedView.show(),this.$shareView.hide(),this.$shareButton.removeClass("on default"),this.$embedButton.addClass("on default"),this.resize()}close(){super.close()}getViews(){return this.$tabsContent.find(".view")}equaliseViewHeights(){this.getViews().equaliseHeight(!0)}resize(){this.equaliseViewHeights(),this.setDockedPosition()}};export{ct as a,st as b,at as c,nt as d,ut as e,ht as f,pt as g};
