import{a as x}from"./chunk-Q2W43J2O.js";import{a as U}from"./chunk-F2AP4VGO.js";import{o as h,p as u}from"./chunk-OEMHC5TT.js";import{a as w,e as b}from"./chunk-2OYNMPAF.js";import{a as c}from"./chunk-RPOSMM7Q.js";import{c as v}from"./chunk-YAXTLTJC.js";var g=v(w());window.$=g.default;window.jQuery=g.default;var E=class{constructor(t){this.readonly=!1;this.readonly=t}get(t,e){}set(t,e){}dispose(){}};var F=class extends E{constructor(t=!1){super(t)}get(t,e){let r=h.getHashParameter(t,document);return r===null?e:r}getFragment(t,e){let n=new RegExp("#.*"+t+"=([^&]+)(&|$)").exec(e);return n?decodeURIComponent(n[1].replace(/\+/g," ")):null}set(t,e){this.readonly||(e?h.setHashParameter(t,e,document):h.setHashParameter(t,"",document))}getInitialData(t){let e=[],r=this.get("locales","");if(r){let l=r.split(",");for(let a in l){let d=String(l[a]).split(":");e[a]={name:d[0],label:d[1]}}}else e.push(b);function n(l){if(l!==void 0)return Number(l)}return{iiifManifestId:this.get("iiifManifestId")||this.get("manifest"),collectionIndex:n(this.get("c")),manifestIndex:Number(this.get("m",0)),canvasIndex:Number(this.get("cv",0)),rotation:Number(this.get("r",0)),rangeId:this.get("rid",""),xywh:this.get("xywh",""),target:this.get("target",""),locales:e.length?e:void 0,...t}}dispose(){history.pushState("",document.title,window.location.pathname+window.location.search)}bindTo(t){t.adapter=this,t.on(u.PAUSE,e=>{e>0&&this.set("t",e)},!1),t.on(u.COLLECTION_INDEX_CHANGE,e=>{this.set("c",e)},!1),t.on(u.MANIFEST_INDEX_CHANGE,e=>{this.set("m",e)},!1),t.on(u.CANVAS_INDEX_CHANGE,e=>{this.set("cv",e)},!1),t.on(u.RANGE_CHANGE,e=>{this.set("rid",e)},!1),t.on(u.TARGET_CHANGE,e=>{this.set("xywh",this.getFragment("xywh",e))},!1)}};var s;(function(n){n.IIIFLEGACY="manifest",n.IIIF="iiifManifestId",n.YOUTUBE="youTubeVideoId",n.UNKNOWN="unknown"})(s||(s={}));var C={[s.IIIF]:()=>import("./IIIFContentHandler-2D2CUZM6.js"),[s.YOUTUBE]:()=>import("./YouTubeContentHandler-LVHYSGJO.js")},I=class extends U{constructor(t){super(t);this.options=t;this._contentType=s.UNKNOWN;this._externalEventListeners=[];this._assignContentHandler(this.options.data)}on(t,e,r){this._externalEventListeners.push({name:t,cb:e,ctx:r})}async _assignContentHandler(t){let e;t[s.IIIFLEGACY]?(t.iiifManifestId=t[s.IIIFLEGACY],delete t[s.IIIFLEGACY],e=s.IIIF):t[s.IIIF]?e=s.IIIF:t[s.YOUTUBE]?e=s.YOUTUBE:this._contentType?e=this._contentType:e=s.UNKNOWN;let r=this._contentType!==e;if(e===s.UNKNOWN)console.error("Unknown content type");else if(r){this._contentType=e,this._assignedContentHandler?.dispose();let n=await C[e]();this.showSpinner(),this._assignedContentHandler=new n.default({target:this._el,data:t},this.adapter,this._externalEventListeners)}return r}set(t){this._assignContentHandler(t).then(e=>{e?this.showSpinner():this._assignedContentHandler.set(t)})}exitFullScreen(){this._assignedContentHandler?.exitFullScreen()}resize(){this._assignedContentHandler?.resize()}dispose(){this._assignedContentHandler?.dispose()}};var _=(i,t)=>{let e,r=!1,n=!1,l=typeof i=="string"?document.getElementById(i):i;if(!l)throw new Error("UV target element not found");l.innerHTML="";let a=document.createElement("div");l.appendChild(a);let d=document.createElement("div");a.appendChild(d);let f=()=>{e&&(r&&!n?(a.style.width=window.innerWidth+"px",a.style.height=window.innerHeight+"px"):(a.style.width=l.offsetWidth+"px",a.style.height=l.offsetHeight+"px"),e.resize())};window.addEventListener("resize",function(){f()}),window.addEventListener("orientationchange",function(){setTimeout(function(){f()},100)}),e=new I({target:d,data:t}),e.on(c.CREATED,function(o){f()},!1),e.on(c.EXTERNAL_RESOURCE_OPENED,function(o){setTimeout(function(){f()},100)},!1),e.on(c.TOGGLE_FULLSCREEN,function(o){if(r=o.isFullScreen,n=o.overrideFullScreen,!o.overrideFullScreen)if(r){let m=H(a);m&&m.call(a)}else{let m=y();m&&m.call(document)}setTimeout(function(){f()},100)},!1),e.on(c.ERROR,function(o){console.error(o)},!1);function p(o){(o.type==="webkitfullscreenchange"&&!document.webkitIsFullScreen||o.type==="fullscreenchange"&&!document.fullscreenElement||o.type==="mozfullscreenchange"&&!document.mozFullScreen||o.type==="MSFullscreenChange"&&document.msFullscreenElement===null)&&e.exitFullScreen()}return document.addEventListener("fullscreenchange",p,!1),document.addEventListener("webkitfullscreenchange",p,!1),document.addEventListener("mozfullscreenchange",p,!1),document.addEventListener("MSFullscreenChange",p,!1),e};function H(i){return i.webkitRequestFullscreen?i.webkitRequestFullscreen:i.mozRequestFullScreen?i.mozRequestFullScreen:i.msRequestFullscreen?i.msRequestFullscreen:i.requestFullscreen?i.requestFullscreen:!1}function y(){return document.webkitExitFullscreen?document.webkitExitFullscreen:document.msExitFullscreen?document.msExitFullscreen:document.mozCancelFullScreen?document.mozCancelFullScreen:document.exitFullscreen?document.exitFullscreen:!1}export{c as Events,u as IIIFEvents,F as IIIFURLAdapter,F as IIIFURLAdaptor,I as Viewer,x as YouTubeEvents,_ as init};
